<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Systems Thinking Assessment | Chapman University</title>
    <style>
        :root { --chapman-blue: #00205B; --chapman-gold: #C4A000; --gold-light: #F5E6A3; --blue-light: #E8EDF5; --blue-medium: #1A3A7A; --text-primary: #1a1a2e; --text-secondary: #4a4a5a; --white: #ffffff; --holistic: #1565C0; --interconnections: #2E7D32; --dynamics: #C62828; --leverage: #7B1FA2; --shadow-medium: 0 4px 20px rgba(0, 32, 91, 0.12); --shadow-strong: 0 8px 32px rgba(0, 32, 91, 0.18); }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', -apple-system, sans-serif; line-height: 1.7; color: var(--text-primary); background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); min-height: 100vh; padding: 20px; }
        .container { max-width: 950px; margin: 0 auto; background: var(--white); border-radius: 16px; box-shadow: var(--shadow-strong); overflow: hidden; }
        .header { background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); color: var(--white); padding: 40px 30px; text-align: center; position: relative; }
        .header::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, var(--chapman-gold), var(--gold-light), var(--chapman-gold)); }
        .institution { font-size: 0.95em; letter-spacing: 2px; text-transform: uppercase; opacity: 0.9; margin-bottom: 5px; }
        .college { font-size: 1.1em; color: var(--chapman-gold); margin-bottom: 20px; font-weight: 600; }
        h1 { font-size: 2.4em; font-weight: 700; margin-bottom: 12px; }
        .subtitle { font-size: 1.1em; font-style: italic; color: var(--gold-light); }
        .content { padding: 35px; }
        .hidden { display: none !important; }
        .intro-section { background: linear-gradient(135deg, var(--blue-light), #f8f9fc); border-radius: 14px; padding: 30px; margin-bottom: 30px; border-left: 5px solid var(--chapman-blue); }
        .intro-section h2 { color: var(--chapman-blue); font-size: 1.4em; margin-bottom: 15px; }
        .intro-section p { color: var(--text-secondary); margin-bottom: 15px; }
        .dimensions-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin: 25px 0; }
        .dim-preview { padding: 20px 12px; border-radius: 12px; text-align: center; color: var(--white); }
        .dim-preview.holistic { background: linear-gradient(135deg, var(--holistic), #1976D2); }
        .dim-preview.interconnections { background: linear-gradient(135deg, var(--interconnections), #43A047); }
        .dim-preview.dynamics { background: linear-gradient(135deg, var(--dynamics), #D32F2F); }
        .dim-preview.leverage { background: linear-gradient(135deg, var(--leverage), #9C27B0); }
        .dim-preview .icon { font-size: 1.8em; margin-bottom: 6px; }
        .dim-preview .name { font-weight: 700; font-size: 0.75em; line-height: 1.3; }
        .quote-box { background: linear-gradient(135deg, #fffef8, #fef9e7); border-left: 5px solid var(--chapman-gold); padding: 25px; margin: 25px 0; border-radius: 0 12px 12px 0; }
        .quote-box blockquote { font-style: italic; color: var(--text-secondary); font-size: 1.05em; }
        .quote-box cite { display: block; margin-top: 12px; color: var(--chapman-blue); font-weight: 600; font-style: normal; }
        .assessment-meta { display: flex; gap: 25px; margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(0,32,91,0.1); flex-wrap: wrap; }
        .meta-item { display: flex; align-items: center; gap: 8px; color: var(--text-secondary); }
        .meta-icon { width: 28px; height: 28px; background: var(--chapman-blue); color: var(--white); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 0.85em; }
        .student-info { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 30px; }
        .input-group { display: flex; flex-direction: column; }
        .input-group label { font-weight: 600; margin-bottom: 8px; color: var(--chapman-blue); }
        .input-group input { padding: 14px 16px; border: 2px solid #e1e5eb; border-radius: 10px; font-size: 16px; }
        .input-group input:focus { outline: none; border-color: var(--chapman-blue); }
        .instructions-box { background: linear-gradient(135deg, #fffef8, #fef9e7); border: 2px solid var(--chapman-gold); border-radius: 12px; padding: 25px; margin-bottom: 30px; }
        .instructions-box h3 { color: var(--chapman-blue); margin-bottom: 15px; }
        .scale-display { display: flex; justify-content: space-between; margin-top: 15px; padding: 15px; background: var(--blue-light); border-radius: 10px; }
        .scale-item { text-align: center; flex: 1; }
        .scale-number { display: inline-block; width: 36px; height: 36px; line-height: 36px; background: var(--chapman-blue); color: var(--white); border-radius: 50%; font-weight: 700; margin-bottom: 5px; }
        .scale-label { font-size: 0.6em; color: var(--text-secondary); }
        .progress-container { margin-bottom: 25px; }
        .progress-label { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.9em; color: var(--text-secondary); }
        .progress-bar { width: 100%; height: 10px; background: #e8ecf0; border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--chapman-blue), var(--chapman-gold)); width: 0%; transition: width 0.5s ease; }
        .question-container { background: var(--white); border-radius: 14px; border: 2px solid #e8ecf0; padding: 25px; margin-bottom: 18px; transition: all 0.3s ease; }
        .question-container:hover { border-color: var(--chapman-blue); box-shadow: var(--shadow-medium); }
        .question-container.answered { border-color: var(--chapman-gold); background: linear-gradient(135deg, #fffef8, var(--white)); }
        .question-text { font-size: 1.02em; color: var(--text-primary); margin-bottom: 18px; }
        .question-number { color: var(--chapman-blue); font-weight: 700; margin-right: 8px; }
        .likert-scale { display: flex; justify-content: space-between; gap: 6px; }
        .likert-option { flex: 1; text-align: center; }
        .likert-option input[type="radio"] { display: none; }
        .likert-option label { display: flex; flex-direction: column; align-items: center; padding: 12px 6px; border: 2px solid #e8ecf0; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; background: #fafbfc; }
        .likert-option label:hover { border-color: var(--chapman-blue); background: var(--blue-light); }
        .likert-option input[type="radio"]:checked + label { border-color: var(--chapman-blue); background: var(--chapman-blue); color: var(--white); }
        .likert-number { font-size: 1.2em; font-weight: 700; margin-bottom: 2px; }
        .likert-label { font-size: 0.55em; text-transform: uppercase; }
        .controls { text-align: center; margin: 30px 0; }
        .btn { border: none; padding: 16px 40px; font-size: 1.05em; font-weight: 600; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; margin: 8px; }
        .btn-primary { background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); color: var(--white); }
        .btn-primary:hover:not(:disabled) { transform: translateY(-3px); }
        .btn-secondary { background: linear-gradient(135deg, var(--chapman-gold), #d4b000); color: var(--chapman-blue); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-outline { background: transparent; border: 2px solid var(--chapman-blue); color: var(--chapman-blue); }
        .results { display: none; margin-top: 30px; }
        .results-header { background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); color: var(--white); padding: 40px; text-align: center; border-radius: 16px 16px 0 0; }
        .results-header h2 { font-size: 1.8em; margin-bottom: 10px; }
        .results-header .student-name { font-size: 1.3em; color: var(--chapman-gold); margin-bottom: 8px; }
        .overall-score { background: linear-gradient(135deg, #34495e, #2c3e50); padding: 40px; text-align: center; }
        .score-circle { width: 160px; height: 160px; border-radius: 50%; background: conic-gradient(var(--chapman-gold) var(--pct), rgba(255,255,255,0.2) 0); display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; }
        .score-inner { width: 130px; height: 130px; border-radius: 50%; background: #2c3e50; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--white); }
        .score-inner .score { font-size: 2.8em; font-weight: 700; line-height: 1; }
        .score-inner .label { font-size: 0.85em; opacity: 0.9; }
        .level-name { color: var(--chapman-gold); font-size: 1.4em; font-weight: 700; margin-bottom: 10px; }
        .level-desc { color: rgba(255,255,255,0.85); font-size: 0.95em; max-width: 600px; margin: 0 auto; }
        .dim-scores { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; padding: 25px; background: linear-gradient(135deg, #3a5068, #2c3e50); }
        .dim-score-card { background: rgba(255,255,255,0.1); padding: 20px 15px; border-radius: 14px; text-align: center; color: var(--white); }
        .dim-score-card.highest { box-shadow: 0 0 0 3px var(--chapman-gold); }
        .dim-score-card.lowest { border: 2px dashed rgba(255,255,255,0.4); }
        .dim-score-card .icon { font-size: 1.6em; margin-bottom: 6px; }
        .dim-score-card .name { font-size: 0.7em; margin-bottom: 8px; opacity: 0.9; }
        .dim-score-card .score { font-size: 2em; font-weight: 700; }
        .dim-score-card .max { font-size: 0.7em; opacity: 0.7; }
        .results-body { background: var(--blue-light); padding: 35px; border-radius: 0 0 16px 16px; }
        .result-section { background: var(--white); border-radius: 14px; padding: 28px; margin-bottom: 20px; border-left: 5px solid var(--chapman-blue); }
        .result-section.gold-accent { border-left-color: var(--chapman-gold); }
        .result-section h4 { color: var(--chapman-blue); margin-bottom: 18px; }
        .dim-detail { padding: 20px; border-radius: 12px; margin-bottom: 15px; }
        .dim-detail.holistic { background: rgba(21,101,192,0.08); border-left: 4px solid var(--holistic); }
        .dim-detail.interconnections { background: rgba(46,125,50,0.08); border-left: 4px solid var(--interconnections); }
        .dim-detail.dynamics { background: rgba(198,40,40,0.08); border-left: 4px solid var(--dynamics); }
        .dim-detail.leverage { background: rgba(123,31,162,0.08); border-left: 4px solid var(--leverage); }
        .dim-detail h5 { margin-bottom: 8px; }
        .dim-detail p { font-size: 0.9em; color: var(--text-secondary); margin-bottom: 10px; }
        .dim-detail ul { list-style: none; padding: 0; }
        .dim-detail li { padding: 5px 0 5px 20px; position: relative; font-size: 0.85em; color: var(--text-secondary); }
        .dim-detail li::before { content: '‚Üí'; position: absolute; left: 0; }
        .reflection-section { background: linear-gradient(135deg, var(--blue-light), #f0f4fa); border-radius: 14px; padding: 30px; margin-top: 25px; border: 2px solid var(--chapman-blue); }
        .reflection-section h4 { color: var(--chapman-blue); margin-bottom: 20px; text-align: center; }
        .reflection-questions { counter-reset: reflection; }
        .reflection-question { padding: 18px 20px 18px 50px; position: relative; background: var(--white); border-radius: 10px; margin-bottom: 12px; color: var(--text-secondary); }
        .reflection-question::before { counter-increment: reflection; content: counter(reflection); position: absolute; left: 15px; top: 50%; transform: translateY(-50%); width: 26px; height: 26px; background: var(--chapman-blue); color: var(--white); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.85em; font-weight: 700; }
        .footer { text-align: center; padding: 25px; color: var(--text-secondary); font-size: 0.9em; border-top: 1px solid #e8ecf0; margin-top: 30px; }
        @media (max-width: 768px) { .dimensions-grid, .dim-scores { grid-template-columns: repeat(2, 1fr); } .student-info { grid-template-columns: 1fr; } h1 { font-size: 1.8em; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="institution">Chapman University</div>
            <div class="college">Argyros College of Business and Economics</div>
            <h1>Systems Thinking Assessment</h1>
            <div class="subtitle">Based on Peter Senge's Fifth Discipline Framework</div>
        </div>
        <div class="content">
            <div id="intro-section">
                <div class="intro-section">
                    <h2>üîÑ How Well Do You Think in Systems?</h2>
                    <p><strong>Systems thinking</strong> is the ability to see the whole rather than just the parts ‚Äî to understand how elements interconnect, how patterns emerge over time, and where small changes can create big results.</p>
                    <p><strong>Peter Senge</strong> identified systems thinking as the "fifth discipline" ‚Äî the cornerstone of the learning organization.</p>
                    <div class="dimensions-grid">
                        <div class="dim-preview holistic"><div class="icon">üåê</div><div class="name">Holistic Perspective</div></div>
                        <div class="dim-preview interconnections"><div class="icon">üîó</div><div class="name">Seeing Interconnections</div></div>
                        <div class="dim-preview dynamics"><div class="icon">üìà</div><div class="name">Understanding Dynamics</div></div>
                        <div class="dim-preview leverage"><div class="icon">üéØ</div><div class="name">Finding Leverage Points</div></div>
                    </div>
                    <div class="quote-box">
                        <blockquote>"Today's problems come from yesterday's solutions... The harder you push, the harder the system pushes back... Faster is slower."</blockquote>
                        <cite>‚Äî Peter Senge, The Fifth Discipline (1990)</cite>
                    </div>
                    <div class="assessment-meta">
                        <div class="meta-item"><div class="meta-icon">‚è±</div><span>6-8 minutes</span></div>
                        <div class="meta-item"><div class="meta-icon">üìù</div><span>20 items</span></div>
                        <div class="meta-item"><div class="meta-icon">üîÑ</div><span>4 dimensions</span></div>
                    </div>
                </div>
                <div class="student-info">
                    <div class="input-group"><label for="studentName">Your Full Name</label><input type="text" id="studentName" placeholder="Enter your full name"></div>
                    <div class="input-group"><label for="testDate">Assessment Date</label><input type="date" id="testDate"></div>
                </div>
                <div class="instructions-box">
                    <h3>üìå Instructions</h3>
                    <p>Rate how accurately each statement describes how you typically think about problems and situations.</p>
                    <div class="scale-display">
                        <div class="scale-item"><div class="scale-number">1</div><div class="scale-label">Rarely</div></div>
                        <div class="scale-item"><div class="scale-number">2</div><div class="scale-label">Sometimes</div></div>
                        <div class="scale-item"><div class="scale-number">3</div><div class="scale-label">Often</div></div>
                        <div class="scale-item"><div class="scale-number">4</div><div class="scale-label">Usually</div></div>
                        <div class="scale-item"><div class="scale-number">5</div><div class="scale-label">Always</div></div>
                    </div>
                </div>
                <div class="controls"><button class="btn btn-primary" onclick="startAssessment()">Begin Assessment ‚Üí</button></div>
            </div>
            <div id="assessment-section" class="hidden">
                <div class="progress-container">
                    <div class="progress-label"><span>Progress</span><span id="progressText">0 of 20</span></div>
                    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
                </div>
                <div id="questions-container"></div>
                <div class="controls"><button class="btn btn-primary" id="submitBtn" onclick="calculateResults()" disabled>Discover My Systems Thinking Profile ‚Üí</button></div>
            </div>
            <div id="results" class="results"></div>
            <div id="downloadSection" class="hidden controls">
                <button class="btn btn-secondary" onclick="generatePDF()">üìÑ Download PDF</button>
                <button class="btn btn-outline" onclick="restartAssessment()">Retake</button>
            </div>
        </div>
        <div class="footer">
            <p>Systems Thinking Assessment ‚Ä¢ Based on Peter Senge's Fifth Discipline</p>
            <p>Chapman University ‚Ä¢ Argyros College of Business and Economics</p>
            <p style="margin-top: 8px; font-size: 0.85em;">¬© 2024 Professor Chip Monaco ‚Ä¢ MGMT 316</p>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        const questions = {
            holistic: [
                { id: 1, text: "I consider the broader context before making decisions.", dim: "holistic" },
                { id: 2, text: "I step back to see the big picture rather than getting lost in details.", dim: "holistic" },
                { id: 3, text: "I think about how different parts of an organization affect each other.", dim: "holistic" },
                { id: 4, text: "I consider multiple stakeholder perspectives when analyzing problems.", dim: "holistic" },
                { id: 5, text: "I look beyond my immediate area to understand organizational issues.", dim: "holistic" }
            ],
            interconnections: [
                { id: 6, text: "I look for connections between seemingly unrelated events.", dim: "interconnections" },
                { id: 7, text: "I trace problems back to their root causes rather than symptoms.", dim: "interconnections" },
                { id: 8, text: "I consider how changes in one area might affect other areas.", dim: "interconnections" },
                { id: 9, text: "I map out relationships between different factors before acting.", dim: "interconnections" },
                { id: 10, text: "I recognize that most problems have multiple, interconnected causes.", dim: "interconnections" }
            ],
            dynamics: [
                { id: 11, text: "I think about how situations might evolve over time.", dim: "dynamics" },
                { id: 12, text: "I recognize patterns that repeat in different situations.", dim: "dynamics" },
                { id: 13, text: "I consider delayed effects when evaluating decisions.", dim: "dynamics" },
                { id: 14, text: "I understand that today's solutions can become tomorrow's problems.", dim: "dynamics" },
                { id: 15, text: "I look for reinforcing loops that amplify trends (virtuous or vicious cycles).", dim: "dynamics" }
            ],
            leverage: [
                { id: 16, text: "I search for small changes that could produce big results.", dim: "leverage" },
                { id: 17, text: "I identify key points where intervention would be most effective.", dim: "leverage" },
                { id: 18, text: "I question whether quick fixes might create unintended consequences.", dim: "leverage" },
                { id: 19, text: "I look for underlying structures that drive behavior.", dim: "leverage" },
                { id: 20, text: "I focus on changing systems rather than blaming individuals.", dim: "leverage" }
            ]
        };
        const dimensionData = {
            holistic: { 
                name: "Holistic Perspective", 
                icon: "üåê", 
                color: "#1565C0", 
                description: "The ability to see the whole system rather than just individual parts ‚Äî understanding that the whole is greater than the sum of its parts.",
                profileSummary: "You see the big picture and understand how parts relate to the whole. You naturally consider broader context before diving into details.",
                decisionStyle: "Context-aware and integrative. You consider how decisions fit within larger systems and affect multiple stakeholders.",
                communicationStyle: "Expansive and contextualizing. You help others see the bigger picture and how their work connects to organizational goals.",
                motivatedBy: "Understanding complexity, seeing how things connect, solving problems at the system level, and creating comprehensive solutions.",
                stressResponse: "Under pressure, you may become overwhelmed by seeing too much complexity, or struggle to prioritize when everything seems connected.",
                blindSpots: "May struggle with detailed execution; can see so much context that decision-making becomes difficult.",
                highBehaviors: ["Considers organizational context", "Takes multiple stakeholder views", "Avoids tunnel vision", "Sees forest and trees"], 
                development: ["Practice zooming out before diving in", "Ask 'What else might be affected?'", "Create stakeholder maps", "Study how departments interconnect"],
                swotStrength: "Sees big picture and avoids narrow solutions",
                swotWeakness: "May struggle with detailed implementation",
                swotOpportunity: "Pair holistic view with execution focus",
                swotThreat: "Risk of analysis paralysis from seeing too much complexity"
            },
            interconnections: { 
                name: "Seeing Interconnections", 
                icon: "üîó", 
                color: "#2E7D32", 
                description: "The ability to recognize relationships, dependencies, and feedback loops between different elements of a system.",
                profileSummary: "You see how things connect and influence each other. You trace causes and effects across system boundaries.",
                decisionStyle: "Relational and analytical. You map how decisions ripple through connected elements before acting.",
                communicationStyle: "Connection-focused and explanatory. You help others see relationships and dependencies they might miss.",
                motivatedBy: "Discovering hidden connections, understanding root causes, seeing how changes propagate, and explaining complex relationships.",
                stressResponse: "Under pressure, you may over-complicate by seeing too many connections, or struggle when connections aren't clear.",
                blindSpots: "May miss simple solutions by looking for complex connections; can see relationships that aren't actually meaningful.",
                highBehaviors: ["Traces problems to root causes", "Maps relationships between factors", "Sees hidden connections", "Understands ripple effects"], 
                development: ["Draw causal loop diagrams", "Ask 'What led to this?'", "Look for patterns across situations", "Practice 'Five Whys' analysis"],
                swotStrength: "Sees relationships and root causes others miss",
                swotWeakness: "May over-complicate simple situations",
                swotOpportunity: "Use connection-mapping to prevent unintended consequences",
                swotThreat: "Risk of seeing connections that aren't meaningful"
            },
            dynamics: { 
                name: "Understanding Dynamics", 
                icon: "üìà", 
                color: "#C62828", 
                description: "The ability to understand how systems change over time ‚Äî recognizing delays, feedback loops, and emergent patterns.",
                profileSummary: "You understand how systems evolve over time. You anticipate delays, recognize patterns, and think about long-term dynamics.",
                decisionStyle: "Temporal and pattern-oriented. You consider how situations will evolve and factor in delays and feedback effects.",
                communicationStyle: "Temporal and scenario-based. You help others think about how situations might develop over time.",
                motivatedBy: "Understanding change patterns, anticipating future states, recognizing recurring dynamics, and modeling how systems evolve.",
                stressResponse: "Under pressure, you may focus too much on long-term dynamics when immediate action is needed, or become anxious about future scenarios.",
                blindSpots: "May miss urgent present needs while focused on future dynamics; can over-weight worst-case scenarios.",
                highBehaviors: ["Anticipates delayed effects", "Recognizes recurring patterns", "Understands feedback loops", "Thinks in time horizons"], 
                development: ["Consider short and long-term effects", "Look for vicious and virtuous cycles", "Study how situations evolved historically", "Model scenarios over time"],
                swotStrength: "Anticipates how systems will evolve over time",
                swotWeakness: "May miss present needs while focused on future dynamics",
                swotOpportunity: "Use temporal thinking for better long-term planning",
                swotThreat: "Risk of ignoring urgent present needs"
            },
            leverage: { 
                name: "Finding Leverage Points", 
                icon: "üéØ", 
                color: "#7B1FA2", 
                description: "The ability to identify where small, focused actions can produce significant, lasting change in a system.",
                profileSummary: "You find the highest-impact intervention points. You look for where small changes can produce large, sustainable effects.",
                decisionStyle: "Strategic and impact-focused. You prioritize interventions that offer the best leverage for sustainable change.",
                communicationStyle: "Strategic and persuasive. You help others focus on high-leverage actions rather than symptoms.",
                motivatedBy: "Finding efficient solutions, creating lasting change, avoiding wasted effort, and achieving disproportionate impact.",
                stressResponse: "Under pressure, you may resist quick fixes even when they're appropriate, or become frustrated when forced to address symptoms.",
                blindSpots: "May dismiss necessary short-term fixes while searching for leverage; can miss simple solutions that work.",
                highBehaviors: ["Finds high-impact intervention points", "Questions quick fixes", "Focuses on structure over blame", "Seeks sustainable solutions"], 
                development: ["Ask 'Where is the real leverage here?'", "Challenge symptomatic solutions", "Look for structural causes", "Study Meadows' leverage points"],
                swotStrength: "Finds high-impact actions that create sustainable change",
                swotWeakness: "May dismiss needed short-term fixes",
                swotOpportunity: "Combine leverage thinking with pragmatic action",
                swotThreat: "Risk of perfect being enemy of good"
            }
        };
        const levels = [
            { min: 80, max: 100, name: "Systems Master", desc: "You naturally think in systems ‚Äî seeing wholes, connections, dynamics, and leverage points with ease.", swotStrength: "Exceptional systems perspective that sees complexity clearly", swotWeakness: "May struggle in environments that don't value systems thinking", swotOpportunity: "Teach and model systems thinking for others", swotThreat: "Risk of frustration when others don't see systems" },
            { min: 60, max: 79, name: "Systems Thinker", desc: "You have strong systems thinking abilities with room to deepen specific dimensions.", swotStrength: "Strong systems perspective that informs good decisions", swotWeakness: "Some dimensions may need development", swotOpportunity: "Deepen weaker dimensions for comprehensive systems thinking", swotThreat: "May miss important factors if weaker dimensions aren't developed" },
            { min: 40, max: 59, name: "Developing Systems View", desc: "You're building systems thinking skills. Practice looking for connections and patterns.", swotStrength: "Emerging systems awareness provides foundation to build on", swotWeakness: "May miss important systemic factors", swotOpportunity: "Significant room for development through practice", swotThreat: "May make decisions without considering systemic effects" },
            { min: 20, max: 39, name: "Linear Thinker", desc: "You tend toward linear, cause-effect thinking. Systems thinking can be developed with practice.", swotStrength: "Clear, direct thinking has value in simple situations", swotWeakness: "May miss complexity and create unintended consequences", swotOpportunity: "Systems thinking can be learned with practice", swotThreat: "Serious risk of poor decisions in complex environments" }
        ];
        let responses = {};
        let studentName = '';
        let surveyDate = '';
        
        // Robust auto-date initialization
        function setTodayDate() {
            var dateField = document.getElementById('testDate');
            if (dateField) {
                dateField.value = new Date().toISOString().split('T')[0];
            }
        }
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            setTodayDate();
        }
        document.addEventListener('DOMContentLoaded', setTodayDate);
        window.addEventListener('load', setTodayDate);
        function startAssessment() {
            studentName = document.getElementById('studentName').value.trim();
            surveyDate = document.getElementById('testDate').value;
            if (!studentName) { alert('Please enter your name.'); return; }
            document.getElementById('intro-section').classList.add('hidden');
            document.getElementById('assessment-section').classList.remove('hidden');
            renderQuestions();
        }
        function renderQuestions() {
            const container = document.getElementById('questions-container');
            const allQuestions = [...questions.holistic, ...questions.interconnections, ...questions.dynamics, ...questions.leverage].sort(() => Math.random() - 0.5);
            container.innerHTML = allQuestions.map((q, i) => `
                <div class="question-container" id="q-container-${q.id}">
                    <div class="question-text"><span class="question-number">${i+1}.</span> ${q.text}</div>
                    <div class="likert-scale">
                        ${[1,2,3,4,5].map(val => `
                            <div class="likert-option">
                                <input type="radio" name="q${q.id}" id="q${q.id}_${val}" value="${val}" onchange="handleResponse(${q.id}, ${val}, '${q.dim}')">
                                <label for="q${q.id}_${val}"><span class="likert-number">${val}</span><span class="likert-label">${['Rarely','Sometimes','Often','Usually','Always'][val-1]}</span></label>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }
        function handleResponse(id, value, dim) {
            responses[id] = { value, dim };
            document.getElementById(`q-container-${id}`).classList.add('answered');
            updateProgress();
        }
        function updateProgress() {
            const answered = Object.keys(responses).length;
            document.getElementById('progressFill').style.width = (answered / 20 * 100) + '%';
            document.getElementById('progressText').textContent = `${answered} of 20`;
            document.getElementById('submitBtn').disabled = answered < 20;
        }
        function calculateResults() {
            const scores = { holistic: 0, interconnections: 0, dynamics: 0, leverage: 0 };
            Object.values(responses).forEach(r => scores[r.dim] += r.value);
            const totalScore = Object.values(scores).reduce((a, b) => a + b, 0);
            displayResults(scores, totalScore);
        }
        function displayResults(scores, totalScore) {
            const level = levels.find(l => totalScore >= l.min && totalScore <= l.max) || levels[3];
            const pct = (totalScore / 100) * 100;
            const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const highestDim = sorted[0][0];
            const lowestDim = sorted[3][0];
            document.getElementById('results').innerHTML = `
                <div class="results-header"><h2>üîÑ Your Systems Thinking Profile</h2><div class="student-name">${studentName}</div><div class="date">Completed: ${new Date(surveyDate).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div></div>
                <div class="overall-score">
                    <div class="score-circle" style="--pct: ${pct}%;"><div class="score-inner"><div class="score">${totalScore}</div><div class="label">of 100</div></div></div>
                    <div class="level-name">${level.name}</div>
                    <div class="level-desc">${level.desc}</div>
                </div>
                <div class="dim-scores">
                    ${['holistic', 'interconnections', 'dynamics', 'leverage'].map(dim => `
                        <div class="dim-score-card ${dim === highestDim ? 'highest' : ''} ${dim === lowestDim ? 'lowest' : ''}">
                            <div class="icon">${dimensionData[dim].icon}</div>
                            <div class="name">${dimensionData[dim].name}</div>
                            <div class="score">${scores[dim]}</div>
                            <div class="max">of 25</div>
                        </div>
                    `).join('')}
                </div>
                <div style="background: linear-gradient(135deg, #1a3a7a 0%, #00205B 100%); color: white; padding: 25px; border-radius: 14px; margin: 20px 0;">
                    <h3 style="color: #C4A000; margin-bottom: 15px; font-size: 1.3em;">üìã Assessment Tracker Summary</h3>
                    <p style="font-size: 0.9em; opacity: 0.9; margin-bottom: 15px;">Copy this code into your Assessment Tracker.</p>
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div><div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase;">Systems Level</div><div style="font-size: 1.4em; font-weight: 700; color: #F5E6A3;">${level.name}</div></div>
                            <div><div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase;">Strongest Dimension</div><div style="font-size: 1.4em; font-weight: 700; color: #F5E6A3;">${dimensionData[highestDim].name}</div></div>
                            <div><div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase;">Total Score</div><div style="font-size: 1.2em; font-weight: 600;">${totalScore} / 100 (${pct}%)</div></div>
                            <div><div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase;">Growth Area</div><div style="font-size: 1.2em; font-weight: 600;">${dimensionData[lowestDim].name}</div></div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; padding: 18px; background: linear-gradient(135deg, rgba(196,160,0,0.25) 0%, rgba(196,160,0,0.15) 100%); border-radius: 10px; border: 1px solid rgba(196,160,0,0.3);">
                        <h4 style="color: #F5E6A3; margin: 0 0 15px 0; font-size: 1.1em;">üìã Your Results Summary</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px;">
                            <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px;">
                                <div style="font-size: 0.75em; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px;">Systems Thinking Level</div>
                                <div style="font-size: 1.2em; font-weight: 700; color: #F5E6A3;">${level.name}</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px;">
                                <div style="font-size: 0.75em; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px;">Total Score</div>
                                <div style="font-size: 1.2em; font-weight: 700; color: #F5E6A3;">${totalScore} / 100 (${pct}%)</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px;">
                                <div style="font-size: 0.75em; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px;">Strongest Dimension</div>
                                <div style="font-size: 1.1em; font-weight: 600;">${dimensionData[highestDim].name}</div>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px;">
                                <div style="font-size: 0.75em; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px;">Growth Opportunity</div>
                                <div style="font-size: 1.1em; font-weight: 600;">${dimensionData[lowestDim].name}</div>
                            </div>
                        </div>
                        <div style="font-size: 0.85em; opacity: 0.9; margin-bottom: 10px;">
                            <strong>Dimension Scores:</strong> Holistic Thinking: ${scores.holistic} | Interconnections: ${scores.interconnections} | Dynamic Thinking: ${scores.dynamics} | Leverage Points: ${scores.leverage}
                        </div>
                        <div style="font-size: 0.75em; opacity: 0.8; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px;">
                            <div style="margin-bottom: 6px;"><strong>Your Result:</strong> Systems Thinking: ${level.name} | Strongest: ${dimensionData[highestDim].name} | Score: ${totalScore}</div>
                            <div style="opacity: 0.7;"><span>Tracker Code:</span> <code style="background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 3px;">SYS-${highestDim === 'holistic' ? 'Ho' : highestDim === 'interconnections' ? 'In' : highestDim === 'dynamics' ? 'Dy' : 'Le'}-${level.name.includes('High') ? 'H' : level.name.includes('Moderate') ? 'M' : level.name.includes('Developing') ? 'D' : 'E'}${totalScore}</code></div>
                        </div>
                    </div>
                </div>
                <div class="results-body">
                    <div class="result-section"><h4>üìä Dimension Profile</h4>
                        ${['holistic', 'interconnections', 'dynamics', 'leverage'].map(dim => `
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 12px;">
                                <span style="width: 160px; font-weight: 600; color: var(--text-secondary); font-size: 0.85em;">${dimensionData[dim].icon} ${dimensionData[dim].name}</span>
                                <div style="flex: 1; height: 26px; background: #e8ecf0; border-radius: 13px; overflow: hidden;">
                                    <div style="height: 100%; width: ${(scores[dim] / 25) * 100}%; background: ${dimensionData[dim].color}; border-radius: 13px; display: flex; align-items: center; justify-content: flex-end; padding-right: 10px; color: white; font-weight: 600; font-size: 0.8em; min-width: 35px;">${scores[dim]}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="result-section gold-accent"><h4>üí™ Strength: ${dimensionData[highestDim].name}</h4>
                        <div class="dim-detail ${highestDim}"><h5 style="color: ${dimensionData[highestDim].color};">${dimensionData[highestDim].icon} ${dimensionData[highestDim].name}</h5><p>${dimensionData[highestDim].description}</p><p><strong>High Behaviors:</strong></p><ul>${dimensionData[highestDim].highBehaviors.map(b => `<li>${b}</li>`).join('')}</ul></div>
                    </div>
                    <div class="result-section"><h4>üéØ Growth Area: ${dimensionData[lowestDim].name}</h4>
                        <div class="dim-detail ${lowestDim}"><h5 style="color: ${dimensionData[lowestDim].color};">${dimensionData[lowestDim].icon} ${dimensionData[lowestDim].name}</h5><p>${dimensionData[lowestDim].description}</p><p><strong>Development Strategies:</strong></p><ul>${dimensionData[lowestDim].development.map(d => `<li>${d}</li>`).join('')}</ul></div>
                    </div>
                    <div class="result-section gold-accent"><h4>‚ö†Ô∏è Senge's Systems Thinking Laws</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <div style="padding: 12px; background: rgba(21,101,192,0.08); border-radius: 8px; font-size: 0.85em;"><strong>Today's problems...</strong> come from yesterday's solutions</div>
                            <div style="padding: 12px; background: rgba(46,125,50,0.08); border-radius: 8px; font-size: 0.85em;"><strong>Faster is slower...</strong> sustainable growth takes time</div>
                            <div style="padding: 12px; background: rgba(198,40,40,0.08); border-radius: 8px; font-size: 0.85em;"><strong>Cause and effect...</strong> are not closely related in time/space</div>
                            <div style="padding: 12px; background: rgba(123,31,162,0.08); border-radius: 8px; font-size: 0.85em;"><strong>Small changes...</strong> can produce big results</div>
                        </div>
                    </div>
                    <div class="reflection-section"><h4>ü§î Reflection Questions</h4><div class="reflection-questions"><div class="reflection-question">Think of a recent problem. What connections to other issues did you miss?</div><div class="reflection-question">Where have you seen a 'quick fix' create new problems?</div><div class="reflection-question">What feedback loops operate in your organization?</div><div class="reflection-question">Where might small changes create large positive effects?</div></div></div>
                </div>
            `;
            document.getElementById('assessment-section').classList.add('hidden');
            document.getElementById('results').style.display = 'block';
            document.getElementById('downloadSection').classList.remove('hidden');
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
            window.systemsResults = { scores, totalScore, level, highestDim, lowestDim };
        }
        function generatePDF() {
            var jsPDF = window.jspdf.jsPDF;
            var doc = new jsPDF();
            var scores = window.systemsResults.scores;
            var totalScore = window.systemsResults.totalScore;
            var level = window.systemsResults.level;
            var highestDim = window.systemsResults.highestDim;
            var lowestDim = window.systemsResults.lowestDim;

            // Colors
            var chapmanBlue = [0, 32, 91];
            var chapmanGold = [196, 160, 0];
            var textDark = [26, 26, 46];
            var textMuted = [100, 100, 110];
            var greenColor = [46, 125, 50];
            var redColor = [198, 40, 40];
            var blueColor = [21, 101, 192];
            var orangeColor = [230, 81, 0];
            var purpleColor = [123, 31, 162];
            var tealColor = [0, 131, 143];

            // Tracker calculations
            var dimAbbrev = { holistic: 'Ho', interconnections: 'In', dynamics: 'Dy', leverage: 'Le' };
            var levelAbbrev = level.name.split(' ')[0].charAt(0);
            var trackerCode = 'SYS-' + dimAbbrev[highestDim] + '-' + levelAbbrev + totalScore;

            // Helper function
            function addWrappedText(text, x, startY, maxWidth, lineHeight) {
                var lines = doc.splitTextToSize(text, maxWidth);
                var currentY = startY;
                for (var i = 0; i < lines.length; i++) {
                    if (currentY > 275) { doc.addPage(); currentY = 20; }
                    doc.text(lines[i], x, currentY);
                    currentY += lineHeight;
                }
                return currentY;
            }

            // ===== PAGE 1 =====
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.rect(0, 0, 210, 42, 'F');
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('CHAPMAN UNIVERSITY', 105, 12, { align: 'center' });
            doc.setFontSize(9);
            doc.setTextColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.text('Argyros College of Business and Economics', 105, 18, { align: 'center' });
            doc.setFontSize(16);
            doc.setTextColor(255, 255, 255);
            doc.text('Systems Thinking Assessment', 105, 28, { align: 'center' });
            doc.setFontSize(9);
            doc.text("Based on Peter Senge's Fifth Discipline Framework", 105, 36, { align: 'center' });
            doc.setFillColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.rect(0, 42, 210, 2, 'F');

            var y = 52;
            doc.setFontSize(10);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text('Student: ' + studentName, 20, y);
            doc.text('Date: ' + new Date(surveyDate).toLocaleDateString(), 140, y);
            y += 10;

            // Overall Score Banner
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 18, 2, 2, 'F');
            doc.setFontSize(14);
            doc.setTextColor(255, 255, 255);
            doc.text(level.name.toUpperCase() + ': ' + totalScore + '/100', 105, y + 12, { align: 'center' });
            y += 24;

            doc.setFontSize(9);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            y = addWrappedText(level.desc, 20, y, 170, 4.5);
            y += 6;

            // Score Distribution Box
            doc.setFillColor(245, 247, 250);
            doc.roundedRect(20, y, 170, 28, 2, 2, 'F');
            doc.setFontSize(9);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('DIMENSION SCORES', 25, y + 7);
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text('Holistic Perspective: ' + scores.holistic + '/25', 25, y + 15);
            doc.text('Seeing Interconnections: ' + scores.interconnections + '/25', 105, y + 15);
            doc.text('Understanding Dynamics: ' + scores.dynamics + '/25', 25, y + 23);
            doc.text('Finding Leverage Points: ' + scores.leverage + '/25', 105, y + 23);
            y += 34;

            // Tracker Code Box
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 16, 2, 2, 'F');
            doc.setFontSize(8);
            doc.setTextColor(255, 255, 255);
            doc.text('Your Result: ' + level.name + ' | Strongest: ' + dimensionData[highestDim].name, 105, y + 5, { align: 'center' });
            doc.setFontSize(7);
            doc.text('Tracker Code: ' + trackerCode + '  |  Growth Area: ' + dimensionData[lowestDim].name, 105, y + 12, { align: 'center' });
            y += 16;

            // Strength Section
            doc.setFontSize(10);
            doc.setTextColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.text('STRENGTH: ' + dimensionData[highestDim].name, 20, y);
            y += 5;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            y = addWrappedText(dimensionData[highestDim].description, 20, y, 170, 4);
            y += 3;
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            doc.text('High Behaviors:', 20, y);
            y += 4;
            for (var i = 0; i < dimensionData[highestDim].highBehaviors.length; i++) {
                doc.text('- ' + dimensionData[highestDim].highBehaviors[i], 25, y);
                y += 4;
            }
            y += 4;

            // Growth Section
            doc.setFontSize(10);
            doc.setTextColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.text('GROWTH AREA: ' + dimensionData[lowestDim].name, 20, y);
            y += 5;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            y = addWrappedText(dimensionData[lowestDim].description, 20, y, 170, 4);
            y += 3;
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            doc.text('Development Strategies:', 20, y);
            y += 4;
            for (var i = 0; i < dimensionData[lowestDim].development.length; i++) {
                doc.text('-> ' + dimensionData[lowestDim].development[i], 25, y);
                y += 4;
            }
            y += 6;

            // Senge's Laws
            doc.setFontSize(10);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text("SENGE'S SYSTEMS THINKING LAWS", 20, y);
            y += 6;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var laws = [
                "Today's problems come from yesterday's solutions",
                "Faster is slower - sustainable growth takes time",
                "Cause and effect are not closely related in time/space",
                "Small changes can produce big results"
            ];
            for (var i = 0; i < laws.length; i++) {
                doc.text((i+1) + '. ' + laws[i], 25, y);
                y += 5;
            }

            // ===== PAGE 2: SWOT and All Dimensions =====
            doc.addPage();
            y = 20;

            // SWOT Header
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 10, 2, 2, 'F');
            doc.setFontSize(11);
            doc.setTextColor(255, 255, 255);
            doc.text('SWOT ANALYSIS - Systems Thinking', 105, y + 7, { align: 'center' });
            y += 18;

            // SWOT Grid
            var boxW = 82;
            var boxH = 26;

            // Strength
            doc.setFillColor(232, 245, 233);
            doc.roundedRect(20, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.setLineWidth(0.5);
            doc.line(20, y, 20, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.text('STRENGTH', 25, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var sText = 'Strong ' + dimensionData[highestDim].name.toLowerCase() + ' enables better system understanding';
            var sLines = doc.splitTextToSize(sText, boxW - 10);
            for (var i = 0; i < Math.min(sLines.length, 3); i++) {
                doc.text(sLines[i], 25, y + 12 + (i * 4));
            }

            // Weakness
            doc.setFillColor(255, 235, 238);
            doc.roundedRect(108, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(redColor[0], redColor[1], redColor[2]);
            doc.line(108, y, 108, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(redColor[0], redColor[1], redColor[2]);
            doc.text('WEAKNESS', 113, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var wText = 'Lower ' + dimensionData[lowestDim].name.toLowerCase() + ' may cause blind spots';
            var wLines = doc.splitTextToSize(wText, boxW - 10);
            for (var i = 0; i < Math.min(wLines.length, 3); i++) {
                doc.text(wLines[i], 113, y + 12 + (i * 4));
            }

            y += boxH + 5;

            // Opportunity
            doc.setFillColor(227, 242, 253);
            doc.roundedRect(20, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.line(20, y, 20, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.text('OPPORTUNITY', 25, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var oText = 'Develop ' + dimensionData[lowestDim].name.toLowerCase() + ' through practice';
            var oLines = doc.splitTextToSize(oText, boxW - 10);
            for (var i = 0; i < Math.min(oLines.length, 3); i++) {
                doc.text(oLines[i], 25, y + 12 + (i * 4));
            }

            // Threat
            doc.setFillColor(255, 243, 224);
            doc.roundedRect(108, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.line(108, y, 108, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.text('THREAT', 113, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var tText = 'Linear thinking habits may persist under pressure';
            var tLines = doc.splitTextToSize(tText, boxW - 10);
            for (var i = 0; i < Math.min(tLines.length, 3); i++) {
                doc.text(tLines[i], 113, y + 12 + (i * 4));
            }

            y += boxH + 12;

            // All Four Dimensions
            doc.setFontSize(11);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('THE FOUR SYSTEMS THINKING DIMENSIONS', 20, y);
            y += 8;

            var dims = ['holistic', 'interconnections', 'dynamics', 'leverage'];
            var dimColors = {
                holistic: blueColor,
                interconnections: greenColor,
                dynamics: redColor,
                leverage: purpleColor
            };

            for (var d = 0; d < dims.length; d++) {
                var dim = dims[d];
                var dimColor = dimColors[dim];
                var isYours = (dim === highestDim);
                
                if (y > 250) { doc.addPage(); y = 20; }
                
                doc.setFontSize(9);
                doc.setTextColor(dimColor[0], dimColor[1], dimColor[2]);
                doc.text(dimensionData[dim].name + (isYours ? ' (Your Strength)' : '') + ': ' + scores[dim] + '/25', 25, y);
                y += 4;
                doc.setFontSize(7);
                doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
                var descLines = doc.splitTextToSize(dimensionData[dim].description, 165);
                for (var i = 0; i < Math.min(descLines.length, 2); i++) {
                    doc.text(descLines[i], 25, y);
                    y += 3.5;
                }
                y += 4;
            }

            y += 6;

            // Reflection Questions
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 10, 2, 2, 'F');
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('REFLECTION QUESTIONS', 105, y + 7, { align: 'center' });
            y += 16;

            var reflectionQs = [
                "Think of a recent problem. What connections to other issues did you miss?",
                "Where have you seen a 'quick fix' create new problems?",
                "What feedback loops operate in your organization?",
                "Where might small changes create large positive effects?",
                "How could you apply systems thinking to a current challenge?"
            ];
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            for (var i = 0; i < reflectionQs.length; i++) {
                if (y > 275) { doc.addPage(); y = 20; }
                var qLines = doc.splitTextToSize((i + 1) + '. ' + reflectionQs[i], 165);
                for (var j = 0; j < qLines.length; j++) {
                    doc.text(qLines[j], 25, y);
                    y += 4;
                }
                y += 2;
            }

            // Footer on all pages
            var pageCount = doc.internal.getNumberOfPages();
            for (var i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
                doc.text('Page ' + i + ' of ' + pageCount, 105, 287, { align: 'center' });
                doc.text('Chapman University - Argyros College of Business and Economics - MGMT 316', 105, 292, { align: 'center' });
            }

            doc.save('Systems_Thinking_' + studentName.replace(/\s+/g, '_') + '_' + new Date().toISOString().split('T')[0] + '.pdf');
        }
        function restartAssessment() {
            responses = {};
            document.getElementById('studentName').value = '';
            document.getElementById('testDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('results').style.display = 'none';
            document.getElementById('assessment-section').classList.add('hidden');
            document.getElementById('downloadSection').classList.add('hidden');
            document.getElementById('intro-section').classList.remove('hidden');
            document.getElementById('progressFill').style.width = '0%';
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
