<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning Style Assessment | Chapman University</title>
    <style>
        :root {
            --chapman-blue: #00205B;
            --chapman-gold: #C4A000;
            --gold-light: #F5E6A3;
            --blue-light: #E8EDF5;
            --blue-medium: #1A3A7A;
            --text-primary: #1a1a2e;
            --text-secondary: #4a4a5a;
            --white: #ffffff;
            --diverging: #C62828;
            --assimilating: #1565C0;
            --converging: #2E7D32;
            --accommodating: #7B1FA2;
            --ce: #E65100;
            --ro: #00838F;
            --ac: #1565C0;
            --ae: #2E7D32;
            --shadow-subtle: 0 2px 8px rgba(0, 32, 91, 0.08);
            --shadow-medium: 0 4px 20px rgba(0, 32, 91, 0.12);
            --shadow-strong: 0 8px 32px rgba(0, 32, 91, 0.18);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.7;
            color: var(--text-primary);
            background: linear-gradient(135deg, var(--chapman-blue) 0%, var(--blue-medium) 50%, var(--chapman-blue) 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 950px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 16px;
            box-shadow: var(--shadow-strong);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, var(--chapman-blue) 0%, var(--blue-medium) 100%);
            color: var(--white);
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }
        .header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--chapman-gold) 0%, var(--gold-light) 50%, var(--chapman-gold) 100%);
        }
        .institution { font-size: 0.95em; letter-spacing: 2px; text-transform: uppercase; opacity: 0.9; margin-bottom: 5px; }
        .college { font-size: 1.1em; color: var(--chapman-gold); margin-bottom: 20px; font-weight: 600; }
        h1 { font-size: 2.4em; font-weight: 700; margin-bottom: 12px; }
        .subtitle { font-size: 1.15em; font-style: italic; color: var(--gold-light); }
        .content { padding: 35px; }
        .hidden { display: none !important; }

        /* Intro Section */
        .intro-section {
            background: linear-gradient(135deg, var(--blue-light) 0%, #f8f9fc 100%);
            border-radius: 14px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid var(--chapman-blue);
        }
        .intro-section h2 { color: var(--chapman-blue); font-size: 1.4em; margin-bottom: 15px; }
        .intro-section p { color: var(--text-secondary); margin-bottom: 15px; }

        /* Learning Cycle */
        .learning-cycle {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 15px;
            max-width: 500px;
            margin: 25px auto;
            position: relative;
        }
        .learning-cycle::before {
            content: 'üîÑ';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2em;
            background: var(--white);
            padding: 10px;
            border-radius: 50%;
            z-index: 2;
        }
        .cycle-stage {
            padding: 20px 15px;
            border-radius: 12px;
            text-align: center;
            color: var(--white);
        }
        .cycle-stage.ce { background: linear-gradient(135deg, var(--ce), #F57C00); }
        .cycle-stage.ro { background: linear-gradient(135deg, var(--ro), #0097A7); }
        .cycle-stage.ac { background: linear-gradient(135deg, var(--ac), #1976D2); }
        .cycle-stage.ae { background: linear-gradient(135deg, var(--ae), #43A047); }
        .cycle-stage .icon { font-size: 1.8em; margin-bottom: 5px; }
        .cycle-stage .name { font-weight: 700; font-size: 0.85em; }
        .cycle-stage .desc { font-size: 0.7em; opacity: 0.9; }

        /* Style Grid */
        .style-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 25px 0;
        }
        .style-preview {
            padding: 15px 10px;
            border-radius: 10px;
            text-align: center;
            color: var(--white);
            font-size: 0.75em;
        }
        .style-preview.diverging { background: var(--diverging); }
        .style-preview.assimilating { background: var(--assimilating); }
        .style-preview.converging { background: var(--converging); }
        .style-preview.accommodating { background: var(--accommodating); }
        .style-preview .icon { font-size: 1.6em; margin-bottom: 4px; }

        /* Quote Box */
        .quote-box {
            background: linear-gradient(135deg, #fffef8, #fef9e7);
            border-left: 5px solid var(--chapman-gold);
            padding: 25px;
            margin: 25px 0;
            border-radius: 0 12px 12px 0;
        }
        .quote-box blockquote {
            font-style: italic;
            color: var(--text-secondary);
            font-size: 1.05em;
            line-height: 1.6;
        }
        .quote-box cite {
            display: block;
            margin-top: 12px;
            color: var(--chapman-blue);
            font-weight: 600;
            font-style: normal;
        }

        .assessment-meta {
            display: flex;
            gap: 25px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(0, 32, 91, 0.1);
            flex-wrap: wrap;
        }
        .meta-item { display: flex; align-items: center; gap: 8px; color: var(--text-secondary); }
        .meta-icon {
            width: 28px;
            height: 28px;
            background: var(--chapman-blue);
            color: var(--white);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85em;
        }

        /* Student Info */
        .student-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        .input-group { display: flex; flex-direction: column; }
        .input-group label { font-weight: 600; margin-bottom: 8px; color: var(--chapman-blue); }
        .input-group input {
            padding: 14px 16px;
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .input-group input:focus {
            outline: none;
            border-color: var(--chapman-blue);
            box-shadow: 0 0 0 4px rgba(0, 32, 91, 0.08);
        }

        /* Instructions */
        .instructions-box {
            background: linear-gradient(135deg, #fffef8 0%, #fef9e7 100%);
            border: 2px solid var(--chapman-gold);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .instructions-box h3 { color: var(--chapman-blue); margin-bottom: 15px; }
        .instructions-box p { color: var(--text-secondary); margin-bottom: 10px; }

        /* Progress */
        .progress-container { margin-bottom: 25px; }
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9em;
            color: var(--text-secondary);
        }
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e8ecf0;
            border-radius: 5px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--chapman-blue) 0%, var(--chapman-gold) 100%);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Question Container - Ranking Style */
        .question-container {
            background: var(--white);
            border-radius: 14px;
            border: 2px solid #e8ecf0;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        .question-container:hover {
            border-color: var(--chapman-blue);
            box-shadow: var(--shadow-medium);
        }
        .question-container.answered {
            border-color: var(--chapman-gold);
            background: linear-gradient(135deg, #fffef8 0%, var(--white) 100%);
        }
        .question-stem {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--chapman-blue);
            margin-bottom: 20px;
        }
        .question-number {
            color: var(--chapman-gold);
            margin-right: 8px;
        }

        /* Ranking Options */
        .ranking-instruction {
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-bottom: 15px;
            padding: 10px 15px;
            background: var(--blue-light);
            border-radius: 8px;
        }
        .ranking-options {
            display: grid;
            gap: 12px;
        }
        .ranking-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #fafbfc;
            border: 2px solid #e8ecf0;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        .ranking-option:hover {
            border-color: var(--chapman-blue);
            background: var(--blue-light);
        }
        .option-letter {
            width: 36px;
            height: 36px;
            background: var(--chapman-blue);
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }
        .option-text {
            flex: 1;
            color: var(--text-primary);
            font-size: 0.95em;
        }
        .rank-select {
            padding: 8px 12px;
            border: 2px solid #e8ecf0;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            color: var(--chapman-blue);
            background: var(--white);
            cursor: pointer;
            min-width: 60px;
        }
        .rank-select:focus {
            outline: none;
            border-color: var(--chapman-gold);
        }
        .rank-select.selected {
            background: var(--chapman-gold);
            color: var(--chapman-blue);
            border-color: var(--chapman-gold);
        }

        /* Buttons */
        .controls { text-align: center; margin: 30px 0; }
        .btn {
            border: none;
            padding: 16px 40px;
            font-size: 1.05em;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 8px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--chapman-blue) 0%, var(--blue-medium) 100%);
            color: var(--white);
            box-shadow: 0 4px 15px rgba(0, 32, 91, 0.3);
        }
        .btn-primary:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0, 32, 91, 0.4); }
        .btn-secondary {
            background: linear-gradient(135deg, var(--chapman-gold) 0%, #d4b000 100%);
            color: var(--chapman-blue);
        }
        .btn-secondary:hover { transform: translateY(-3px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none !important; }
        .btn-outline {
            background: transparent;
            border: 2px solid var(--chapman-blue);
            color: var(--chapman-blue);
        }

        /* Results */
        .results { display: none; margin-top: 30px; }
        .results-header {
            background: linear-gradient(135deg, var(--chapman-blue) 0%, var(--blue-medium) 100%);
            color: var(--white);
            padding: 40px;
            text-align: center;
            border-radius: 16px 16px 0 0;
        }
        .results-header h2 { font-size: 1.8em; margin-bottom: 10px; }
        .results-header .student-name { font-size: 1.3em; color: var(--chapman-gold); margin-bottom: 8px; }
        .results-header .date { opacity: 0.9; }

        /* Style Display */
        .style-display {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            padding: 40px;
            text-align: center;
        }
        .style-main {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            flex-wrap: wrap;
        }
        .style-badge {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--white);
            box-shadow: 0 8px 30px rgba(0,0,0,0.3);
        }
        .style-badge.diverging { background: linear-gradient(135deg, var(--diverging), #D32F2F); }
        .style-badge.assimilating { background: linear-gradient(135deg, var(--assimilating), #1976D2); }
        .style-badge.converging { background: linear-gradient(135deg, var(--converging), #43A047); }
        .style-badge.accommodating { background: linear-gradient(135deg, var(--accommodating), #9C27B0); }
        .style-badge .icon { font-size: 3em; margin-bottom: 5px; }
        .style-badge .name { font-weight: 700; font-size: 1.1em; }
        .style-info-box {
            text-align: left;
            padding: 25px;
            background: rgba(255,255,255,0.1);
            border-radius: 14px;
            max-width: 400px;
        }
        .style-info-box .subtitle {
            color: var(--chapman-gold);
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .style-info-box .desc {
            color: rgba(255,255,255,0.9);
            font-size: 0.95em;
            line-height: 1.7;
        }

        /* Scores Display */
        .scores-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            padding: 25px;
            background: linear-gradient(135deg, #3a5068, #2c3e50);
        }
        .score-card {
            background: rgba(255,255,255,0.1);
            padding: 20px 15px;
            border-radius: 14px;
            text-align: center;
            color: var(--white);
        }
        .score-card .icon { font-size: 1.6em; margin-bottom: 6px; }
        .score-card .name { font-size: 0.75em; margin-bottom: 6px; opacity: 0.9; }
        .score-card .score { font-size: 2em; font-weight: 700; }
        .score-card .max { font-size: 0.7em; opacity: 0.7; }

        .results-body { background: var(--blue-light); padding: 35px; border-radius: 0 0 16px 16px; }

        /* Learning Style Card */
        .learning-card {
            background: var(--white);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-medium);
            border-top: 5px solid var(--chapman-blue);
        }
        .learning-card.diverging { border-top-color: var(--diverging); }
        .learning-card.assimilating { border-top-color: var(--assimilating); }
        .learning-card.converging { border-top-color: var(--converging); }
        .learning-card.accommodating { border-top-color: var(--accommodating); }

        .learning-header { display: flex; align-items: center; gap: 18px; margin-bottom: 18px; }
        .learning-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            color: var(--white);
        }
        .learning-icon.diverging { background: var(--diverging); }
        .learning-icon.assimilating { background: var(--assimilating); }
        .learning-icon.converging { background: var(--converging); }
        .learning-icon.accommodating { background: var(--accommodating); }
        .learning-info h3 { font-size: 1.6em; color: var(--chapman-blue); margin-bottom: 4px; }
        .learning-info .learning-subtitle { color: var(--chapman-gold); font-weight: 600; font-size: 1.1em; }
        .learning-description { color: var(--text-secondary); line-height: 1.8; margin-bottom: 20px; }

        /* Characteristics */
        .char-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .char-box {
            padding: 20px;
            border-radius: 12px;
        }
        .char-box.strengths { background: #E8F5E9; border-left: 4px solid #2E7D32; }
        .char-box.strategies { background: #E3F2FD; border-left: 4px solid #1565C0; }
        .char-box h5 { margin-bottom: 12px; font-size: 1em; color: var(--text-primary); }
        .char-box ul { list-style: none; padding: 0; margin: 0; }
        .char-box li {
            padding: 8px 0 8px 24px;
            position: relative;
            font-size: 0.95em;
            color: var(--text-secondary);
        }
        .char-box.strengths li::before { content: '‚úì'; position: absolute; left: 0; color: #2E7D32; font-weight: bold; }
        .char-box.strategies li::before { content: '‚Üí'; position: absolute; left: 0; color: #1565C0; font-weight: bold; }

        /* Result Sections */
        .result-section {
            background: var(--white);
            border-radius: 14px;
            padding: 28px;
            margin-bottom: 20px;
            border-left: 5px solid var(--chapman-blue);
            box-shadow: var(--shadow-subtle);
        }
        .result-section.gold-accent { border-left-color: var(--chapman-gold); }
        .result-section h4 { color: var(--chapman-blue); margin-bottom: 18px; }

        /* Comparison Table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.8em;
        }
        .comparison-table th, .comparison-table td {
            padding: 10px 8px;
            text-align: left;
            border-bottom: 1px solid #e8ecf0;
        }
        .comparison-table th {
            background: var(--blue-light);
            color: var(--chapman-blue);
            font-weight: 600;
        }
        .comparison-table td { color: var(--text-secondary); }

        /* Reflection */
        .reflection-section {
            background: linear-gradient(135deg, var(--blue-light) 0%, #f0f4fa 100%);
            border-radius: 14px;
            padding: 30px;
            margin-top: 25px;
            border: 2px solid var(--chapman-blue);
        }
        .reflection-section h4 { color: var(--chapman-blue); margin-bottom: 20px; text-align: center; }
        .reflection-questions { counter-reset: reflection; }
        .reflection-question {
            padding: 18px 20px 18px 50px;
            position: relative;
            background: var(--white);
            border-radius: 10px;
            margin-bottom: 12px;
            color: var(--text-secondary);
        }
        .reflection-question::before {
            counter-increment: reflection;
            content: counter(reflection);
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 26px;
            height: 26px;
            background: var(--chapman-blue);
            color: var(--white);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85em;
            font-weight: 700;
        }

        .footer {
            text-align: center;
            padding: 25px;
            color: var(--text-secondary);
            font-size: 0.9em;
            border-top: 1px solid #e8ecf0;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .student-info, .char-grid { grid-template-columns: 1fr; }
            .learning-cycle, .scores-grid, .style-grid { grid-template-columns: repeat(2, 1fr); }
            .style-main { flex-direction: column; }
            h1 { font-size: 1.8em; }
            .learning-header { flex-direction: column; text-align: center; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="institution">Chapman University</div>
            <div class="college">Argyros College of Business and Economics</div>
            <h1>Learning Style Assessment</h1>
            <div class="subtitle">Based on Kolb's Experiential Learning Theory</div>
        </div>

        <div class="content">
            <!-- Intro Section -->
            <div id="intro-section">
                <div class="intro-section">
                    <h2>üìö How Do You Learn Best?</h2>
                    <p><strong>David Kolb's Experiential Learning Theory</strong> describes learning as a four-stage cycle. While effective learners use all four stages, most people have preferences for certain stages over others ‚Äî this creates your learning style.</p>
                    <p>Understanding your learning style helps you leverage your strengths, develop weaker areas, and adapt to different learning situations more effectively.</p>

                    <div class="learning-cycle">
                        <div class="cycle-stage ce">
                            <div class="icon">‚ù§Ô∏è</div>
                            <div class="name">Concrete Experience</div>
                            <div class="desc">Feeling</div>
                        </div>
                        <div class="cycle-stage ro">
                            <div class="icon">üëÅÔ∏è</div>
                            <div class="name">Reflective Observation</div>
                            <div class="desc">Watching</div>
                        </div>
                        <div class="cycle-stage ac">
                            <div class="icon">üß†</div>
                            <div class="name">Abstract Conceptualization</div>
                            <div class="desc">Thinking</div>
                        </div>
                        <div class="cycle-stage ae">
                            <div class="icon">üñêÔ∏è</div>
                            <div class="name">Active Experimentation</div>
                            <div class="desc">Doing</div>
                        </div>
                    </div>

                    <div class="style-grid">
                        <div class="style-preview diverging">
                            <div class="icon">üé®</div>
                            <div>Diverging</div>
                        </div>
                        <div class="style-preview assimilating">
                            <div class="icon">üìä</div>
                            <div>Assimilating</div>
                        </div>
                        <div class="style-preview converging">
                            <div class="icon">üîß</div>
                            <div>Converging</div>
                        </div>
                        <div class="style-preview accommodating">
                            <div class="icon">üöÄ</div>
                            <div>Accommodating</div>
                        </div>
                    </div>

                    <div class="quote-box">
                        <blockquote>"Learning is the process whereby knowledge is created through the transformation of experience."</blockquote>
                        <cite>‚Äî David Kolb, Experiential Learning (1984)</cite>
                    </div>

                    <div class="assessment-meta">
                        <div class="meta-item"><div class="meta-icon">‚è±</div><span>10-12 minutes</span></div>
                        <div class="meta-item"><div class="meta-icon">üìù</div><span>12 learning scenarios</span></div>
                        <div class="meta-item"><div class="meta-icon">üéØ</div><span>4 learning styles</span></div>
                    </div>
                </div>

                <div class="student-info">
                    <div class="input-group">
                        <label for="studentName">Your Full Name</label>
                        <input type="text" id="studentName" placeholder="Enter your full name">
                    </div>
                    <div class="input-group">
                        <label for="testDate">Assessment Date</label>
                        <input type="date" id="testDate">
                    </div>
                </div>

                <div class="instructions-box">
                    <h3>üìå How to Complete This Assessment</h3>
                    <p>For each scenario, you'll see four approaches representing different ways of learning. <strong>Rank all four options</strong> from 4 (most like you) to 1 (least like you). Each number can only be used once per question.</p>
                    <p style="color: var(--chapman-blue); font-weight: 600;">Remember: There are no right or wrong answers ‚Äî just different ways of learning.</p>
                </div>

                <div class="controls">
                    <button class="btn btn-primary" onclick="startAssessment()">Begin Assessment ‚Üí</button>
                </div>
            </div>

            <!-- Assessment Section -->
            <div id="assessment-section" class="hidden">
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Assessment Progress</span>
                        <span id="progressText">0 of 12 scenarios completed</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>

                <div id="questions-container"></div>

                <div class="controls">
                    <button class="btn btn-primary" id="submitBtn" onclick="calculateResults()" disabled>Discover My Learning Style ‚Üí</button>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results" class="results"></div>

            <div id="downloadSection" class="hidden controls">
                <button class="btn btn-secondary" onclick="generatePDF()">üìÑ Download PDF Report</button>
                <button class="btn btn-outline" onclick="restartAssessment()">Take Assessment Again</button>
            </div>
        </div>

        <div class="footer">
            <p>Learning Style Assessment ‚Ä¢ Based on Kolb's Experiential Learning Theory (1984)</p>
            <p>Chapman University ‚Ä¢ Argyros College of Business and Economics</p>
            <p style="margin-top: 8px; font-size: 0.85em;">¬© 2024 Professor Chip Monaco ‚Ä¢ MGMT 316</p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Learning scenarios - each has 4 options (CE, RO, AC, AE)
        const scenarios = [
            {
                id: 1,
                stem: "When learning something new, I prefer to:",
                options: {
                    ce: "Jump in and experience it firsthand",
                    ro: "Watch others do it first and reflect on what I observe",
                    ac: "Read about the theory and underlying concepts",
                    ae: "Try different approaches and see what works"
                }
            },
            {
                id: 2,
                stem: "I learn best when I:",
                options: {
                    ce: "Can relate the material to my personal experiences",
                    ro: "Have time to think carefully before acting",
                    ac: "Can analyze and organize information logically",
                    ae: "Can immediately apply what I'm learning"
                }
            },
            {
                id: 3,
                stem: "When solving a problem, I tend to:",
                options: {
                    ce: "Trust my intuition and gut feelings",
                    ro: "Observe the situation from different perspectives",
                    ac: "Analyze the problem systematically using logic",
                    ae: "Try different solutions to see what works"
                }
            },
            {
                id: 4,
                stem: "In a training session, I prefer:",
                options: {
                    ce: "Simulations and role-playing exercises",
                    ro: "Case studies and examples to observe and discuss",
                    ac: "Lectures and readings that explain concepts",
                    ae: "Hands-on practice and real-world applications"
                }
            },
            {
                id: 5,
                stem: "When making decisions, I rely most on:",
                options: {
                    ce: "My feelings and personal values",
                    ro: "Careful observation and reflection",
                    ac: "Logical analysis and rational thinking",
                    ae: "Testing ideas through action"
                }
            },
            {
                id: 6,
                stem: "I am most productive when:",
                options: {
                    ce: "I feel personally connected to the task",
                    ro: "I can step back and consider multiple viewpoints",
                    ac: "I have a clear conceptual framework to follow",
                    ae: "I can take action and see immediate results"
                }
            },
            {
                id: 7,
                stem: "When faced with a new idea, I first want to:",
                options: {
                    ce: "Understand how it affects people emotionally",
                    ro: "Observe how it works in practice",
                    ac: "Understand the theory behind it",
                    ae: "Try it out and see what happens"
                }
            },
            {
                id: 8,
                stem: "In a team project, I naturally take the role of:",
                options: {
                    ce: "The one who brings creativity and generates ideas",
                    ro: "The one who gathers information and analyzes options",
                    ac: "The one who develops plans and conceptual frameworks",
                    ae: "The one who drives execution and gets things done"
                }
            },
            {
                id: 9,
                stem: "When I encounter difficulties, I:",
                options: {
                    ce: "Explore my feelings about the situation",
                    ro: "Step back and reflect on what's happening",
                    ac: "Try to understand why it's happening logically",
                    ae: "Take action to try to fix it immediately"
                }
            },
            {
                id: 10,
                stem: "I prefer instructors who:",
                options: {
                    ce: "Create an engaging, experiential environment",
                    ro: "Provide examples and time for reflection",
                    ac: "Present material in a logical, organized way",
                    ae: "Focus on practical application and practice"
                }
            },
            {
                id: 11,
                stem: "When starting a new project, I first:",
                options: {
                    ce: "Get a feel for what's involved and who's affected",
                    ro: "Research how similar projects have been done",
                    ac: "Create a detailed plan based on sound principles",
                    ae: "Start working and figure it out as I go"
                }
            },
            {
                id: 12,
                stem: "I consider myself someone who:",
                options: {
                    ce: "Is imaginative and feeling-oriented",
                    ro: "Is reflective and observant",
                    ac: "Is analytical and logical",
                    ae: "Is practical and action-oriented"
                }
            }
        ];

        // Learning style definitions
        const styleData = {
            diverging: {
                name: "Diverging",
                icon: "üé®",
                color: "#C62828",
                subtitle: "Feel and Watch (CE + RO)",
                dominant: ["Concrete Experience", "Reflective Observation"],
                description: "Divergers are best at viewing concrete situations from many different points of view. They prefer to watch rather than do, gathering information and using imagination to solve problems. They excel at brainstorming, generating ideas, and understanding people.",
                profileSummary: "You are an imaginative learner who excels at generating ideas and seeing situations from multiple angles. You learn best through concrete experiences that you can reflect upon, and you value personal meaning in what you learn.",
                howYouLearn: "You prefer to observe and feel before acting. You learn best when you can explore multiple perspectives, engage in brainstorming, and connect learning to personal experience and emotions.",
                bestEnvironment: "Group discussions, brainstorming sessions, open-ended problems, and environments that encourage imagination and personal reflection.",
                challengingEnvironment: "Highly structured, single-answer situations; time-pressured decisions; environments that discourage exploration of alternatives.",
                strengths: [
                    "Excellent at generating ideas and brainstorming",
                    "Strong imagination and creative thinking",
                    "Good at seeing situations from multiple perspectives",
                    "Sensitive to people's feelings and concerns",
                    "Interested in people and cultural experiences",
                    "Open-minded and adaptable"
                ],
                strategies: [
                    "Use brainstorming before diving into analysis",
                    "Seek diverse perspectives on problems",
                    "Connect learning to personal meaning",
                    "Use visual aids and mind maps",
                    "Work in groups to generate ideas",
                    "Take time to reflect before acting"
                ],
                careers: "Counseling, HR, arts, humanities, customer service, organizational development",
                swotStrength: "Creative idea generation and multi-perspective thinking",
                swotWeakness: "May struggle with decisive action and implementation",
                swotOpportunity: "Develop decision-making frameworks to move from ideas to action",
                swotThreat: "Analysis paralysis; difficulty in fast-paced, action-oriented environments"
            },
            assimilating: {
                name: "Assimilating",
                icon: "üìä",
                color: "#1565C0",
                subtitle: "Think and Watch (AC + RO)",
                dominant: ["Abstract Conceptualization", "Reflective Observation"],
                description: "Assimilators are best at understanding a wide range of information and putting it into concise, logical form. They are more interested in abstract ideas and concepts than in people. They prefer readings, lectures, and having time to think things through.",
                profileSummary: "You are a logical, theory-oriented learner who excels at organizing information into coherent frameworks. You prefer to understand the 'big picture' through careful analysis before taking action.",
                howYouLearn: "You learn best through lectures, readings, and time to process information independently. You prefer organized, systematic presentations that build theoretical understanding.",
                bestEnvironment: "Structured academic settings, independent study, lectures, research projects, and environments that value precision and logical analysis.",
                challengingEnvironment: "Unstructured, hands-on situations; group activities without clear direction; environments requiring immediate action without planning.",
                strengths: [
                    "Excellent at organizing information logically",
                    "Strong ability to create theoretical models",
                    "Good at inductive reasoning",
                    "Prefers precision and systematic analysis",
                    "Values logic and abstract concepts",
                    "Effective at planning and research"
                ],
                strategies: [
                    "Start with theory before application",
                    "Request organized, logical presentations",
                    "Take time to process and integrate information",
                    "Create models and frameworks",
                    "Read extensively before acting",
                    "Seek structured learning environments"
                ],
                careers: "Research, planning, academia, science, information technology, finance",
                swotStrength: "Theoretical understanding and systematic analysis",
                swotWeakness: "May over-analyze and delay practical application",
                swotOpportunity: "Develop comfort with ambiguity and imperfect information",
                swotThreat: "Missing opportunities due to extended analysis; disconnect from practical realities"
            },
            converging: {
                name: "Converging",
                icon: "üîß",
                color: "#2E7D32",
                subtitle: "Think and Do (AC + AE)",
                dominant: ["Abstract Conceptualization", "Active Experimentation"],
                description: "Convergers are best at finding practical uses for ideas and theories. They prefer dealing with technical tasks and problems rather than social and interpersonal issues. They excel at making decisions, solving problems, and applying ideas.",
                profileSummary: "You are a practical, solution-oriented learner who excels at applying theories to solve real problems. You prefer to work with things rather than people and value efficiency and results.",
                howYouLearn: "You learn best through hands-on experimentation with ideas and theories. You prefer to understand concepts and immediately apply them to practical problems.",
                bestEnvironment: "Technical problem-solving, simulations, lab work, case studies with clear solutions, and environments that reward practical application.",
                challengingEnvironment: "Open-ended discussions without clear direction; highly interpersonal situations; environments that emphasize process over results.",
                strengths: [
                    "Excellent at practical application of ideas",
                    "Strong problem-solving abilities",
                    "Good at making decisions and finding solutions",
                    "Prefers technical tasks over interpersonal ones",
                    "Effective at deductive reasoning",
                    "Results-oriented and efficient"
                ],
                strategies: [
                    "Focus on practical applications immediately",
                    "Seek opportunities to test theories",
                    "Work on well-defined problems",
                    "Use simulations and technical exercises",
                    "Ask 'How can I apply this?'",
                    "Set specific goals and measure results"
                ],
                careers: "Engineering, technology, medicine, physical sciences, specialist roles",
                swotStrength: "Practical problem-solving and efficient implementation",
                swotWeakness: "May overlook interpersonal dynamics and creative alternatives",
                swotOpportunity: "Develop people skills to enhance technical effectiveness",
                swotThreat: "Missing innovative solutions by focusing too narrowly on proven approaches"
            },
            accommodating: {
                name: "Accommodating",
                icon: "üöÄ",
                color: "#7B1FA2",
                subtitle: "Feel and Do (CE + AE)",
                dominant: ["Concrete Experience", "Active Experimentation"],
                description: "Accommodators are best at learning from hands-on experience. They prefer to act on gut feelings rather than logical analysis. They tend to rely on people for information rather than their own technical analysis, and they excel at adapting to changing circumstances.",
                profileSummary: "You are an action-oriented learner who excels at getting things done through trial and error. You prefer to dive in and learn from experience rather than study theory first.",
                howYouLearn: "You learn best by doing. You prefer hands-on experiences, field work, and the opportunity to figure things out through experimentation rather than instruction.",
                bestEnvironment: "Action-oriented projects, field experiences, role-playing, simulations with real consequences, and environments that reward initiative and adaptability.",
                challengingEnvironment: "Lecture-heavy environments; situations requiring extensive reading before action; highly theoretical discussions without practical application.",
                strengths: [
                    "Excellent at getting things done",
                    "Strong at adapting to new situations",
                    "Good at taking action in uncertain conditions",
                    "Comfortable taking risks and experimenting",
                    "Prefers people to technical analysis",
                    "Effective at leading and initiating"
                ],
                strategies: [
                    "Learn by doing, not reading",
                    "Seek hands-on, experiential opportunities",
                    "Set goals and take action quickly",
                    "Work with others on practical projects",
                    "Don't overanalyze ‚Äî try things",
                    "Learn from mistakes through iteration"
                ],
                careers: "Marketing, sales, management, entrepreneurship, action-oriented roles",
                swotStrength: "Action orientation and adaptability in uncertain situations",
                swotWeakness: "May act before fully understanding; may repeat preventable mistakes",
                swotOpportunity: "Develop analytical skills to complement action orientation",
                swotThreat: "Costly errors from insufficient planning; frustration in highly analytical environments"
            }
        };

        let responses = {};
        let studentName = '';
        let surveyDate = '';

        // Robust auto-date initialization with multiple fallbacks
        function setTodayDate() {
            var dateField = document.getElementById('testDate');
            if (dateField && !dateField.value) {
                dateField.value = new Date().toISOString().split('T')[0];
            }
        }
        // Try immediately
        setTodayDate();
        // Try on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', setTodayDate);
        // Try on window load
        window.addEventListener('load', setTodayDate);
        // Try with requestAnimationFrame
        requestAnimationFrame(setTodayDate);
        // Try with setTimeout fallbacks
        setTimeout(setTodayDate, 0);
        setTimeout(setTodayDate, 100);
        setTimeout(setTodayDate, 500);

        function startAssessment() {
            studentName = document.getElementById('studentName').value.trim();
            surveyDate = document.getElementById('testDate').value;
            if (!studentName) { alert('Please enter your name.'); return; }
            if (!surveyDate) { alert('Please select a date.'); return; }
            
            document.getElementById('intro-section').classList.add('hidden');
            document.getElementById('assessment-section').classList.remove('hidden');
            renderQuestions();
        }

        function renderQuestions() {
            const container = document.getElementById('questions-container');
            let html = '';

            scenarios.forEach((scenario, index) => {
                const modes = ['ce', 'ro', 'ac', 'ae'];
                // Shuffle options order for each question
                const shuffledModes = [...modes].sort(() => Math.random() - 0.5);
                
                html += `
                    <div class="question-container" id="q-container-${scenario.id}">
                        <div class="question-stem">
                            <span class="question-number">${index + 1}.</span>
                            ${scenario.stem}
                        </div>
                        <div class="ranking-instruction">
                            Rank from 4 (most like you) to 1 (least like you). Use each number only once.
                        </div>
                        <div class="ranking-options">
                            ${shuffledModes.map((mode, i) => `
                                <div class="ranking-option">
                                    <div class="option-letter">${String.fromCharCode(65 + i)}</div>
                                    <div class="option-text">${scenario.options[mode]}</div>
                                    <select class="rank-select" id="q${scenario.id}_${mode}" onchange="handleRankChange(${scenario.id}, '${mode}', this.value)">
                                        <option value="">‚Äî</option>
                                        <option value="4">4</option>
                                        <option value="3">3</option>
                                        <option value="2">2</option>
                                        <option value="1">1</option>
                                    </select>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function handleRankChange(questionId, mode, value) {
            if (!responses[questionId]) {
                responses[questionId] = {};
            }
            
            if (value) {
                responses[questionId][mode] = parseInt(value);
            } else {
                delete responses[questionId][mode];
            }

            // Update visual feedback
            const select = document.getElementById(`q${questionId}_${mode}`);
            if (value) {
                select.classList.add('selected');
            } else {
                select.classList.remove('selected');
            }

            // Check if question is complete
            const questionResponses = responses[questionId];
            const values = Object.values(questionResponses);
            const isComplete = values.length === 4 && 
                              new Set(values).size === 4 &&
                              values.every(v => v >= 1 && v <= 4);
            
            if (isComplete) {
                document.getElementById(`q-container-${questionId}`).classList.add('answered');
            } else {
                document.getElementById(`q-container-${questionId}`).classList.remove('answered');
            }

            updateProgress();
        }

        function updateProgress() {
            let completed = 0;
            scenarios.forEach(s => {
                const qr = responses[s.id];
                if (qr) {
                    const values = Object.values(qr);
                    if (values.length === 4 && new Set(values).size === 4) {
                        completed++;
                    }
                }
            });

            const progress = (completed / 12) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = `${completed} of 12 scenarios completed`;
            document.getElementById('submitBtn').disabled = completed < 12;
        }

        function calculateResults() {
            // Validate all responses
            let valid = true;
            scenarios.forEach(s => {
                const qr = responses[s.id];
                if (!qr || Object.values(qr).length !== 4 || new Set(Object.values(qr)).size !== 4) {
                    valid = false;
                }
            });

            if (!valid) {
                alert('Please complete all scenarios. Each scenario needs ranks 1-4, with each number used exactly once.');
                return;
            }

            // Calculate scores for each mode
            const scores = { ce: 0, ro: 0, ac: 0, ae: 0 };
            scenarios.forEach(s => {
                Object.entries(responses[s.id]).forEach(([mode, rank]) => {
                    scores[mode] += rank;
                });
            });

            displayResults(scores);
        }

        function displayResults(scores) {
            const maxScore = 48; // 12 scenarios √ó 4 max

            // Calculate AC-CE and AE-RO to determine style
            const acCE = scores.ac - scores.ce; // positive = thinking, negative = feeling
            const aeRO = scores.ae - scores.ro; // positive = doing, negative = watching

            // Determine learning style based on quadrant
            let styleKey;
            if (acCE <= 0 && aeRO <= 0) {
                styleKey = 'diverging';     // Feel + Watch
            } else if (acCE > 0 && aeRO <= 0) {
                styleKey = 'assimilating';  // Think + Watch
            } else if (acCE > 0 && aeRO > 0) {
                styleKey = 'converging';    // Think + Do
            } else {
                styleKey = 'accommodating'; // Feel + Do
            }

            const style = styleData[styleKey];

            // Calculate additional metrics for tracker
            const pctCE = Math.round((scores.ce / maxScore) * 100);
            const pctRO = Math.round((scores.ro / maxScore) * 100);
            const pctAC = Math.round((scores.ac / maxScore) * 100);
            const pctAE = Math.round((scores.ae / maxScore) * 100);
            
            // Determine processing and perception preferences
            const processingPreference = acCE <= 0 ? 'Feeling (Concrete)' : 'Thinking (Abstract)';
            const perceptionPreference = aeRO <= 0 ? 'Watching (Reflective)' : 'Doing (Active)';
            
            // Calculate style clarity (how strongly they lean toward their style)
            const styleClarity = Math.abs(acCE) + Math.abs(aeRO);
            const clarityLevel = styleClarity >= 20 ? 'Strong' : styleClarity >= 10 ? 'Moderate' : 'Balanced';
            
            // Generate tracker code
            const trackerCode = `LRN-${styleKey.charAt(0).toUpperCase()}${styleKey.charAt(1)}-${clarityLevel.charAt(0)}`;

            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <div class="results-header">
                    <h2>üìö Your Learning Style Profile</h2>
                    <div class="student-name">${studentName}</div>
                    <div class="date">Completed: ${new Date(surveyDate).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                </div>

                <!-- TRACKER SUMMARY SECTION -->
                <div style="background: linear-gradient(135deg, #1a3a7a 0%, #00205B 100%); color: white; padding: 25px; border-radius: 14px; margin: 20px 0;">
                    <h3 style="color: #C4A000; margin-bottom: 15px; font-size: 1.3em;">üìã Assessment Tracker Summary</h3>
                    <p style="font-size: 0.9em; opacity: 0.9; margin-bottom: 15px;">Copy this information into your Assessment Tracker at the end of the semester.</p>
                    
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px;">Learning Style</div>
                                <div style="font-size: 1.4em; font-weight: 700; color: #F5E6A3;">${style.name}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px;">Style Clarity</div>
                                <div style="font-size: 1.2em; font-weight: 600;">${clarityLevel}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px;">Processing Preference</div>
                                <div style="font-size: 1.1em; font-weight: 600;">${processingPreference}</div>
                            </div>
                            <div>
                                <div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px;">Perception Preference</div>
                                <div style="font-size: 1.1em; font-weight: 600;">${perceptionPreference}</div>
                            </div>
                        </div>
                    </div>

                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;">Learning Mode Scores</div>
                        <div style="font-family: monospace; font-size: 1em;">
                            CE: ${scores.ce}/48 (${pctCE}%) | RO: ${scores.ro}/48 (${pctRO}%) | AC: ${scores.ac}/48 (${pctAC}%) | AE: ${scores.ae}/48 (${pctAE}%)
                        </div>
                        <div style="font-family: monospace; font-size: 0.9em; margin-top: 8px; opacity: 0.8;">
                            AC-CE: ${acCE} (${acCE > 0 ? 'Thinking' : 'Feeling'}) | AE-RO: ${aeRO} (${aeRO > 0 ? 'Doing' : 'Watching'})
                        </div>
                    </div>

                    <div style="background: rgba(196, 160, 0, 0.2); padding: 15px; border-radius: 8px; border-left: 4px solid #C4A000;">
                        <div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;">Key Characteristics for SWOT Analysis</div>
                        <div style="font-size: 0.95em; line-height: 1.6;">
                            <strong>Profile:</strong> ${style.profileSummary}<br>
                            <strong>Best Environment:</strong> ${style.bestEnvironment}<br>
                            <strong>Challenge Area:</strong> ${style.challengingEnvironment}<br>
                            <strong>Career Fit:</strong> ${style.careers}
                        </div>
                    </div>

                    <div style="margin-top: 15px; padding: 12px; background: rgba(255,255,255,0.1); border-radius: 8px; font-family: monospace; font-size: 0.85em;">
                        <span style="opacity: 0.7;">Tracker Code:</span> <strong style="color: #F5E6A3;">${trackerCode}</strong> 
                        <span style="opacity: 0.7; margin-left: 15px;">|</span>
                        <span style="opacity: 0.7; margin-left: 15px;">Raw:</span> <strong>CE${scores.ce}-RO${scores.ro}-AC${scores.ac}-AE${scores.ae}</strong>
                    </div>
                </div>

                <div class="style-display">
                    <div class="style-main">
                        <div class="style-badge ${styleKey}">
                            <div class="icon">${style.icon}</div>
                            <div class="name">${style.name}</div>
                        </div>
                        <div class="style-info-box">
                            <div class="subtitle">${style.subtitle}</div>
                            <div class="desc">Your dominant learning modes are <strong>${style.dominant[0]}</strong> and <strong>${style.dominant[1]}</strong>. You learn best through ${styleKey === 'diverging' ? 'feeling and watching' : styleKey === 'assimilating' ? 'thinking and watching' : styleKey === 'converging' ? 'thinking and doing' : 'feeling and doing'}.</div>
                        </div>
                    </div>
                </div>

                <div class="scores-grid">
                    <div class="score-card">
                        <div class="icon">‚ù§Ô∏è</div>
                        <div class="name">Concrete Experience</div>
                        <div class="score">${scores.ce}</div>
                        <div class="max">of ${maxScore}</div>
                    </div>
                    <div class="score-card">
                        <div class="icon">üëÅÔ∏è</div>
                        <div class="name">Reflective Observation</div>
                        <div class="score">${scores.ro}</div>
                        <div class="max">of ${maxScore}</div>
                    </div>
                    <div class="score-card">
                        <div class="icon">üß†</div>
                        <div class="name">Abstract Conceptualization</div>
                        <div class="score">${scores.ac}</div>
                        <div class="max">of ${maxScore}</div>
                    </div>
                    <div class="score-card">
                        <div class="icon">üñêÔ∏è</div>
                        <div class="name">Active Experimentation</div>
                        <div class="score">${scores.ae}</div>
                        <div class="max">of ${maxScore}</div>
                    </div>
                </div>

                <div class="results-body">
                    <div class="learning-card ${styleKey}">
                        <div class="learning-header">
                            <div class="learning-icon ${styleKey}">${style.icon}</div>
                            <div class="learning-info">
                                <h3>${style.name}</h3>
                                <div class="learning-subtitle">${style.subtitle}</div>
                            </div>
                        </div>
                        <p class="learning-description">${style.description}</p>
                        
                        <!-- Enhanced Profile Section -->
                        <div style="background: linear-gradient(135deg, #fffef8 0%, #fef9e7 100%); padding: 20px; border-radius: 12px; margin: 20px 0; border-left: 4px solid #C4A000;">
                            <h5 style="color: var(--chapman-blue); margin-bottom: 12px;">üìã Your Learning Profile</h5>
                            <p style="color: var(--text-secondary); margin-bottom: 15px; line-height: 1.7;">${style.profileSummary}</p>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                <div style="padding: 12px; background: rgba(0,32,91,0.05); border-radius: 8px;">
                                    <strong style="color: var(--chapman-blue); font-size: 0.85em; text-transform: uppercase;">How You Learn Best</strong>
                                    <p style="margin-top: 5px; font-size: 0.9em; color: var(--text-secondary);">${style.howYouLearn}</p>
                                </div>
                                <div style="padding: 12px; background: rgba(0,32,91,0.05); border-radius: 8px;">
                                    <strong style="color: var(--chapman-blue); font-size: 0.85em; text-transform: uppercase;">Ideal Environment</strong>
                                    <p style="margin-top: 5px; font-size: 0.9em; color: var(--text-secondary);">${style.bestEnvironment}</p>
                                </div>
                            </div>
                            <div style="margin-top: 15px; padding: 12px; background: rgba(198,40,40,0.05); border-radius: 8px;">
                                <strong style="color: #C62828; font-size: 0.85em; text-transform: uppercase;">Challenging Situations</strong>
                                <p style="margin-top: 5px; font-size: 0.9em; color: var(--text-secondary);">${style.challengingEnvironment}</p>
                            </div>
                        </div>
                        
                        <div class="char-grid">
                            <div class="char-box strengths">
                                <h5>‚úì Your Learning Strengths</h5>
                                <ul>${style.strengths.map(s => `<li>${s}</li>`).join('')}</ul>
                            </div>
                            <div class="char-box strategies">
                                <h5>‚Üí Strategies That Work for You</h5>
                                <ul>${style.strategies.map(s => `<li>${s}</li>`).join('')}</ul>
                            </div>
                        </div>
                        <div style="margin-top: 20px; padding: 18px; background: var(--blue-light); border-radius: 12px;">
                            <h5 style="color: var(--chapman-blue); margin-bottom: 8px;">üíº Career Fit</h5>
                            <p style="color: var(--text-secondary); font-size: 0.95em;">${style.careers}</p>
                        </div>
                    </div>

                    <!-- SWOT Preview Section -->
                    <div style="background: linear-gradient(135deg, var(--blue-light) 0%, #f0f4fa 100%); border-radius: 14px; padding: 25px; margin: 20px 0; border: 2px solid var(--chapman-blue);">
                        <h4 style="color: var(--chapman-blue); margin-bottom: 15px; font-size: 1.2em;">üìä SWOT Analysis Preview (For Assessment Tracker)</h4>
                        <p style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 15px;">This preview shows how your Learning Style will contribute to your comprehensive SWOT analysis.</p>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div style="background: #E8F5E9; padding: 15px; border-radius: 10px; border-left: 4px solid #2E7D32;">
                                <strong style="color: #2E7D32; font-size: 0.9em;">STRENGTH</strong>
                                <p style="font-size: 0.9em; margin-top: 5px; color: var(--text-secondary);">${style.swotStrength}</p>
                            </div>
                            <div style="background: #FFEBEE; padding: 15px; border-radius: 10px; border-left: 4px solid #C62828;">
                                <strong style="color: #C62828; font-size: 0.9em;">WEAKNESS</strong>
                                <p style="font-size: 0.9em; margin-top: 5px; color: var(--text-secondary);">${style.swotWeakness}</p>
                            </div>
                            <div style="background: #E3F2FD; padding: 15px; border-radius: 10px; border-left: 4px solid #1565C0;">
                                <strong style="color: #1565C0; font-size: 0.9em;">OPPORTUNITY</strong>
                                <p style="font-size: 0.9em; margin-top: 5px; color: var(--text-secondary);">${style.swotOpportunity}</p>
                            </div>
                            <div style="background: #FFF3E0; padding: 15px; border-radius: 10px; border-left: 4px solid #E65100;">
                                <strong style="color: #E65100; font-size: 0.9em;">THREAT</strong>
                                <p style="font-size: 0.9em; margin-top: 5px; color: var(--text-secondary);">${style.swotThreat}</p>
                            </div>
                        </div>
                    </div>

                    <div class="result-section">
                        <h4>üìä Your Learning Mode Profile</h4>
                        <div style="display: grid; gap: 12px; margin-top: 15px;">
                            ${[
                                { key: 'ce', name: 'Concrete Experience', icon: '‚ù§Ô∏è', color: '#E65100' },
                                { key: 'ro', name: 'Reflective Observation', icon: 'üëÅÔ∏è', color: '#00838F' },
                                { key: 'ac', name: 'Abstract Conceptualization', icon: 'üß†', color: '#1565C0' },
                                { key: 'ae', name: 'Active Experimentation', icon: 'üñêÔ∏è', color: '#2E7D32' }
                            ].map(mode => {
                                const pct = (scores[mode.key] / maxScore) * 100;
                                return `
                                    <div style="display: flex; align-items: center; gap: 12px;">
                                        <span style="width: 180px; font-weight: 600; color: var(--text-secondary); font-size: 0.85em;">${mode.icon} ${mode.name}</span>
                                        <div style="flex: 1; height: 26px; background: #e8ecf0; border-radius: 13px; overflow: hidden;">
                                            <div style="height: 100%; width: ${pct}%; background: ${mode.color}; border-radius: 13px; display: flex; align-items: center; justify-content: flex-end; padding-right: 10px; color: white; font-weight: 600; font-size: 0.8em; min-width: 35px;">${scores[mode.key]}</div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                        <div style="margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div style="padding: 15px; background: ${acCE <= 0 ? 'rgba(230, 81, 0, 0.1)' : 'rgba(21, 101, 192, 0.1)'}; border-radius: 10px; text-align: center;">
                                <div style="font-weight: 600; color: ${acCE <= 0 ? '#E65100' : '#1565C0'};">Processing: ${acCE <= 0 ? '‚ù§Ô∏è Feeling' : 'üß† Thinking'}</div>
                                <div style="font-size: 0.85em; color: var(--text-secondary);">AC - CE = ${acCE}</div>
                            </div>
                            <div style="padding: 15px; background: ${aeRO <= 0 ? 'rgba(0, 131, 143, 0.1)' : 'rgba(46, 125, 50, 0.1)'}; border-radius: 10px; text-align: center;">
                                <div style="font-weight: 600; color: ${aeRO <= 0 ? '#00838F' : '#2E7D32'};">Perception: ${aeRO <= 0 ? 'üëÅÔ∏è Watching' : 'üñêÔ∏è Doing'}</div>
                                <div style="font-size: 0.85em; color: var(--text-secondary);">AE - RO = ${aeRO}</div>
                            </div>
                        </div>
                    </div>

                    <div class="result-section gold-accent">
                        <h4>üîÑ Kolb's Learning Cycle</h4>
                        <div style="background: linear-gradient(135deg, #fffef8, #fef9e7); padding: 20px; border-radius: 12px; border-left: 4px solid var(--chapman-gold);">
                            <p style="color: var(--text-secondary); line-height: 1.8; margin-bottom: 15px;">
                                <strong>Effective learning uses all four stages:</strong>
                            </p>
                            <ol style="color: var(--text-secondary); line-height: 2; padding-left: 20px;">
                                <li><strong style="color: #E65100;">Concrete Experience (CE)</strong> ‚Äî Have an experience</li>
                                <li><strong style="color: #00838F;">Reflective Observation (RO)</strong> ‚Äî Reflect on the experience</li>
                                <li><strong style="color: #1565C0;">Abstract Conceptualization (AC)</strong> ‚Äî Form theories and concepts</li>
                                <li><strong style="color: #2E7D32;">Active Experimentation (AE)</strong> ‚Äî Test the concepts in new situations</li>
                            </ol>
                            <p style="color: var(--text-secondary); line-height: 1.8; margin-top: 15px; font-style: italic;">
                                While you prefer ${style.dominant[0]} and ${style.dominant[1]}, developing all four modes makes you a more versatile learner.
                            </p>
                        </div>
                    </div>

                    <div class="result-section">
                        <h4>üìã Comparing the Four Learning Styles</h4>
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Style</th>
                                    <th>Modes</th>
                                    <th>Learns By</th>
                                    <th>Question</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="${styleKey === 'diverging' ? 'background: rgba(198, 40, 40, 0.1);' : ''}">
                                    <td><strong style="color: var(--diverging);">üé® Diverging</strong></td>
                                    <td>Feel + Watch</td>
                                    <td>Observing, brainstorming</td>
                                    <td>"Why?"</td>
                                </tr>
                                <tr style="${styleKey === 'assimilating' ? 'background: rgba(21, 101, 192, 0.1);' : ''}">
                                    <td><strong style="color: var(--assimilating);">üìä Assimilating</strong></td>
                                    <td>Think + Watch</td>
                                    <td>Reading, lectures, models</td>
                                    <td>"What?"</td>
                                </tr>
                                <tr style="${styleKey === 'converging' ? 'background: rgba(46, 125, 50, 0.1);' : ''}">
                                    <td><strong style="color: var(--converging);">üîß Converging</strong></td>
                                    <td>Think + Do</td>
                                    <td>Problem-solving, testing</td>
                                    <td>"How?"</td>
                                </tr>
                                <tr style="${styleKey === 'accommodating' ? 'background: rgba(123, 31, 162, 0.1);' : ''}">
                                    <td><strong style="color: var(--accommodating);">üöÄ Accommodating</strong></td>
                                    <td>Feel + Do</td>
                                    <td>Hands-on, trial and error</td>
                                    <td>"What if?"</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="reflection-section">
                        <h4>ü§î Reflection Questions</h4>
                        <div class="reflection-questions">
                            <div class="reflection-question">Think of a time when learning came easily. What conditions were present? How does this relate to your style?</div>
                            <div class="reflection-question">Recall a learning situation that was frustrating. Was it misaligned with your preferred style?</div>
                            <div class="reflection-question">How might you adapt your approach when faced with learning situations that don't match your style?</div>
                            <div class="reflection-question">Which of the four learning modes do you use least? How could you develop it?</div>
                            <div class="reflection-question">How does your learning style affect how you prefer to receive feedback?</div>
                            <div class="reflection-question">As a future manager, how will you accommodate different learning styles on your team?</div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('assessment-section').classList.add('hidden');
            resultsDiv.style.display = 'block';
            document.getElementById('downloadSection').classList.remove('hidden');
            resultsDiv.scrollIntoView({ behavior: 'smooth' });

            window.learningResults = { scores, styleKey, style, acCE, aeRO };
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const { scores, styleKey, style, acCE, aeRO } = window.learningResults;
            const maxScore = 48;

            // Colors
            const chapmanBlue = [0, 32, 91];
            const chapmanGold = [196, 160, 0];
            const textDark = [26, 26, 46];
            const textMuted = [100, 100, 110];
            const greenColor = [46, 125, 50];
            const redColor = [198, 40, 40];
            const blueColor = [21, 101, 192];
            const orangeColor = [230, 81, 0];
            const purpleColor = [123, 31, 162];
            const tealColor = [0, 131, 143];

            // Style colors
            const styleColors = {
                diverging: redColor,
                assimilating: blueColor,
                converging: greenColor,
                accommodating: purpleColor
            };

            // Calculate tracker metrics
            const totalScore = scores.ce + scores.ro + scores.ac + scores.ae;
            const dominantMode = Object.entries(scores).sort((a, b) => b[1] - a[1])[0][0].toUpperCase();
            const processing = acCE <= 0 ? 'Feeling' : 'Thinking';
            const perception = aeRO <= 0 ? 'Watching' : 'Doing';
            const styleAbbrev = { diverging: 'Dv', assimilating: 'As', converging: 'Cv', accommodating: 'Ac' };
            const clarity = Math.abs(acCE) + Math.abs(aeRO);
            const clarityLevel = clarity >= 20 ? 'Strong' : clarity >= 10 ? 'Moderate' : 'Balanced';
            const trackerCode = 'LSA-' + styleAbbrev[styleKey] + '-' + clarityLevel.charAt(0);

            // Helper function
            function addWrappedText(text, x, startY, maxWidth, lineHeight) {
                const lines = doc.splitTextToSize(text, maxWidth);
                let currentY = startY;
                lines.forEach(function(line) {
                    if (currentY > 275) { doc.addPage(); currentY = 20; }
                    doc.text(line, x, currentY);
                    currentY += lineHeight;
                });
                return currentY;
            }

            // ===== PAGE 1: Header and Learning Style Overview =====
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.rect(0, 0, 210, 42, 'F');
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('CHAPMAN UNIVERSITY', 105, 12, { align: 'center' });
            doc.setFontSize(9);
            doc.setTextColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.text('Argyros College of Business and Economics', 105, 18, { align: 'center' });
            doc.setFontSize(16);
            doc.setTextColor(255, 255, 255);
            doc.text('Learning Style Assessment', 105, 28, { align: 'center' });
            doc.setFontSize(9);
            doc.text("Based on Kolb's Experiential Learning Theory", 105, 36, { align: 'center' });
            doc.setFillColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.rect(0, 42, 210, 2, 'F');

            let y = 52;

            // Student Info
            doc.setFontSize(10);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text('Student: ' + studentName, 20, y);
            doc.text('Date: ' + new Date(surveyDate).toLocaleDateString(), 140, y);
            y += 10;

            // Primary Style Banner
            const sColor = styleColors[styleKey];
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 18, 2, 2, 'F');
            doc.setFontSize(14);
            doc.setTextColor(255, 255, 255);
            doc.text('LEARNING STYLE: ' + style.name.toUpperCase(), 105, y + 12, { align: 'center' });
            y += 24;

            doc.setFontSize(10);
            doc.setTextColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.text(style.subtitle, 105, y, { align: 'center' });
            y += 6;
            doc.setFontSize(9);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            doc.text('Dominant Modes: ' + style.dominant.join(' + '), 105, y, { align: 'center' });
            y += 10;

            // Score Distribution Box
            doc.setFillColor(245, 247, 250);
            doc.roundedRect(20, y, 170, 32, 2, 2, 'F');
            doc.setFontSize(9);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('LEARNING MODE SCORES', 25, y + 7);
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text('CE (Concrete Experience): ' + scores.ce + '/48', 25, y + 15);
            doc.text('RO (Reflective Observation): ' + scores.ro + '/48', 105, y + 15);
            doc.text('AC (Abstract Conceptualization): ' + scores.ac + '/48', 25, y + 23);
            doc.text('AE (Active Experimentation): ' + scores.ae + '/48', 105, y + 23);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            doc.text('AC-CE: ' + acCE + ' (' + processing + ')', 25, y + 29);
            doc.text('AE-RO: ' + aeRO + ' (' + perception + ')', 105, y + 29);
            y += 38;

            // Tracker Code Box
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 10, 2, 2, 'F');
            doc.setFontSize(8);
            doc.setTextColor(255, 255, 255);
            doc.text('Tracker: ' + trackerCode + '  |  Raw: CE' + scores.ce + '-RO' + scores.ro + '-AC' + scores.ac + '-AE' + scores.ae + '  |  Clarity: ' + clarityLevel, 105, y + 7, { align: 'center' });
            y += 16;

            // Profile Summary
            doc.setFontSize(10);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('YOUR LEARNING PROFILE', 20, y);
            y += 6;
            doc.setFontSize(9);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            y = addWrappedText(style.profileSummary, 20, y, 170, 4.5);
            y += 4;

            // How You Learn
            doc.setFontSize(10);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('How You Learn', 20, y);
            y += 5;
            doc.setFontSize(9);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            y = addWrappedText(style.howYouLearn, 20, y, 170, 4.5);
            y += 4;

            // Best Environment
            doc.setFontSize(10);
            doc.setTextColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.text('Best Learning Environment', 20, y);
            y += 5;
            doc.setFontSize(9);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            y = addWrappedText(style.bestEnvironment, 20, y, 170, 4.5);
            y += 4;

            // Challenging Environment
            doc.setFontSize(10);
            doc.setTextColor(redColor[0], redColor[1], redColor[2]);
            doc.text('Challenging Environment', 20, y);
            y += 5;
            doc.setFontSize(9);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            y = addWrappedText(style.challengingEnvironment, 20, y, 170, 4.5);
            y += 6;

            // Strengths
            doc.setFontSize(10);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('Learning Strengths', 20, y);
            y += 5;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            style.strengths.forEach(function(s) {
                if (y > 275) { doc.addPage(); y = 20; }
                doc.text('- ' + s, 25, y);
                y += 4;
            });
            y += 4;

            // Strategies
            doc.setFontSize(10);
            doc.setTextColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.text('Strategies That Work For You', 20, y);
            y += 5;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            style.strategies.forEach(function(s) {
                if (y > 275) { doc.addPage(); y = 20; }
                doc.text('-> ' + s, 25, y);
                y += 4;
            });

            // ===== PAGE 2: SWOT, Cycle, and Comparison =====
            doc.addPage();
            y = 20;

            // SWOT Header
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 10, 2, 2, 'F');
            doc.setFontSize(11);
            doc.setTextColor(255, 255, 255);
            doc.text('SWOT ANALYSIS - ' + style.name + ' Learning Style', 105, y + 7, { align: 'center' });
            y += 18;

            // SWOT Grid
            const boxW = 82;
            const boxH = 28;

            // Strength Box
            doc.setFillColor(232, 245, 233);
            doc.roundedRect(20, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.setLineWidth(0.5);
            doc.line(20, y, 20, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.text('STRENGTH', 25, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            const sLines = doc.splitTextToSize(style.swotStrength, boxW - 10);
            sLines.forEach(function(line, i) { if (i < 4) doc.text(line, 25, y + 12 + (i * 4)); });

            // Weakness Box
            doc.setFillColor(255, 235, 238);
            doc.roundedRect(108, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(redColor[0], redColor[1], redColor[2]);
            doc.line(108, y, 108, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(redColor[0], redColor[1], redColor[2]);
            doc.text('WEAKNESS', 113, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            const wLines = doc.splitTextToSize(style.swotWeakness, boxW - 10);
            wLines.forEach(function(line, i) { if (i < 4) doc.text(line, 113, y + 12 + (i * 4)); });

            y += boxH + 5;

            // Opportunity Box
            doc.setFillColor(227, 242, 253);
            doc.roundedRect(20, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.line(20, y, 20, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.text('OPPORTUNITY', 25, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            const oLines = doc.splitTextToSize(style.swotOpportunity, boxW - 10);
            oLines.forEach(function(line, i) { if (i < 4) doc.text(line, 25, y + 12 + (i * 4)); });

            // Threat Box
            doc.setFillColor(255, 243, 224);
            doc.roundedRect(108, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.line(108, y, 108, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.text('THREAT', 113, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            const tLines = doc.splitTextToSize(style.swotThreat, boxW - 10);
            tLines.forEach(function(line, i) { if (i < 4) doc.text(line, 113, y + 12 + (i * 4)); });

            y += boxH + 12;

            // Kolb's Learning Cycle
            doc.setFontSize(11);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text("KOLB'S LEARNING CYCLE", 20, y);
            y += 7;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text('Effective learning uses all four stages in sequence:', 20, y);
            y += 6;

            const cycleSteps = [
                { num: '1', name: 'Concrete Experience (CE)', desc: 'Have an experience', color: orangeColor },
                { num: '2', name: 'Reflective Observation (RO)', desc: 'Reflect on the experience', color: tealColor },
                { num: '3', name: 'Abstract Conceptualization (AC)', desc: 'Form theories and concepts', color: blueColor },
                { num: '4', name: 'Active Experimentation (AE)', desc: 'Test concepts in new situations', color: greenColor }
            ];

            cycleSteps.forEach(function(step) {
                doc.setTextColor(step.color[0], step.color[1], step.color[2]);
                doc.text(step.num + '. ' + step.name, 25, y);
                doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
                doc.text(' - ' + step.desc, 85, y);
                y += 5;
            });
            y += 8;

            // Four Learning Styles Comparison
            doc.setFontSize(11);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('COMPARING THE FOUR LEARNING STYLES', 20, y);
            y += 8;

            const styleComp = [
                { name: 'Diverging', modes: 'Feel + Watch', learns: 'Observing, brainstorming', q: 'Why?', color: redColor },
                { name: 'Assimilating', modes: 'Think + Watch', learns: 'Reading, lectures, models', q: 'What?', color: blueColor },
                { name: 'Converging', modes: 'Think + Do', learns: 'Problem-solving, testing', q: 'How?', color: greenColor },
                { name: 'Accommodating', modes: 'Feel + Do', learns: 'Hands-on, trial & error', q: 'What if?', color: purpleColor }
            ];

            // Table header
            doc.setFontSize(7);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('Style', 25, y);
            doc.text('Modes', 55, y);
            doc.text('Learns By', 90, y);
            doc.text('Question', 150, y);
            y += 5;

            doc.setFontSize(7);
            styleComp.forEach(function(s) {
                const isYourStyle = s.name.toLowerCase() === styleKey;
                if (isYourStyle) {
                    doc.setFillColor(245, 247, 250);
                    doc.rect(20, y - 3, 170, 7, 'F');
                }
                doc.setTextColor(s.color[0], s.color[1], s.color[2]);
                doc.text(s.name + (isYourStyle ? ' (You)' : ''), 25, y);
                doc.setTextColor(textDark[0], textDark[1], textDark[2]);
                doc.text(s.modes, 55, y);
                doc.text(s.learns, 90, y);
                doc.text('"' + s.q + '"', 150, y);
                y += 7;
            });
            y += 8;

            // Career Fit
            doc.setFontSize(10);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('Career Fit', 20, y);
            y += 5;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text(style.careers, 25, y);
            y += 10;

            // Reflection Questions
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 10, 2, 2, 'F');
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('REFLECTION QUESTIONS', 105, y + 7, { align: 'center' });
            y += 16;

            const reflectionQs = [
                'Think of a time when learning came easily. What conditions were present? How does this relate to your style?',
                'Recall a learning situation that was frustrating. Was it misaligned with your preferred style?',
                'Which of the four learning modes do you use least? How could you develop it?',
                'How does your learning style affect how you prefer to receive feedback?',
                'As a future manager, how will you accommodate different learning styles on your team?'
            ];
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            reflectionQs.forEach(function(q, i) {
                if (y > 275) { doc.addPage(); y = 20; }
                const qLines = doc.splitTextToSize((i + 1) + '. ' + q, 165);
                qLines.forEach(function(line) { doc.text(line, 25, y); y += 4; });
                y += 2;
            });

            // Footer on all pages
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
                doc.text('Page ' + i + ' of ' + pageCount, 105, 287, { align: 'center' });
                doc.text('Chapman University - Argyros College of Business and Economics - MGMT 316', 105, 292, { align: 'center' });
            }

            doc.save('Learning_Style_Assessment_' + studentName.replace(/\s+/g, '_') + '_' + new Date().toISOString().split('T')[0] + '.pdf');
        }

        function restartAssessment() {
            responses = {};
            document.getElementById('studentName').value = '';
            document.getElementById('testDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('results').style.display = 'none';
            document.getElementById('assessment-section').classList.add('hidden');
            document.getElementById('downloadSection').classList.add('hidden');
            document.getElementById('intro-section').classList.remove('hidden');
            document.getElementById('progressFill').style.width = '0%';
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
