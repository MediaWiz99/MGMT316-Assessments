<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MGMT 316 Assessment Tracker | Chapman University</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --chapman-blue: #00205B;
            --chapman-gold: #C4A000;
            --gold-light: #F5E6A3;
            --blue-light: #E8EDF5;
            --blue-medium: #1A3A7A;
            --text-primary: #1a1a2e;
            --text-secondary: #4a4a5a;
            --white: #ffffff;
            --green: #2E7D32;
            --red: #C62828;
            --orange: #E65100;
            --purple: #7B1FA2;
            --inactive: #9e9e9e;
            --inactive-bg: #f5f5f5;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; line-height: 1.6; color: var(--text-primary); background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); min-height: 100vh; }
        
        .header {
            background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium));
            color: var(--white);
            padding: 30px;
            text-align: center;
            position: relative;
        }
        .header::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, var(--chapman-gold), var(--gold-light), var(--chapman-gold)); }
        .institution { font-size: 0.9em; letter-spacing: 2px; text-transform: uppercase; opacity: 0.9; }
        .college { font-size: 1em; color: var(--chapman-gold); margin: 5px 0 15px; font-weight: 600; }
        h1 { font-size: 2.2em; font-weight: 700; margin-bottom: 8px; }
        .subtitle { font-size: 1.05em; color: var(--gold-light); }
        
        .student-info-bar {
            background: var(--white);
            padding: 20px 30px;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--blue-light);
        }
        .student-info-bar input {
            padding: 10px 15px;
            border: 2px solid var(--blue-light);
            border-radius: 8px;
            font-size: 1em;
            flex: 1;
            min-width: 200px;
        }
        .student-info-bar input:focus { outline: none; border-color: var(--chapman-blue); }
        
        .progress-summary {
            background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium));
            padding: 20px 30px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 15px;
        }
        .progress-stat {
            text-align: center;
            color: var(--white);
        }
        .progress-stat .number { font-size: 2em; font-weight: 700; color: var(--chapman-gold); }
        .progress-stat .label { font-size: 0.85em; opacity: 0.9; }
        
        .main-content { max-width: 1400px; margin: 0 auto; padding: 25px; }
        
        .section-card {
            background: var(--white);
            border-radius: 16px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .section-header {
            background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium));
            color: var(--white);
            padding: 18px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
        }
        .section-header h2 { font-size: 1.2em; flex: 1; }
        .section-header .toggle { font-size: 1.3em; transition: transform 0.3s; }
        .section-header .badge {
            background: var(--chapman-gold);
            color: var(--chapman-blue);
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
        }
        .section-content { padding: 0; max-height: 0; overflow: hidden; transition: all 0.4s ease; }
        .section-content.open { padding: 25px; max-height: 5000px; }
        .section-card.open .toggle { transform: rotate(180deg); }
        
        .assessments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 15px;
        }
        
        .assessment-entry {
            background: var(--blue-light);
            border-radius: 12px;
            padding: 18px;
            border-left: 4px solid var(--chapman-blue);
            transition: all 0.3s;
        }
        .assessment-entry:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .assessment-entry.completed { border-left-color: var(--green); background: linear-gradient(135deg, #e8f5e9, var(--blue-light)); }
        .assessment-entry.inactive {
            border-left-color: var(--inactive);
            background: var(--inactive-bg);
            opacity: 0.6;
        }
        .assessment-entry.inactive * { color: var(--inactive) !important; }
        
        .assessment-entry h4 { color: var(--chapman-blue); margin-bottom: 6px; font-size: 0.95em; display: flex; align-items: center; gap: 8px; }
        .assessment-entry h4 .status { font-size: 1.1em; }
        .assessment-entry .framework { font-size: 0.75em; color: var(--text-secondary); margin-bottom: 10px; }
        .assessment-entry .tracker-input {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .assessment-entry input {
            flex: 1;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 0.9em;
            font-family: 'Courier New', monospace;
            text-transform: uppercase;
        }
        .assessment-entry input:focus { outline: none; border-color: var(--chapman-blue); }
        .assessment-entry input.valid { border-color: var(--green); background: #f1f8e9; }
        .assessment-entry input.invalid { border-color: var(--red); background: #ffebee; }
        .assessment-entry .parsed-result {
            margin-top: 10px;
            padding: 10px;
            background: var(--white);
            border-radius: 8px;
            font-size: 0.8em;
        }
        .assessment-entry .parsed-result .primary { color: var(--chapman-blue); font-weight: 600; }
        .assessment-entry .parsed-result .score { color: var(--green); }
        
        .inactive-label {
            display: inline-block;
            background: var(--inactive);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            margin-left: 8px;
        }
        
        /* Analysis Section */
        .analysis-container { padding: 25px; }
        
        .profile-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .profile-card {
            background: var(--blue-light);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid var(--chapman-blue);
        }
        .profile-card h4 { color: var(--chapman-blue); margin-bottom: 12px; font-size: 1em; }
        .profile-card .trait { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid rgba(0,0,0,0.05); font-size: 0.9em; }
        .profile-card .trait:last-child { border-bottom: none; }
        .profile-card .trait .value { font-weight: 600; color: var(--chapman-blue); }
        
        .swot-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 25px 0;
        }
        .swot-box {
            padding: 20px;
            border-radius: 12px;
            min-height: 150px;
        }
        .swot-box h4 { margin-bottom: 12px; font-size: 1em; }
        .swot-box ul { margin-left: 20px; font-size: 0.9em; }
        .swot-box li { margin-bottom: 6px; }
        .swot-strength { background: #e8f5e9; border-left: 4px solid var(--green); }
        .swot-strength h4 { color: var(--green); }
        .swot-weakness { background: #ffebee; border-left: 4px solid var(--red); }
        .swot-weakness h4 { color: var(--red); }
        .swot-opportunity { background: #e3f2fd; border-left: 4px solid #1565C0; }
        .swot-opportunity h4 { color: #1565C0; }
        .swot-threat { background: #fff3e0; border-left: 4px solid var(--orange); }
        .swot-threat h4 { color: var(--orange); }
        
        .insights-section {
            background: linear-gradient(135deg, #fffef8, #fef9e7);
            border: 2px solid var(--chapman-gold);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
        }
        .insights-section h3 { color: var(--chapman-blue); margin-bottom: 15px; }
        .insight-item {
            padding: 15px;
            background: var(--white);
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 3px solid var(--chapman-gold);
        }
        .insight-item h5 { color: var(--chapman-blue); margin-bottom: 6px; }
        .insight-item p { font-size: 0.9em; color: var(--text-secondary); }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary { background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); color: var(--white); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,32,91,0.3); }
        .btn-secondary { background: linear-gradient(135deg, var(--chapman-gold), #d4b000); color: var(--chapman-blue); }
        .btn-outline { background: transparent; border: 2px solid var(--chapman-blue); color: var(--chapman-blue); }
        
        .no-data-message {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }
        .no-data-message .icon { font-size: 3em; margin-bottom: 15px; opacity: 0.5; }
        
        .footer {
            text-align: center;
            padding: 25px;
            color: var(--white);
            opacity: 0.9;
            font-size: 0.9em;
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 1.6em; }
            .swot-grid { grid-template-columns: 1fr; }
            .student-info-bar { flex-direction: column; }
            .student-info-bar input { width: 100%; }
        }
        
        @media print {
            .header, .section-header { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .btn { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="institution">Chapman University</div>
        <div class="college">Argyros College of Business and Economics</div>
        <h1>üìä MGMT 316 Assessment Tracker</h1>
        <div class="subtitle">Personal Self-Awareness & Leadership Development Portfolio</div>
    </div>
    
    <div class="student-info-bar">
        <input type="text" id="studentName" placeholder="Your Full Name" onchange="saveProgress()">
        <input type="date" id="trackingDate" onchange="saveProgress()">
        <button class="btn btn-primary" onclick="generateComprehensiveReport()">üìÑ Generate Full Report</button>
        <button class="btn btn-outline" onclick="clearAllData()">üîÑ Reset All</button>
    </div>
    
    <div class="progress-summary">
        <div class="progress-stat">
            <div class="number" id="completedCount">0</div>
            <div class="label">Completed</div>
        </div>
        <div class="progress-stat">
            <div class="number" id="totalActive">22</div>
            <div class="label">Total Active</div>
        </div>
        <div class="progress-stat">
            <div class="number" id="progressPct">0%</div>
            <div class="label">Progress</div>
        </div>
        <div class="progress-stat">
            <div class="number" id="overallStrength">--</div>
            <div class="label">Top Strength</div>
        </div>
    </div>
    
    <div class="main-content">
        <!-- Active Assessments Section -->
        <div class="section-card open" id="active-section">
            <div class="section-header" onclick="toggleSection('active-section')">
                <span>‚úÖ</span>
                <h2>MGMT 316 Course Assessments</h2>
                <span class="badge">22 Active</span>
                <span class="toggle">‚ñº</span>
            </div>
            <div class="section-content open">
                <div class="assessments-grid" id="activeAssessments">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Analysis Section -->
        <div class="section-card" id="analysis-section">
            <div class="section-header" onclick="toggleSection('analysis-section')">
                <span>üìà</span>
                <h2>Combined Analysis & Insights</h2>
                <span class="badge" id="analysisBadge">Enter codes above</span>
                <span class="toggle">‚ñº</span>
            </div>
            <div class="section-content" id="analysisContent">
                <div class="no-data-message" id="noDataMsg">
                    <div class="icon">üìù</div>
                    <h3>Enter Your Assessment Tracker Codes</h3>
                    <p>As you complete assessments, enter your tracker codes above.<br>Your comprehensive profile analysis will appear here.</p>
                </div>
                <div id="analysisResults" style="display: none;">
                    <!-- Will be populated when codes are entered -->
                </div>
            </div>
        </div>
        
        <!-- Inactive Assessments Section -->
        <div class="section-card" id="inactive-section">
            <div class="section-header" onclick="toggleSection('inactive-section')">
                <span>üìã</span>
                <h2>Other Available Assessments</h2>
                <span class="badge" style="background: var(--inactive); color: white;">Not in Course</span>
                <span class="toggle">‚ñº</span>
            </div>
            <div class="section-content">
                <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.9em;">These assessments are available in the full Management Assessment Hub but are not required for MGMT 316.</p>
                <div class="assessments-grid" id="inactiveAssessments">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>MGMT 316 Assessment Tracker ‚Ä¢ Chapman University ‚Ä¢ Argyros College of Business and Economics</p>
        <p style="margin-top: 5px;">¬© 2025 Professor Chip Monaco</p>
    </div>

    <script>
        // Active assessments for MGMT 316 with their tracker code patterns
        const activeAssessments = [
            { id: 'leadership', name: 'Leadership Style', icon: 'üëë', framework: 'Situational Leadership (Hersey & Blanchard)', code: 'LSA', dimensions: ['Directing', 'Coaching', 'Supporting', 'Delegating'], parser: parseLSA },
            { id: 'communication', name: 'Communication Style', icon: 'üí¨', framework: 'Communication Theory', code: 'CSA', dimensions: ['Analytical', 'Intuitive', 'Functional', 'Personal'], parser: parseCSA },
            { id: 'conflict', name: 'Conflict Management', icon: '‚öîÔ∏è', framework: 'Thomas-Kilmann TKI', code: 'CMA', dimensions: ['Competing', 'Collaborating', 'Compromising', 'Avoiding', 'Accommodating'], parser: parseCMA },
            { id: 'eq', name: 'Emotional Intelligence', icon: '‚ù§Ô∏è', framework: "Goleman's EQ Model", code: 'EIA', dimensions: ['Self-Awareness', 'Self-Regulation', 'Motivation', 'Empathy', 'Social Skills'], parser: parseEIA },
            { id: 'decision', name: 'Decision-Making Style', icon: 'üé≤', framework: 'Rowe & Boulgarides', code: 'DMS', dimensions: ['Directive', 'Analytical', 'Conceptual', 'Behavioral'], parser: parseDMS },
            { id: 'motivation', name: 'Motivation Style', icon: 'üî•', framework: "McClelland's Acquired Needs", code: 'MSA', dimensions: ['Achievement', 'Affiliation', 'Power'], parser: parseMSA },
            { id: 'stress', name: 'Stress Management', icon: 'üßò', framework: "Lazarus & Folkman's Coping", code: 'SMS', dimensions: ['Problem-Focused', 'Emotion-Focused', 'Support-Seeking', 'Avoidant'], parser: parseSMS },
            { id: 'change', name: 'Change Readiness', icon: 'üîÑ', framework: "Rogers' Diffusion of Innovations", code: 'CRA', dimensions: ['Cognitive', 'Emotional', 'Proactive', 'Learning'], parser: parseCRA },
            { id: 'influence', name: 'Influence Style', icon: 'üé≠', framework: "Cohen & Bradford's Influence", code: 'ISA', dimensions: ['Rationalizing', 'Asserting', 'Negotiating', 'Inspiring', 'Bridging'], parser: parseISA },
            { id: 'learning', name: 'Learning Style', icon: 'üìö', framework: "Kolb's Learning Cycle", code: 'LRN', dimensions: ['Diverging', 'Assimilating', 'Converging', 'Accommodating'], parser: parseLRN },
            { id: 'grit', name: 'Grit Assessment', icon: 'üí™', framework: "Duckworth's Grit Scale", code: 'GRT', dimensions: ['Passion', 'Perseverance'], parser: parseGRT },
            { id: 'psych_safety', name: 'Psychological Safety', icon: 'üõ°Ô∏è', framework: "Edmondson's Research", code: 'PSA', dimensions: ['Speaking Up', 'Risk Taking', 'Inclusion', 'Learning'], parser: parsePSA },
            { id: 'systems', name: 'Systems Thinking', icon: 'üîÑ', framework: "Senge's Fifth Discipline", code: 'SYS', dimensions: ['Holistic', 'Interconnections', 'Dynamics', 'Leverage'], parser: parseSYS },
            { id: 'strategic', name: 'Strategic Thinking', icon: '‚ôüÔ∏è', framework: 'Strategic Management', code: 'STA', dimensions: ['Vision', 'Analysis', 'Agility', 'Execution'], parser: parseSTA },
            { id: 'critical', name: 'Critical Thinking', icon: 'üß†', framework: 'Paul & Elder Framework', code: 'CTA', dimensions: ['Analysis', 'Evaluation', 'Inference', 'Open-Mindedness'], parser: parseCTA },
            { id: 'entrepreneurial', name: 'Entrepreneurial Orientation', icon: 'üöÄ', framework: 'Lumpkin & Dess EO', code: 'EOA', dimensions: ['Innovativeness', 'Proactiveness', 'Risk-Taking', 'Autonomy', 'Competitive'], parser: parseEOA },
            { id: 'risk', name: 'Risk Tolerance', icon: 'üé≤', framework: 'DOSPERT Framework', code: 'RTA', dimensions: ['Financial', 'Career', 'Social', 'Physical'], parser: parseRTA },
            { id: 'innovation', name: 'Innovation Mindset', icon: 'üí°', framework: 'Design Thinking + Lean', code: 'IMA', dimensions: ['Curiosity', 'Experimentation', 'Resilience', 'Collaboration'], parser: parseIMA },
            // NEW: Added 4 assessments
            { id: 'personality', name: 'Management Personality', icon: 'üß†', framework: 'Management Style Quadrants', code: 'MPA', dimensions: ['Director', 'Innovator', 'Visionary', 'Developer'], parser: parseMPA },
            { id: 'values', name: 'Values Discovery', icon: 'üíé', framework: 'Personal Values Framework', code: 'VDA', dimensions: ['Achievement', 'Relationship', 'Growth', 'Service', 'Integrity'], parser: parseVDA },
            { id: 'ethics', name: 'Business Ethics', icon: '‚öñÔ∏è', framework: 'Ethical Frameworks', code: 'BEA', dimensions: ['Consequentialist', 'Deontologist', 'Virtue', 'Care'], parser: parseBEA },
            { id: 'teamplayer', name: 'Team Player Style', icon: 'ü§ù', framework: 'Parker Team Roles', code: 'TPA', dimensions: ['Contributor', 'Collaborator', 'Communicator', 'Challenger'], parser: parseTPA }
        ];
        
        // Inactive assessments (greyed out)
        const inactiveAssessments = [
            { name: 'DISC Behavioral Style', icon: 'üéØ', framework: 'Marston DISC Model' },
            { name: 'Growth Mindset', icon: 'üå±', framework: "Dweck's Research" },
            { name: 'Time Management', icon: '‚è∞', framework: 'Macan TMB Scale' },
            { name: 'Cultural Intelligence', icon: 'üåç', framework: 'Ang & Van Dyne CQ' },
            { name: 'Negotiation Style', icon: 'ü§ù', framework: 'Lewicki Negotiation' },
            { name: 'Career Anchors', icon: '‚öì', framework: 'Edgar Schein Model' },
            { name: 'Political Skill', icon: 'üéØ', framework: 'Ferris PSI' },
            { name: 'Creativity Style', icon: 'üí°', framework: 'Kirton Adaption-Innovation' },
            { name: 'Psychological Capital', icon: 'ü¶∏', framework: 'Luthans HERO Model' },
            { name: 'Self-Efficacy', icon: 'üéØ', framework: 'Bandura Theory' },
            { name: 'Authentic Leadership', icon: 'üåü', framework: 'Walumbwa ALQ' },
            { name: 'Servant Leadership', icon: 'üôè', framework: 'Greenleaf Model' },
            { name: 'Mindfulness', icon: 'üßò', framework: 'FFMQ Five Facet' },
            { name: 'Trust Assessment', icon: 'ü§ù', framework: 'Mayer-Davis-Schoorman' },
            { name: 'Organizational Commitment', icon: 'üè¢', framework: 'Meyer & Allen Model' }
        ];
        
        // Store parsed results
        let parsedResults = {};
        
        // Parser functions for each assessment type
        function parseLSA(code) {
            // LSA-{Primary}{Secondary}-{Level}{Score} e.g., LSA-CoDe-H85
            const match = code.match(/LSA-([A-Z][a-z])([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const styles = { Di: 'Directing', Co: 'Coaching', Su: 'Supporting', De: 'Delegating' };
            const levels = { H: 'High Versatility', M: 'Moderate Versatility', D: 'Developing' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], level: levels[match[3]] || match[3], score: parseInt(match[4]) };
        }
        
        function parseCSA(code) {
            // CSA-{Primary}{Secondary}-{Score} e.g., CSA-AnIn-78
            const match = code.match(/CSA-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const styles = { An: 'Analytical', In: 'Intuitive', Fu: 'Functional', Pe: 'Personal' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseCMA(code) {
            // CMA-{Primary}{Secondary}-{Score} e.g., CMA-ClCo-42
            const match = code.match(/CMA-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const styles = { Cm: 'Competing', Cl: 'Collaborating', Co: 'Compromising', Av: 'Avoiding', Ac: 'Accommodating' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseEIA(code) {
            // EIA-{HighestDim}-{Level}{Score} e.g., EIA-Em-H198
            const match = code.match(/EIA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { SA: 'Self-Awareness', SR: 'Self-Regulation', Mo: 'Motivation', Em: 'Empathy', SS: 'Social Skills' };
            const levels = { E: 'Exceptional', H: 'High', M: 'Moderate', D: 'Developing', B: 'Building' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseDMS(code) {
            // DMS-{Primary}{Secondary}-{Score} e.g., DMS-DiAn-65
            const match = code.match(/DMS-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const styles = { Di: 'Directive', An: 'Analytical', Co: 'Conceptual', Be: 'Behavioral' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseMSA(code) {
            // MSA-{Primary}{Secondary}-{Score} e.g., MSA-AcPo-48
            const match = code.match(/MSA-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const needs = { Ac: 'Achievement', Af: 'Affiliation', Po: 'Power' };
            return { primary: needs[match[1]] || match[1], secondary: needs[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseSMS(code) {
            // SMS-{Primary}{Secondary}-{ApproachPct} e.g., SMS-PFSS-78
            const match = code.match(/SMS-([A-Z]{2})([A-Z]{2})-(\d+)/i);
            if (!match) return null;
            const styles = { PF: 'Problem-Focused', EF: 'Emotion-Focused', SS: 'Support-Seeking', Av: 'Avoidant' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]), metric: 'Approach %' };
        }
        
        function parseCRA(code) {
            // CRA-{HighestDim}-{Profile}{Score} e.g., CRA-Pr-Ch175
            const match = code.match(/CRA-([A-Z][a-z])-([A-Z][a-z])(\d+)/i);
            if (!match) return null;
            const dims = { Co: 'Cognitive', Em: 'Emotional', Pr: 'Proactive', Le: 'Learning' };
            const profiles = { Ch: 'Change Champion', Re: 'Change Ready', Ca: 'Change Capable', Rs: 'Change Resistant' };
            return { primary: dims[match[1]] || match[1], level: profiles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseISA(code) {
            // ISA-{Primary}{Secondary}-{Score} e.g., ISA-RaNe-35
            const match = code.match(/ISA-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const styles = { Ra: 'Rationalizing', As: 'Asserting', Ne: 'Negotiating', In: 'Inspiring', Br: 'Bridging' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseLRN(code) {
            // LRN-{Primary}{Secondary}-{Score} e.g., LRN-AsDi-88
            const match = code.match(/LRN-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const styles = { Di: 'Diverging', As: 'Assimilating', Co: 'Converging', Ac: 'Accommodating' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseGRT(code) {
            // GRT-{Dim}-{Level}{Score} e.g., GRT-Pa-V45
            const match = code.match(/GRT-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Pa: 'Passion', Pe: 'Perseverance' };
            const levels = { E: 'Extremely Gritty', V: 'Very Gritty', G: 'Gritty', M: 'Moderately Gritty', S: 'Somewhat Gritty', B: 'Building Grit' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseFloat(match[3]) / 10 };
        }
        
        function parsePSA(code) {
            // PSA-{Level}{Score} e.g., PSA-H85
            const match = code.match(/PSA-([A-Z])(\d+)/i);
            if (!match) return null;
            const levels = { H: 'High Safety', M: 'Moderate Safety', L: 'Low Safety' };
            return { level: levels[match[1]] || match[1], score: parseInt(match[2]) };
        }
        
        function parseSYS(code) {
            // SYS-{HighestDim}-{Level}{Score} e.g., SYS-Ho-H78
            const match = code.match(/SYS-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Ho: 'Holistic', In: 'Interconnections', Dy: 'Dynamics', Le: 'Leverage' };
            const levels = { H: 'High', M: 'Moderate', D: 'Developing', E: 'Emerging' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseSTA(code) {
            // STA-{HighestDim}-{Level}{Score} e.g., STA-Vi-L85
            const match = code.match(/STA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Vi: 'Vision', An: 'Analysis', Ag: 'Agility', Ex: 'Execution' };
            const levels = { L: 'Strategic Leader', T: 'Strategic Thinker', D: 'Developing Strategist', C: 'Tactical Thinker' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseCTA(code) {
            // CTA-{HighestDim}-{Level}{Score} e.g., CTA-An-M75
            const match = code.match(/CTA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { An: 'Analysis', Ev: 'Evaluation', In: 'Inference', Op: 'Open-Mindedness' };
            const levels = { M: 'Master', S: 'Strong', D: 'Developing', E: 'Emerging' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseEOA(code) {
            // EOA-{HighestDim}-{Level}{Score} e.g., EOA-In-H112
            const match = code.match(/EOA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { In: 'Innovativeness', Pr: 'Proactiveness', Ri: 'Risk-Taking', Au: 'Autonomy', Co: 'Competitive' };
            const levels = { H: 'High EO', E: 'Entrepreneurial', M: 'Moderate', L: 'Low' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseRTA(code) {
            // RTA-{HighestDim}-{Level}{Score} e.g., RTA-Ca-M65
            const match = code.match(/RTA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Fi: 'Financial', Ca: 'Career', So: 'Social', Ph: 'Physical' };
            const levels = { H: 'High Tolerance', M: 'Moderate', L: 'Low Tolerance', C: 'Cautious' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseIMA(code) {
            // IMA-{HighestDim}-{Level}{Score} e.g., IMA-Cu-H85
            const match = code.match(/IMA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Cu: 'Curiosity', Ex: 'Experimentation', Re: 'Resilience', Co: 'Collaboration' };
            const levels = { H: 'High Innovator', M: 'Moderate', D: 'Developing', E: 'Emerging' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        // NEW: Management Personality Assessment parser
        function parseMPA(code) {
            // MPA-{Primary}{Secondary}-{Intensity} e.g., MPA-DiIn-S
            const match = code.match(/MPA-([A-Z][a-z])([A-Z][a-z]|XX)-([SMB])/i);
            if (!match) return null;
            const types = { Di: 'Director', In: 'Innovator', Vi: 'Visionary', Dv: 'Developer', XX: null };
            const levels = { S: 'Strong', M: 'Moderate', B: 'Balanced' };
            return { primary: types[match[1]] || match[1], secondary: types[match[2]] || null, level: levels[match[3]] || match[3] };
        }
        
        // NEW: Values Discovery Assessment parser
        function parseVDA(code) {
            // VDA-{Top3Letters}-{Count} e.g., VDA-ACH-5
            const match = code.match(/VDA-([A-Z]{3})-(\d+)/i);
            if (!match) return null;
            const valueMap = {
                ACH: 'Achievement', SUC: 'Success', EXC: 'Excellence', FAM: 'Family', FRI: 'Friendship',
                LOV: 'Love', GRO: 'Growth', LEA: 'Learning', KNO: 'Knowledge', SER: 'Service',
                CON: 'Contribution', COM: 'Compassion', HON: 'Honesty', INT: 'Integrity', AUT: 'Authenticity',
                FRE: 'Freedom', IND: 'Independence', CRE: 'Creativity', ADV: 'Adventure', BAL: 'Balance',
                SEC: 'Security', STA: 'Stability', HEA: 'Health', WEL: 'Wellness', WIS: 'Wisdom'
            };
            return { primary: valueMap[match[1].toUpperCase()] || match[1], score: parseInt(match[2]), metric: 'values selected' };
        }
        
        // NEW: Business Ethics Assessment parser
        function parseBEA(code) {
            // BEA-{Primary}{Secondary}-{Clarity} e.g., BEA-CoDe-S
            const match = code.match(/BEA-([A-Z][a-z])([A-Z][a-z]|XX)-([SMB])/i);
            if (!match) return null;
            const types = { Co: 'Consequentialist', De: 'Deontologist', Vi: 'Virtue Ethicist', Ca: 'Care Ethicist', XX: null };
            const levels = { S: 'Strong', M: 'Moderate', B: 'Balanced' };
            return { primary: types[match[1]] || match[1], secondary: types[match[2]] || null, level: levels[match[3]] + ' Framework Clarity' };
        }
        
        // NEW: Team Player Assessment parser
        function parseTPA(code) {
            // TPA-{Primary}{Secondary}-{Clarity} e.g., TPA-CtCl-S
            const match = code.match(/TPA-([A-Z][a-z])([A-Z][a-z])-([SMB])/i);
            if (!match) return null;
            const styles = { Ct: 'Contributor', Cl: 'Collaborator', Cm: 'Communicator', Ch: 'Challenger' };
            const levels = { S: 'Strong', M: 'Moderate', B: 'Balanced' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], level: levels[match[3]] + ' Style Clarity' };
        }
        
        // Initialize the page
        function init() {
            renderActiveAssessments();
            renderInactiveAssessments();
            loadProgress();
            document.getElementById('trackingDate').value = new Date().toISOString().split('T')[0];
        }
        
        function renderActiveAssessments() {
            const container = document.getElementById('activeAssessments');
            container.innerHTML = activeAssessments.map(a => `
                <div class="assessment-entry" id="entry-${a.id}">
                    <h4>
                        <span class="status" id="status-${a.id}">‚¨ú</span>
                        ${a.icon} ${a.name}
                    </h4>
                    <div class="framework">${a.framework}</div>
                    <div class="tracker-input">
                        <input type="text" 
                               id="code-${a.id}" 
                               placeholder="${a.code}-..." 
                               onchange="validateCode('${a.id}')"
                               onkeyup="validateCode('${a.id}')">
                    </div>
                    <div class="parsed-result" id="result-${a.id}" style="display: none;"></div>
                </div>
            `).join('');
        }
        
        function renderInactiveAssessments() {
            const container = document.getElementById('inactiveAssessments');
            container.innerHTML = inactiveAssessments.map(a => `
                <div class="assessment-entry inactive">
                    <h4>${a.icon} ${a.name}<span class="inactive-label">Not in Course</span></h4>
                    <div class="framework">${a.framework}</div>
                </div>
            `).join('');
        }
        
        function validateCode(assessmentId) {
            const assessment = activeAssessments.find(a => a.id === assessmentId);
            const input = document.getElementById(`code-${assessmentId}`);
            const resultDiv = document.getElementById(`result-${assessmentId}`);
            const statusIcon = document.getElementById(`status-${assessmentId}`);
            const entryDiv = document.getElementById(`entry-${assessmentId}`);
            const code = input.value.trim().toUpperCase();
            
            if (!code) {
                input.className = '';
                resultDiv.style.display = 'none';
                statusIcon.textContent = '‚¨ú';
                entryDiv.classList.remove('completed');
                delete parsedResults[assessmentId];
                updateAnalysis();
                saveProgress();
                return;
            }
            
            // Check if code starts with correct prefix
            if (!code.startsWith(assessment.code + '-')) {
                input.className = 'invalid';
                resultDiv.style.display = 'none';
                statusIcon.textContent = '‚ùå';
                entryDiv.classList.remove('completed');
                delete parsedResults[assessmentId];
                updateAnalysis();
                return;
            }
            
            // Try to parse the code
            const parsed = assessment.parser(code);
            
            if (parsed) {
                input.className = 'valid';
                statusIcon.textContent = '‚úÖ';
                entryDiv.classList.add('completed');
                parsedResults[assessmentId] = { ...parsed, assessment: assessment.name, icon: assessment.icon };
                
                // Display parsed result
                let resultHTML = `<span class="primary">${parsed.primary || 'N/A'}</span>`;
                if (parsed.secondary) resultHTML += ` / ${parsed.secondary}`;
                if (parsed.level) resultHTML += ` ‚Ä¢ <span class="score">${parsed.level}</span>`;
                if (parsed.score) resultHTML += ` ‚Ä¢ Score: <span class="score">${parsed.score}${parsed.metric ? ' ' + parsed.metric : ''}</span>`;
                resultDiv.innerHTML = resultHTML;
                resultDiv.style.display = 'block';
                
                updateAnalysis();
                saveProgress();
            } else {
                input.className = 'invalid';
                resultDiv.style.display = 'none';
                statusIcon.textContent = '‚ùå';
                entryDiv.classList.remove('completed');
                delete parsedResults[assessmentId];
                updateAnalysis();
            }
        }
        
        function updateAnalysis() {
            const completedCount = Object.keys(parsedResults).length;
            document.getElementById('completedCount').textContent = completedCount;
            document.getElementById('progressPct').textContent = Math.round((completedCount / 22) * 100) + '%';
            
            if (completedCount === 0) {
                document.getElementById('noDataMsg').style.display = 'block';
                document.getElementById('analysisResults').style.display = 'none';
                document.getElementById('analysisBadge').textContent = 'Enter codes above';
                document.getElementById('overallStrength').textContent = '--';
                return;
            }
            
            document.getElementById('noDataMsg').style.display = 'none';
            document.getElementById('analysisResults').style.display = 'block';
            document.getElementById('analysisBadge').textContent = completedCount + ' Analyzed';
            
            // Generate comprehensive analysis
            generateAnalysis();
        }
        
        function generateAnalysis() {
            const results = Object.values(parsedResults);
            if (results.length === 0) return;
            
            // Collect all primary strengths
            const strengths = results.filter(r => r.primary).map(r => ({ trait: r.primary, source: r.assessment, icon: r.icon }));
            
            // Find most common themes
            const traitCounts = {};
            strengths.forEach(s => {
                traitCounts[s.trait] = (traitCounts[s.trait] || 0) + 1;
            });
            
            // Update top strength
            if (strengths.length > 0) {
                document.getElementById('overallStrength').textContent = strengths[0].trait.substring(0, 8) + '...';
            }
            
            // Generate SWOT
            const swot = generateSWOT(results);
            
            // Generate insights
            const insights = generateInsights(results);
            
            // Build analysis HTML
            const analysisHTML = `
                <div class="profile-grid">
                    <div class="profile-card">
                        <h4>üèÜ Your Primary Styles & Strengths</h4>
                        ${strengths.slice(0, 8).map(s => `
                            <div class="trait">
                                <span>${s.icon} ${s.source}</span>
                                <span class="value">${s.trait}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="profile-card">
                        <h4>üìä Assessment Scores</h4>
                        ${results.filter(r => r.score).slice(0, 8).map(r => `
                            <div class="trait">
                                <span>${r.icon} ${r.assessment}</span>
                                <span class="value">${r.score}${r.level ? ' (' + r.level + ')' : ''}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <h3 style="color: var(--chapman-blue); margin: 25px 0 15px;">üìà Combined SWOT Analysis</h3>
                <div class="swot-grid">
                    <div class="swot-box swot-strength">
                        <h4>üí™ Strengths</h4>
                        <ul>${swot.strengths.map(s => `<li>${s}</li>`).join('')}</ul>
                    </div>
                    <div class="swot-box swot-weakness">
                        <h4>üéØ Areas for Growth</h4>
                        <ul>${swot.weaknesses.map(w => `<li>${w}</li>`).join('')}</ul>
                    </div>
                    <div class="swot-box swot-opportunity">
                        <h4>üöÄ Opportunities</h4>
                        <ul>${swot.opportunities.map(o => `<li>${o}</li>`).join('')}</ul>
                    </div>
                    <div class="swot-box swot-threat">
                        <h4>‚ö†Ô∏è Watch Out For</h4>
                        <ul>${swot.threats.map(t => `<li>${t}</li>`).join('')}</ul>
                    </div>
                </div>
                
                <div class="insights-section">
                    <h3>üîÆ Deep Insights & Patterns</h3>
                    ${insights.map(i => `
                        <div class="insight-item">
                            <h5>${i.title}</h5>
                            <p>${i.description}</p>
                        </div>
                    `).join('')}
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="generateComprehensiveReport()">üìÑ Download Full PDF Report</button>
                    <button class="btn btn-secondary" onclick="window.print()">üñ®Ô∏è Print Summary</button>
                </div>
            `;
            
            document.getElementById('analysisResults').innerHTML = analysisHTML;
        }
        
        function generateSWOT(results) {
            const swot = {
                strengths: [],
                weaknesses: [],
                opportunities: [],
                threats: []
            };
            
            // Analyze patterns across assessments
            const hasLeadership = parsedResults.leadership;
            const hasEQ = parsedResults.eq;
            const hasConflict = parsedResults.conflict;
            const hasChange = parsedResults.change;
            const hasStrategic = parsedResults.strategic;
            const hasGrit = parsedResults.grit;
            const hasInfluence = parsedResults.influence;
            const hasMotivation = parsedResults.motivation;
            const hasTeamPlayer = parsedResults.teamplayer;
            const hasEthics = parsedResults.ethics;
            const hasPersonality = parsedResults.personality;
            const hasValues = parsedResults.values;
            
            // Generate contextual strengths
            if (hasLeadership) {
                swot.strengths.push(`Strong ${hasLeadership.primary} leadership style provides clear approach`);
            }
            if (hasEQ && hasEQ.level && (hasEQ.level.includes('High') || hasEQ.level.includes('Exceptional'))) {
                swot.strengths.push('High emotional intelligence supports effective relationships');
            }
            if (hasGrit && hasGrit.score >= 4.0) {
                swot.strengths.push('Strong grit and perseverance for long-term goals');
            }
            if (hasInfluence) {
                swot.strengths.push(`${hasInfluence.primary} influence style enables persuasion`);
            }
            if (hasStrategic) {
                swot.strengths.push(`${hasStrategic.primary} strategic strength aids decision-making`);
            }
            if (hasTeamPlayer) {
                swot.strengths.push(`${hasTeamPlayer.primary} team role contributes to group effectiveness`);
            }
            if (hasEthics && hasEthics.level && hasEthics.level.includes('Strong')) {
                swot.strengths.push(`Clear ${hasEthics.primary} ethical framework guides decisions`);
            }
            if (hasPersonality) {
                swot.strengths.push(`${hasPersonality.primary} management style provides focused approach`);
            }
            if (hasValues) {
                swot.strengths.push(`Strong ${hasValues.primary} values provide authentic foundation`);
            }
            
            // Generate contextual weaknesses
            if (hasConflict && hasConflict.primary === 'Avoiding') {
                swot.weaknesses.push('Tendency to avoid conflict may leave issues unresolved');
            }
            if (hasChange && hasChange.level && hasChange.level.includes('Resistant')) {
                swot.weaknesses.push('Lower change readiness may slow adaptation');
            }
            if (hasTeamPlayer && hasTeamPlayer.primary === 'Challenger') {
                swot.weaknesses.push('Challenger style may create friction without balance');
            }
            if (results.length < 5) {
                swot.weaknesses.push('Incomplete profile - continue assessments for full picture');
            }
            swot.weaknesses.push('Over-reliance on dominant styles may create blind spots');
            
            // Generate opportunities
            swot.opportunities.push('Develop secondary styles for greater versatility');
            if (hasMotivation) {
                swot.opportunities.push(`Leverage ${hasMotivation.primary} drive in career choices`);
            }
            swot.opportunities.push('Cross-train in growth areas identified across assessments');
            swot.opportunities.push('Apply self-awareness insights to team dynamics');
            
            // Generate threats
            swot.threats.push('Style inflexibility in rapidly changing environments');
            if (hasEQ && hasEQ.level && hasEQ.level.includes('Developing')) {
                swot.threats.push('EQ gaps may impact leadership effectiveness under stress');
            }
            swot.threats.push('Unconscious bias toward preferred approaches');
            swot.threats.push('Misreading situations that require different styles');
            
            return swot;
        }
        
        function generateInsights(results) {
            const insights = [];
            
            // Leadership + Influence synergy
            if (parsedResults.leadership && parsedResults.influence) {
                insights.push({
                    title: 'üëë Leadership-Influence Synergy',
                    description: `Your ${parsedResults.leadership.primary} leadership combined with ${parsedResults.influence.primary} influence creates a distinctive approach. Consider how these complement each other in team settings.`
                });
            }
            
            // EQ + Conflict pattern
            if (parsedResults.eq && parsedResults.conflict) {
                insights.push({
                    title: '‚ù§Ô∏è Emotional Intelligence in Conflict',
                    description: `Your ${parsedResults.eq.primary} EQ strength paired with ${parsedResults.conflict.primary} conflict style suggests you ${parsedResults.conflict.primary === 'Collaborating' ? 'naturally seek win-win solutions' : 'may benefit from more collaborative approaches in tense situations'}.`
                });
            }
            
            // Strategic + Decision-Making
            if (parsedResults.strategic && parsedResults.decision) {
                insights.push({
                    title: '‚ôüÔ∏è Strategic Decision Pattern',
                    description: `Your ${parsedResults.strategic.primary} strategic thinking combined with ${parsedResults.decision.primary} decision-making suggests a ${parsedResults.decision.primary === 'Analytical' ? 'data-driven' : 'balanced'} approach to important choices.`
                });
            }
            
            // Motivation + Grit
            if (parsedResults.motivation && parsedResults.grit) {
                insights.push({
                    title: 'üî• Drive & Persistence',
                    description: `Need for ${parsedResults.motivation.primary} combined with ${parsedResults.grit.level || 'your grit level'} suggests ${parsedResults.motivation.primary === 'Achievement' ? 'strong goal pursuit capability' : 'relationship-oriented persistence'}.`
                });
            }
            
            // Change + Innovation
            if (parsedResults.change && parsedResults.innovation) {
                insights.push({
                    title: 'üöÄ Change & Innovation Readiness',
                    description: `As a ${parsedResults.change.level || 'change adapter'} with ${parsedResults.innovation.primary} innovation strength, you're positioned to ${parsedResults.change.level && parsedResults.change.level.includes('Champion') ? 'lead transformation initiatives' : 'contribute meaningfully to change efforts'}.`
                });
            }
            
            // Learning style insight
            if (parsedResults.learning) {
                insights.push({
                    title: 'üìö Optimal Learning Approach',
                    description: `Your ${parsedResults.learning.primary} learning style means you learn best through ${parsedResults.learning.primary === 'Diverging' ? 'observation and brainstorming' : parsedResults.learning.primary === 'Assimilating' ? 'logical theories and models' : parsedResults.learning.primary === 'Converging' ? 'practical application' : 'hands-on experimentation'}.`
                });
            }
            
            // Team Player + Conflict pattern
            if (parsedResults.teamplayer && parsedResults.conflict) {
                insights.push({
                    title: 'ü§ù Team Collaboration Style',
                    description: `Your ${parsedResults.teamplayer.primary} team role combined with ${parsedResults.conflict.primary} conflict style creates a ${parsedResults.teamplayer.primary === 'Contributor' ? 'task-focused' : parsedResults.teamplayer.primary === 'Collaborator' ? 'goal-oriented' : parsedResults.teamplayer.primary === 'Communicator' ? 'relationship-building' : 'quality-focused'} approach to teamwork.`
                });
            }
            
            // Business Ethics + Values
            if (parsedResults.ethics && parsedResults.values) {
                insights.push({
                    title: '‚öñÔ∏è Ethical Foundation',
                    description: `Your ${parsedResults.ethics.primary} ethical framework aligns with your core value of ${parsedResults.values.primary}, suggesting a consistent moral compass for decision-making.`
                });
            }
            
            // Management Personality + Leadership
            if (parsedResults.personality && parsedResults.leadership) {
                insights.push({
                    title: 'üß† Management DNA',
                    description: `Your ${parsedResults.personality.primary} management personality combined with ${parsedResults.leadership.primary} leadership style reveals a ${parsedResults.personality.primary === 'Director' ? 'results-driven' : parsedResults.personality.primary === 'Innovator' ? 'creative' : parsedResults.personality.primary === 'Visionary' ? 'big-picture' : 'developmental'} management approach.`
                });
            }
            
            // Values + Motivation synergy
            if (parsedResults.values && parsedResults.motivation) {
                insights.push({
                    title: 'üíé Values-Motivation Alignment',
                    description: `Your core value of ${parsedResults.values.primary} paired with ${parsedResults.motivation.primary} motivation suggests you're driven by ${parsedResults.motivation.primary === 'Achievement' ? 'excellence and accomplishment' : parsedResults.motivation.primary === 'Affiliation' ? 'meaningful connections' : 'making an impact'} in alignment with your values.`
                });
            }
            
            // Overall pattern
            if (results.length >= 5) {
                insights.push({
                    title: 'üéØ Your Emerging Leadership Profile',
                    description: `Based on ${results.length} assessments, you show a pattern of ${results.filter(r => r.primary).slice(0, 3).map(r => r.primary).join(', ')} tendencies. This suggests a leadership style that values these approaches - consider how to leverage them while developing complementary skills.`
                });
            }
            
            return insights;
        }
        
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            section.classList.toggle('open');
            const content = section.querySelector('.section-content');
            content.classList.toggle('open');
        }
        
        function saveProgress() {
            const data = {
                studentName: document.getElementById('studentName').value,
                date: document.getElementById('trackingDate').value,
                codes: {}
            };
            
            activeAssessments.forEach(a => {
                const code = document.getElementById(`code-${a.id}`).value;
                if (code) data.codes[a.id] = code;
            });
            
            localStorage.setItem('mgmt316_tracker', JSON.stringify(data));
        }
        
        function loadProgress() {
            const saved = localStorage.getItem('mgmt316_tracker');
            if (!saved) return;
            
            try {
                const data = JSON.parse(saved);
                if (data.studentName) document.getElementById('studentName').value = data.studentName;
                if (data.date) document.getElementById('trackingDate').value = data.date;
                if (data.codes) {
                    Object.entries(data.codes).forEach(([id, code]) => {
                        const input = document.getElementById(`code-${id}`);
                        if (input) {
                            input.value = code;
                            validateCode(id);
                        }
                    });
                }
            } catch (e) {
                console.error('Error loading progress:', e);
            }
        }
        
        function clearAllData() {
            if (!confirm('Are you sure you want to clear all entered data? This cannot be undone.')) return;
            
            localStorage.removeItem('mgmt316_tracker');
            activeAssessments.forEach(a => {
                document.getElementById(`code-${a.id}`).value = '';
                validateCode(a.id);
            });
            document.getElementById('studentName').value = '';
            document.getElementById('trackingDate').value = new Date().toISOString().split('T')[0];
            parsedResults = {};
            updateAnalysis();
        }
        
        function generateComprehensiveReport() {
            const studentName = document.getElementById('studentName').value || 'Student';
            const completedCount = Object.keys(parsedResults).length;
            
            if (completedCount === 0) {
                alert('Please enter at least one tracker code before generating a report.');
                return;
            }
            
            var jsPDF = window.jspdf.jsPDF;
            var doc = new jsPDF();
            
            var chapmanBlue = [0, 32, 91];
            var chapmanGold = [196, 160, 0];
            var textDark = [26, 26, 46];
            var textMuted = [100, 100, 110];
            var greenColor = [46, 125, 50];
            var redColor = [198, 40, 40];
            var blueColor = [21, 101, 192];
            var orangeColor = [230, 81, 0];
            
            // Page 1: Header and Overview
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.rect(0, 0, 210, 45, 'F');
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('CHAPMAN UNIVERSITY', 105, 12, { align: 'center' });
            doc.setFontSize(9);
            doc.setTextColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.text('Argyros College of Business and Economics', 105, 18, { align: 'center' });
            doc.setFontSize(16);
            doc.setTextColor(255, 255, 255);
            doc.text('MGMT 316 Assessment Portfolio', 105, 30, { align: 'center' });
            doc.setFontSize(10);
            doc.text('Comprehensive Self-Awareness Profile', 105, 38, { align: 'center' });
            doc.setFillColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.rect(0, 45, 210, 2, 'F');
            
            var y = 55;
            doc.setFontSize(11);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text('Student: ' + studentName, 20, y);
            doc.text('Date: ' + new Date().toLocaleDateString(), 140, y);
            y += 8;
            doc.setFontSize(9);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            doc.text('Assessments Completed: ' + completedCount + ' of 22 (' + Math.round((completedCount/22)*100) + '%)', 20, y);
            y += 12;
            
            // Summary Box
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 12, 2, 2, 'F');
            doc.setFontSize(11);
            doc.setTextColor(255, 255, 255);
            doc.text('PRIMARY STYLES & STRENGTHS', 105, y + 8, { align: 'center' });
            y += 18;
            
            // List all primary results
            doc.setFontSize(9);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var results = Object.values(parsedResults);
            results.forEach(function(r) {
                if (y > 270) { doc.addPage(); y = 20; }
                var text = r.assessment + ': ' + (r.primary || 'N/A');
                if (r.secondary) text += ' / ' + r.secondary;
                if (r.level) text += ' (' + r.level + ')';
                if (r.score) text += ' - Score: ' + r.score;
                doc.text(text, 25, y);
                y += 5;
            });
            
            // Page 2: SWOT Analysis
            doc.addPage();
            y = 20;
            
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 10, 2, 2, 'F');
            doc.setFontSize(11);
            doc.setTextColor(255, 255, 255);
            doc.text('COMBINED SWOT ANALYSIS', 105, y + 7, { align: 'center' });
            y += 18;
            
            var swot = generateSWOT(results);
            
            // Strengths
            doc.setFontSize(10);
            doc.setTextColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.text('STRENGTHS', 20, y);
            y += 6;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            swot.strengths.forEach(function(s) {
                var lines = doc.splitTextToSize('- ' + s, 165);
                lines.forEach(function(line) {
                    doc.text(line, 25, y);
                    y += 4;
                });
            });
            y += 6;
            
            // Weaknesses
            doc.setFontSize(10);
            doc.setTextColor(redColor[0], redColor[1], redColor[2]);
            doc.text('AREAS FOR GROWTH', 20, y);
            y += 6;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            swot.weaknesses.forEach(function(w) {
                var lines = doc.splitTextToSize('- ' + w, 165);
                lines.forEach(function(line) {
                    doc.text(line, 25, y);
                    y += 4;
                });
            });
            y += 6;
            
            // Opportunities
            doc.setFontSize(10);
            doc.setTextColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.text('OPPORTUNITIES', 20, y);
            y += 6;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            swot.opportunities.forEach(function(o) {
                var lines = doc.splitTextToSize('- ' + o, 165);
                lines.forEach(function(line) {
                    doc.text(line, 25, y);
                    y += 4;
                });
            });
            y += 6;
            
            // Threats
            doc.setFontSize(10);
            doc.setTextColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.text('WATCH OUT FOR', 20, y);
            y += 6;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            swot.threats.forEach(function(t) {
                var lines = doc.splitTextToSize('- ' + t, 165);
                lines.forEach(function(line) {
                    doc.text(line, 25, y);
                    y += 4;
                });
            });
            
            // Footer on all pages
            var pageCount = doc.internal.getNumberOfPages();
            for (var i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
                doc.text('Page ' + i + ' of ' + pageCount, 105, 287, { align: 'center' });
                doc.text('Chapman University - MGMT 316 - Professor Chip Monaco', 105, 292, { align: 'center' });
            }
            
            doc.save('MGMT316_Portfolio_' + studentName.replace(/\s+/g, '_') + '_' + new Date().toISOString().split('T')[0] + '.pdf');
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
