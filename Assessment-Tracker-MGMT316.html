<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MGMT 316 Assessment Tracker | Chapman University</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --chapman-blue: #00205B;
            --chapman-gold: #C4A000;
            --gold-light: #F5E6A3;
            --blue-light: #E8EDF5;
            --blue-medium: #1A3A7A;
            --text-primary: #1a1a2e;
            --text-secondary: #4a4a5a;
            --white: #ffffff;
            --green: #2E7D32;
            --red: #C62828;
            --orange: #E65100;
            --purple: #7B1FA2;
            --inactive: #9e9e9e;
            --inactive-bg: #f5f5f5;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; line-height: 1.6; color: var(--text-primary); background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); min-height: 100vh; }
        
        .header {
            background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium));
            color: var(--white);
            padding: 30px;
            text-align: center;
            position: relative;
        }
        .header::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, var(--chapman-gold), var(--gold-light), var(--chapman-gold)); }
        .institution { font-size: 0.9em; letter-spacing: 2px; text-transform: uppercase; opacity: 0.9; }
        .college { font-size: 1em; color: var(--chapman-gold); margin: 5px 0 15px; font-weight: 600; }
        h1 { font-size: 2.2em; font-weight: 700; margin-bottom: 8px; }
        .subtitle { font-size: 1.05em; color: var(--gold-light); }
        
        .student-info-bar {
            background: var(--white);
            padding: 20px 30px;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--blue-light);
        }
        .student-info-bar input {
            padding: 10px 15px;
            border: 2px solid var(--blue-light);
            border-radius: 8px;
            font-size: 1em;
            flex: 1;
            min-width: 200px;
        }
        .student-info-bar input:focus { outline: none; border-color: var(--chapman-blue); }
        
        .progress-summary {
            background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium));
            padding: 20px 30px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 15px;
        }
        .progress-stat {
            text-align: center;
            color: var(--white);
        }
        .progress-stat .number { font-size: 2em; font-weight: 700; color: var(--chapman-gold); }
        .progress-stat .label { font-size: 0.85em; opacity: 0.9; }
        
        .main-content { max-width: 1400px; margin: 0 auto; padding: 25px; }
        
        .section-card {
            background: var(--white);
            border-radius: 16px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .section-header {
            background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium));
            color: var(--white);
            padding: 18px 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
        }
        .section-header h2 { font-size: 1.2em; flex: 1; }
        .section-header .toggle { font-size: 1.3em; transition: transform 0.3s; }
        .section-header .badge {
            background: var(--chapman-gold);
            color: var(--chapman-blue);
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
        }
        .section-content { padding: 0; max-height: 0; overflow: hidden; transition: all 0.4s ease; }
        .section-content.open { padding: 25px; max-height: 5000px; }
        .section-card.open .toggle { transform: rotate(180deg); }
        
        .assessments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 15px;
        }
        
        .assessment-entry {
            background: var(--blue-light);
            border-radius: 12px;
            padding: 18px;
            border-left: 4px solid var(--chapman-blue);
            transition: all 0.3s;
        }
        .assessment-entry:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .assessment-entry.completed { border-left-color: var(--green); background: linear-gradient(135deg, #e8f5e9, var(--blue-light)); }
        .assessment-entry.inactive {
            border-left-color: var(--inactive);
            background: var(--inactive-bg);
            opacity: 0.6;
        }
        .assessment-entry.inactive * { color: var(--inactive) !important; }
        
        .assessment-entry h4 { color: var(--chapman-blue); margin-bottom: 6px; font-size: 0.95em; display: flex; align-items: center; gap: 8px; }
        .assessment-entry h4 .status { font-size: 1.1em; }
        .assessment-entry .framework { font-size: 0.75em; color: var(--text-secondary); margin-bottom: 10px; }
        .assessment-entry .tracker-input {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .assessment-entry input {
            flex: 1;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 0.9em;
            font-family: 'Courier New', monospace;
            text-transform: uppercase;
        }
        .assessment-entry input:focus { outline: none; border-color: var(--chapman-blue); }
        .assessment-entry input.valid { border-color: var(--green); background: #f1f8e9; }
        .assessment-entry input.invalid { border-color: var(--red); background: #ffebee; }
        .assessment-entry .parsed-result {
            margin-top: 10px;
            padding: 10px;
            background: var(--white);
            border-radius: 8px;
            font-size: 0.8em;
        }
        .assessment-entry .parsed-result .primary { color: var(--chapman-blue); font-weight: 600; }
        .assessment-entry .parsed-result .score { color: var(--green); }
        
        .inactive-label {
            display: inline-block;
            background: var(--inactive);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            margin-left: 8px;
        }
        
        /* Analysis Section */
        .analysis-container { padding: 25px; }
        
        .profile-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .profile-card {
            background: var(--blue-light);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid var(--chapman-blue);
        }
        .profile-card h4 { color: var(--chapman-blue); margin-bottom: 12px; font-size: 1em; }
        .profile-card .trait { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid rgba(0,0,0,0.05); font-size: 0.9em; }
        .profile-card .trait:last-child { border-bottom: none; }
        .profile-card .trait .value { font-weight: 600; color: var(--chapman-blue); }
        
        .swot-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 25px 0;
        }
        .swot-box {
            padding: 20px;
            border-radius: 12px;
            min-height: 150px;
        }
        .swot-box h4 { margin-bottom: 12px; font-size: 1em; }
        .swot-box ul { margin-left: 20px; font-size: 0.9em; }
        .swot-box li { margin-bottom: 6px; }
        .swot-strength { background: #e8f5e9; border-left: 4px solid var(--green); }
        .swot-strength h4 { color: var(--green); }
        .swot-weakness { background: #ffebee; border-left: 4px solid var(--red); }
        .swot-weakness h4 { color: var(--red); }
        .swot-opportunity { background: #e3f2fd; border-left: 4px solid #1565C0; }
        .swot-opportunity h4 { color: #1565C0; }
        .swot-threat { background: #fff3e0; border-left: 4px solid var(--orange); }
        .swot-threat h4 { color: var(--orange); }
        
        .insights-section {
            background: linear-gradient(135deg, #fffef8, #fef9e7);
            border: 2px solid var(--chapman-gold);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
        }
        .insights-section h3 { color: var(--chapman-blue); margin-bottom: 15px; }
        .insight-item {
            padding: 15px;
            background: var(--white);
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 3px solid var(--chapman-gold);
        }
        .insight-item h5 { color: var(--chapman-blue); margin-bottom: 6px; }
        .insight-item p { font-size: 0.9em; color: var(--text-secondary); }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary { background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); color: var(--white); }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0,32,91,0.3); }
        .btn-secondary { background: linear-gradient(135deg, var(--chapman-gold), #d4b000); color: var(--chapman-blue); }
        .btn-outline { background: transparent; border: 2px solid var(--chapman-blue); color: var(--chapman-blue); }
        
        .no-data-message {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }
        .no-data-message .icon { font-size: 3em; margin-bottom: 15px; opacity: 0.5; }
        
        .footer {
            text-align: center;
            padding: 25px;
            color: var(--white);
            opacity: 0.9;
            font-size: 0.9em;
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 1.6em; }
            .swot-grid { grid-template-columns: 1fr; }
            .student-info-bar { flex-direction: column; }
            .student-info-bar input { width: 100%; }
        }
        
        @media print {
            .header, .section-header { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .btn { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="institution">Chapman University</div>
        <div class="college">Argyros College of Business and Economics</div>
        <h1>üìä MGMT 316 Assessment Tracker</h1>
        <div class="subtitle">Personal Self-Awareness & Leadership Development Portfolio</div>
    </div>
    
    <div class="student-info-bar">
        <input type="text" id="studentName" placeholder="Your Full Name" onchange="saveProgress()">
        <input type="date" id="trackingDate" onchange="saveProgress()">
        <button class="btn btn-primary" onclick="generateComprehensiveReport()">üìÑ Generate Full Report</button>
        <button class="btn btn-outline" onclick="clearAllData()">üîÑ Reset All</button>
    </div>
    
    <div class="progress-summary">
        <div class="progress-stat">
            <div class="number" id="completedCount">0</div>
            <div class="label">Completed</div>
        </div>
        <div class="progress-stat">
            <div class="number" id="totalActive">22</div>
            <div class="label">Total Active</div>
        </div>
        <div class="progress-stat">
            <div class="number" id="progressPct">0%</div>
            <div class="label">Progress</div>
        </div>
        <div class="progress-stat">
            <div class="number" id="overallStrength">--</div>
            <div class="label">Top Strength</div>
        </div>
    </div>
    
    <div class="main-content">
        <!-- Active Assessments Section -->
        <div class="section-card open" id="active-section">
            <div class="section-header" onclick="toggleSection('active-section')">
                <span>‚úÖ</span>
                <h2>MGMT 316 Course Assessments</h2>
                <span class="badge">22 Active</span>
                <span class="toggle">‚ñº</span>
            </div>
            <div class="section-content open">
                <div class="assessments-grid" id="activeAssessments">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Analysis Section -->
        <div class="section-card" id="analysis-section">
            <div class="section-header" onclick="toggleSection('analysis-section')">
                <span>üìà</span>
                <h2>Combined Analysis & Insights</h2>
                <span class="badge" id="analysisBadge">Enter codes above</span>
                <span class="toggle">‚ñº</span>
            </div>
            <div class="section-content" id="analysisContent">
                <div class="no-data-message" id="noDataMsg">
                    <div class="icon">üìù</div>
                    <h3>Enter Your Assessment Tracker Codes</h3>
                    <p>As you complete assessments, enter your tracker codes above.<br>Your comprehensive profile analysis will appear here.</p>
                </div>
                <div id="analysisResults" style="display: none;">
                    <!-- Will be populated when codes are entered -->
                </div>
            </div>
        </div>
        
        <!-- Inactive Assessments Section -->
        <div class="section-card" id="inactive-section">
            <div class="section-header" onclick="toggleSection('inactive-section')">
                <span>üìã</span>
                <h2>Other Available Assessments</h2>
                <span class="badge" style="background: var(--inactive); color: white;">Not in Course</span>
                <span class="toggle">‚ñº</span>
            </div>
            <div class="section-content">
                <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.9em;">These assessments are available in the full Management Assessment Hub but are not required for MGMT 316.</p>
                <div class="assessments-grid" id="inactiveAssessments">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>MGMT 316 Assessment Tracker ‚Ä¢ Chapman University ‚Ä¢ Argyros College of Business and Economics</p>
        <p style="margin-top: 5px;">¬© 2025 Professor Chip Monaco</p>
    </div>

    <script>
        // Active assessments for MGMT 316 with their tracker code patterns
        const activeAssessments = [
            { id: 'leadership', name: 'Leadership Style', icon: 'üëë', framework: 'Situational Leadership (Hersey & Blanchard)', code: 'LSA', dimensions: ['Directing', 'Coaching', 'Supporting', 'Delegating'], parser: parseLSA },
            { id: 'communication', name: 'Communication Style', icon: 'üí¨', framework: 'Communication Theory', code: 'CSA', dimensions: ['Analytical', 'Intuitive', 'Functional', 'Personal'], parser: parseCSA },
            { id: 'conflict', name: 'Conflict Management', icon: '‚öîÔ∏è', framework: 'Thomas-Kilmann TKI', code: 'CMA', dimensions: ['Competing', 'Collaborating', 'Compromising', 'Avoiding', 'Accommodating'], parser: parseCMA },
            { id: 'eq', name: 'Emotional Intelligence', icon: '‚ù§Ô∏è', framework: "Goleman's EQ Model", code: 'EIA', dimensions: ['Self-Awareness', 'Self-Regulation', 'Motivation', 'Empathy', 'Social Skills'], parser: parseEIA },
            { id: 'decision', name: 'Decision-Making Style', icon: 'üé≤', framework: 'Rowe & Boulgarides', code: 'DMS', dimensions: ['Directive', 'Analytical', 'Conceptual', 'Behavioral'], parser: parseDMS },
            { id: 'motivation', name: 'Motivation Style', icon: 'üî•', framework: "McClelland's Acquired Needs", code: 'MSA', dimensions: ['Achievement', 'Affiliation', 'Power'], parser: parseMSA },
            { id: 'stress', name: 'Stress Management', icon: 'üßò', framework: "Lazarus & Folkman's Coping", code: 'SMS', dimensions: ['Problem-Focused', 'Emotion-Focused', 'Support-Seeking', 'Avoidant'], parser: parseSMS },
            { id: 'change', name: 'Change Readiness', icon: 'üîÑ', framework: "Rogers' Diffusion of Innovations", code: 'CRA', dimensions: ['Cognitive', 'Emotional', 'Proactive', 'Learning'], parser: parseCRA },
            { id: 'influence', name: 'Influence Style', icon: 'üé≠', framework: "Cohen & Bradford's Influence", code: 'ISA', dimensions: ['Rationalizing', 'Asserting', 'Negotiating', 'Inspiring', 'Bridging'], parser: parseISA },
            { id: 'learning', name: 'Learning Style', icon: 'üìö', framework: "Kolb's Learning Cycle", code: 'LRN', dimensions: ['Diverging', 'Assimilating', 'Converging', 'Accommodating'], parser: parseLRN },
            { id: 'grit', name: 'Grit Assessment', icon: 'üí™', framework: "Duckworth's Grit Scale", code: 'GRT', dimensions: ['Passion', 'Perseverance'], parser: parseGRT },
            { id: 'psych_safety', name: 'Psychological Safety', icon: 'üõ°Ô∏è', framework: "Edmondson's Research", code: 'PSA', dimensions: ['Speaking Up', 'Risk Taking', 'Inclusion', 'Learning'], parser: parsePSA },
            { id: 'systems', name: 'Systems Thinking', icon: 'üîÑ', framework: "Senge's Fifth Discipline", code: 'SYS', dimensions: ['Holistic', 'Interconnections', 'Dynamics', 'Leverage'], parser: parseSYS },
            { id: 'strategic', name: 'Strategic Thinking', icon: '‚ôüÔ∏è', framework: 'Strategic Management', code: 'STA', dimensions: ['Vision', 'Analysis', 'Agility', 'Execution'], parser: parseSTA },
            { id: 'critical', name: 'Critical Thinking', icon: 'üß†', framework: 'Paul & Elder Framework', code: 'CTA', dimensions: ['Analysis', 'Evaluation', 'Inference', 'Open-Mindedness'], parser: parseCTA },
            { id: 'entrepreneurial', name: 'Entrepreneurial Orientation', icon: 'üöÄ', framework: 'Lumpkin & Dess EO', code: 'EOA', dimensions: ['Innovativeness', 'Proactiveness', 'Risk-Taking', 'Autonomy', 'Competitive'], parser: parseEOA },
            { id: 'risk', name: 'Risk Tolerance', icon: 'üé≤', framework: 'DOSPERT Framework', code: 'RTA', dimensions: ['Financial', 'Career', 'Social', 'Physical'], parser: parseRTA },
            { id: 'innovation', name: 'Innovation Mindset', icon: 'üí°', framework: 'Design Thinking + Lean', code: 'IMA', dimensions: ['Curiosity', 'Experimentation', 'Resilience', 'Collaboration'], parser: parseIMA },
            // NEW: Added 4 assessments
            { id: 'personality', name: 'Management Personality', icon: 'üß†', framework: 'Management Style Quadrants', code: 'MPA', dimensions: ['Director', 'Innovator', 'Visionary', 'Developer'], parser: parseMPA },
            { id: 'values', name: 'Values Discovery', icon: 'üíé', framework: 'Personal Values Framework', code: 'VDA', dimensions: ['Achievement', 'Relationship', 'Growth', 'Service', 'Integrity'], parser: parseVDA },
            { id: 'ethics', name: 'Business Ethics', icon: '‚öñÔ∏è', framework: 'Ethical Frameworks', code: 'BEA', dimensions: ['Consequentialist', 'Deontologist', 'Virtue', 'Care'], parser: parseBEA },
            { id: 'teamplayer', name: 'Team Player Style', icon: 'ü§ù', framework: 'Parker Team Roles', code: 'TPA', dimensions: ['Contributor', 'Collaborator', 'Communicator', 'Challenger'], parser: parseTPA }
        ];
        
        // Inactive assessments (greyed out)
        const inactiveAssessments = [
            { name: 'DISC Behavioral Style', icon: 'üéØ', framework: 'Marston DISC Model' },
            { name: 'Growth Mindset', icon: 'üå±', framework: "Dweck's Research" },
            { name: 'Time Management', icon: '‚è∞', framework: 'Macan TMB Scale' },
            { name: 'Cultural Intelligence', icon: 'üåç', framework: 'Ang & Van Dyne CQ' },
            { name: 'Negotiation Style', icon: 'ü§ù', framework: 'Lewicki Negotiation' },
            { name: 'Career Anchors', icon: '‚öì', framework: 'Edgar Schein Model' },
            { name: 'Political Skill', icon: 'üéØ', framework: 'Ferris PSI' },
            { name: 'Creativity Style', icon: 'üí°', framework: 'Kirton Adaption-Innovation' },
            { name: 'Psychological Capital', icon: 'ü¶∏', framework: 'Luthans HERO Model' },
            { name: 'Self-Efficacy', icon: 'üéØ', framework: 'Bandura Theory' },
            { name: 'Authentic Leadership', icon: 'üåü', framework: 'Walumbwa ALQ' },
            { name: 'Servant Leadership', icon: 'üôè', framework: 'Greenleaf Model' },
            { name: 'Mindfulness', icon: 'üßò', framework: 'FFMQ Five Facet' },
            { name: 'Trust Assessment', icon: 'ü§ù', framework: 'Mayer-Davis-Schoorman' },
            { name: 'Organizational Commitment', icon: 'üè¢', framework: 'Meyer & Allen Model' }
        ];
        
        // Store parsed results
        let parsedResults = {};
        
        // Parser functions for each assessment type
        function parseLSA(code) {
            // LSA-{Primary}{Secondary}-{Clarity} e.g., LSA-CoDe-S
            const match = code.match(/LSA-([A-Z][a-z])([A-Z][a-z])-([SMB])/i);
            if (!match) return null;
            const styles = { Di: 'Directing', Co: 'Coaching', Su: 'Supporting', De: 'Delegating' };
            const levels = { S: 'Strong Clarity', M: 'Moderate Clarity', B: 'Balanced' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], level: levels[match[3].toUpperCase()] || match[3] };
        }
        
        function parseCSA(code) {
            // CSA-{Primary}{Secondary}-{Clarity} e.g., CSA-AnIn-S
            const match = code.match(/CSA-([A-Z][a-z])([A-Z][a-z])-([SMB])/i);
            if (!match) return null;
            const styles = { An: 'Analytical', In: 'Intuitive', Fu: 'Functional', Pe: 'Personal' };
            const levels = { S: 'Strong Clarity', M: 'Moderate Clarity', B: 'Balanced' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], level: levels[match[3].toUpperCase()] || match[3] };
        }
        
        function parseCMA(code) {
            // CMA-{Primary}{Secondary}-{Score} e.g., CMA-ClCo-42
            const match = code.match(/CMA-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const styles = { Cm: 'Competing', Cl: 'Collaborating', Co: 'Compromising', Av: 'Avoiding', Ac: 'Accommodating' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseEIA(code) {
            // EIA-{HighestDim}-{Level}{Score} e.g., EIA-Em-H198
            const match = code.match(/EIA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { SA: 'Self-Awareness', SR: 'Self-Regulation', Mo: 'Motivation', Em: 'Empathy', SS: 'Social Skills' };
            const levels = { E: 'Exceptional', H: 'High', M: 'Moderate', D: 'Developing', B: 'Building' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseDMS(code) {
            // DMS-{Primary}{Secondary}-{Score} e.g., DMS-DiAn-65
            const match = code.match(/DMS-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const styles = { Di: 'Directive', An: 'Analytical', Co: 'Conceptual', Be: 'Behavioral' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseMSA(code) {
            // MSA-{Primary}{Secondary}-{Score} e.g., MSA-AcPo-48
            const match = code.match(/MSA-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const needs = { Ac: 'Achievement', Af: 'Affiliation', Po: 'Power' };
            return { primary: needs[match[1]] || match[1], secondary: needs[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseSMS(code) {
            // SMS-{Primary}{Secondary}-{ApproachPct} e.g., SMS-PFSS-78
            const match = code.match(/SMS-([A-Z]{2})([A-Z]{2})-(\d+)/i);
            if (!match) return null;
            const styles = { PF: 'Problem-Focused', EF: 'Emotion-Focused', SS: 'Support-Seeking', Av: 'Avoidant' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]), metric: 'Approach %' };
        }
        
        function parseCRA(code) {
            // CRA-{HighestDim}-{Profile}{Score} e.g., CRA-Pr-Ch175
            const match = code.match(/CRA-([A-Z][a-z])-([A-Z][a-z])(\d+)/i);
            if (!match) return null;
            const dims = { Co: 'Cognitive', Em: 'Emotional', Pr: 'Proactive', Le: 'Learning' };
            const profiles = { Ch: 'Change Champion', Re: 'Change Ready', Ca: 'Change Capable', Rs: 'Change Resistant' };
            return { primary: dims[match[1]] || match[1], level: profiles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseISA(code) {
            // ISA-{Primary}{Secondary}-{Score} e.g., ISA-RaNe-35
            const match = code.match(/ISA-([A-Z][a-z])([A-Z][a-z])-(\d+)/i);
            if (!match) return null;
            const styles = { Ra: 'Rationalizing', As: 'Asserting', Ne: 'Negotiating', In: 'Inspiring', Br: 'Bridging' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseLRN(code) {
            // LRN-{Style}-{Clarity} e.g., LRN-Di-S
            const match = code.match(/LRN-([A-Z][a-z])-([SMB])/i);
            if (!match) return null;
            const styles = { Di: 'Diverging', As: 'Assimilating', Co: 'Converging', Ac: 'Accommodating' };
            const levels = { S: 'Strong Clarity', M: 'Moderate Clarity', B: 'Balanced' };
            return { primary: styles[match[1]] || match[1], level: levels[match[2].toUpperCase()] || match[2] };
        }
        
        function parseGRT(code) {
            // GRT-{Dim}-{Level}{Score} e.g., GRT-Pa-V45
            const match = code.match(/GRT-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Pa: 'Passion', Pe: 'Perseverance' };
            const levels = { E: 'Extremely Gritty', V: 'Very Gritty', G: 'Gritty', M: 'Moderately Gritty', S: 'Somewhat Gritty', B: 'Building Grit' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseFloat(match[3]) / 10 };
        }
        
        function parsePSA(code) {
            // PSA-{Level}-{Score} e.g., PSA-H-85
            const match = code.match(/PSA-([A-Z])-(\d+)/i);
            if (!match) return null;
            const levels = { H: 'High Safety', M: 'Moderate Safety', L: 'Low Safety' };
            return { level: levels[match[1].toUpperCase()] || match[1], score: parseInt(match[2]) };
        }
        
        function parseSYS(code) {
            // SYS-{HighestDim}-{Level}{Score} e.g., SYS-Ho-H78
            const match = code.match(/SYS-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Ho: 'Holistic', In: 'Interconnections', Dy: 'Dynamics', Le: 'Leverage' };
            const levels = { H: 'High', M: 'Moderate', D: 'Developing', E: 'Emerging' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseSTA(code) {
            // STA-{HighestDim}-{Level}{Score} e.g., STA-Vi-L85
            const match = code.match(/STA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Vi: 'Vision', An: 'Analysis', Ag: 'Agility', Ex: 'Execution' };
            const levels = { L: 'Strategic Leader', T: 'Strategic Thinker', D: 'Developing Strategist', C: 'Tactical Thinker' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseCTA(code) {
            // CTA-{HighestDim}-{Level}{Score} e.g., CTA-An-M75
            const match = code.match(/CTA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { An: 'Analysis', Ev: 'Evaluation', In: 'Inference', Op: 'Open-Mindedness' };
            const levels = { M: 'Master', S: 'Strong', D: 'Developing', E: 'Emerging' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseEOA(code) {
            // EOA-{HighestDim}-{Level}{Score} e.g., EOA-In-H112
            const match = code.match(/EOA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { In: 'Innovativeness', Pr: 'Proactiveness', Ri: 'Risk-Taking', Au: 'Autonomy', Co: 'Competitive' };
            const levels = { H: 'High EO', E: 'Entrepreneurial', M: 'Moderate', L: 'Low' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseRTA(code) {
            // RTA-{HighestDim}-{Level}{Score} e.g., RTA-Ca-M65
            const match = code.match(/RTA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Fi: 'Financial', Ca: 'Career', So: 'Social', Ph: 'Physical' };
            const levels = { H: 'High Tolerance', M: 'Moderate', L: 'Low Tolerance', C: 'Cautious' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        function parseIMA(code) {
            // IMA-{HighestDim}-{Level}{Score} e.g., IMA-Cu-H85
            const match = code.match(/IMA-([A-Z][a-z])-([A-Z])(\d+)/i);
            if (!match) return null;
            const dims = { Cu: 'Curiosity', Ex: 'Experimentation', Re: 'Resilience', Co: 'Collaboration' };
            const levels = { H: 'High Innovator', M: 'Moderate', D: 'Developing', E: 'Emerging' };
            return { primary: dims[match[1]] || match[1], level: levels[match[2]] || match[2], score: parseInt(match[3]) };
        }
        
        // NEW: Management Personality Assessment parser
        function parseMPA(code) {
            // MPA-{Primary}{Secondary}-{Intensity} e.g., MPA-DiIn-S
            const match = code.match(/MPA-([A-Z][a-z])([A-Z][a-z]|XX)-([SMB])/i);
            if (!match) return null;
            const types = { Di: 'Director', In: 'Innovator', Vi: 'Visionary', Dv: 'Developer', XX: null };
            const levels = { S: 'Strong', M: 'Moderate', B: 'Balanced' };
            return { primary: types[match[1]] || match[1], secondary: types[match[2]] || null, level: levels[match[3]] || match[3] };
        }
        
        // NEW: Values Discovery Assessment parser
        function parseVDA(code) {
            // VDA-{Top3Letters}-{Count} e.g., VDA-ACH-5
            const match = code.match(/VDA-([A-Z]{3})-(\d+)/i);
            if (!match) return null;
            const valueMap = {
                ACH: 'Achievement', SUC: 'Success', EXC: 'Excellence', FAM: 'Family', FRI: 'Friendship',
                LOV: 'Love', GRO: 'Growth', LEA: 'Learning', KNO: 'Knowledge', SER: 'Service',
                CON: 'Contribution', COM: 'Compassion', HON: 'Honesty', INT: 'Integrity', AUT: 'Authenticity',
                FRE: 'Freedom', IND: 'Independence', CRE: 'Creativity', ADV: 'Adventure', BAL: 'Balance',
                SEC: 'Security', STA: 'Stability', HEA: 'Health', WEL: 'Wellness', WIS: 'Wisdom'
            };
            return { primary: valueMap[match[1].toUpperCase()] || match[1], score: parseInt(match[2]), metric: 'values selected' };
        }
        
        // NEW: Business Ethics Assessment parser
        function parseBEA(code) {
            // BEA-{Primary}{Secondary}-{Clarity} e.g., BEA-CoDe-S
            const match = code.match(/BEA-([A-Z][a-z])([A-Z][a-z]|XX)-([SMB])/i);
            if (!match) return null;
            const types = { Co: 'Consequentialist', De: 'Deontologist', Vi: 'Virtue Ethicist', Ca: 'Care Ethicist', XX: null };
            const levels = { S: 'Strong', M: 'Moderate', B: 'Balanced' };
            return { primary: types[match[1]] || match[1], secondary: types[match[2]] || null, level: levels[match[3]] + ' Framework Clarity' };
        }
        
        // NEW: Team Player Assessment parser
        function parseTPA(code) {
            // TPA-{Primary}{Secondary}-{Clarity} e.g., TPA-CtCl-S
            const match = code.match(/TPA-([A-Z][a-z])([A-Z][a-z])-([SMB])/i);
            if (!match) return null;
            const styles = { Ct: 'Contributor', Cl: 'Collaborator', Cm: 'Communicator', Ch: 'Challenger' };
            const levels = { S: 'Strong', M: 'Moderate', B: 'Balanced' };
            return { primary: styles[match[1]] || match[1], secondary: styles[match[2]] || match[2], level: levels[match[3]] + ' Style Clarity' };
        }
        
        // Initialize the page
        function init() {
            renderActiveAssessments();
            renderInactiveAssessments();
            loadProgress();
            document.getElementById('trackingDate').value = new Date().toISOString().split('T')[0];
        }
        
        function renderActiveAssessments() {
            const container = document.getElementById('activeAssessments');
            container.innerHTML = activeAssessments.map(a => `
                <div class="assessment-entry" id="entry-${a.id}">
                    <h4>
                        <span class="status" id="status-${a.id}">‚¨ú</span>
                        ${a.icon} ${a.name}
                    </h4>
                    <div class="framework">${a.framework}</div>
                    <div class="tracker-input">
                        <input type="text" 
                               id="code-${a.id}" 
                               placeholder="${a.code}-..." 
                               onchange="validateCode('${a.id}')"
                               onkeyup="validateCode('${a.id}')">
                    </div>
                    <div class="parsed-result" id="result-${a.id}" style="display: none;"></div>
                </div>
            `).join('');
        }
        
        function renderInactiveAssessments() {
            const container = document.getElementById('inactiveAssessments');
            container.innerHTML = inactiveAssessments.map(a => `
                <div class="assessment-entry inactive">
                    <h4>${a.icon} ${a.name}<span class="inactive-label">Not in Course</span></h4>
                    <div class="framework">${a.framework}</div>
                </div>
            `).join('');
        }
        
        function validateCode(assessmentId) {
            const assessment = activeAssessments.find(a => a.id === assessmentId);
            const input = document.getElementById(`code-${assessmentId}`);
            const resultDiv = document.getElementById(`result-${assessmentId}`);
            const statusIcon = document.getElementById(`status-${assessmentId}`);
            const entryDiv = document.getElementById(`entry-${assessmentId}`);
            const code = input.value.trim().toUpperCase();
            
            if (!code) {
                input.className = '';
                resultDiv.style.display = 'none';
                statusIcon.textContent = '‚¨ú';
                entryDiv.classList.remove('completed');
                delete parsedResults[assessmentId];
                updateAnalysis();
                saveProgress();
                return;
            }
            
            // Check if code starts with correct prefix
            if (!code.startsWith(assessment.code + '-')) {
                input.className = 'invalid';
                resultDiv.style.display = 'none';
                statusIcon.textContent = '‚ùå';
                entryDiv.classList.remove('completed');
                delete parsedResults[assessmentId];
                updateAnalysis();
                return;
            }
            
            // Try to parse the code
            const parsed = assessment.parser(code);
            
            if (parsed) {
                input.className = 'valid';
                statusIcon.textContent = '‚úÖ';
                entryDiv.classList.add('completed');
                parsedResults[assessmentId] = { ...parsed, assessment: assessment.name, icon: assessment.icon };
                
                // Display parsed result
                let resultHTML = `<span class="primary">${parsed.primary || 'N/A'}</span>`;
                if (parsed.secondary) resultHTML += ` / ${parsed.secondary}`;
                if (parsed.level) resultHTML += ` ‚Ä¢ <span class="score">${parsed.level}</span>`;
                if (parsed.score) resultHTML += ` ‚Ä¢ Score: <span class="score">${parsed.score}${parsed.metric ? ' ' + parsed.metric : ''}</span>`;
                resultDiv.innerHTML = resultHTML;
                resultDiv.style.display = 'block';
                
                updateAnalysis();
                saveProgress();
            } else {
                input.className = 'invalid';
                resultDiv.style.display = 'none';
                statusIcon.textContent = '‚ùå';
                entryDiv.classList.remove('completed');
                delete parsedResults[assessmentId];
                updateAnalysis();
            }
        }
        
        function updateAnalysis() {
            const completedCount = Object.keys(parsedResults).length;
            document.getElementById('completedCount').textContent = completedCount;
            document.getElementById('progressPct').textContent = Math.round((completedCount / 22) * 100) + '%';
            
            if (completedCount === 0) {
                document.getElementById('noDataMsg').style.display = 'block';
                document.getElementById('analysisResults').style.display = 'none';
                document.getElementById('analysisBadge').textContent = 'Enter codes above';
                document.getElementById('overallStrength').textContent = '--';
                return;
            }
            
            document.getElementById('noDataMsg').style.display = 'none';
            document.getElementById('analysisResults').style.display = 'block';
            document.getElementById('analysisBadge').textContent = completedCount + ' Analyzed';
            
            // Generate comprehensive analysis
            generateAnalysis();
        }
        
        function generateDeepProfileSection(results) {
            const p = parsedResults;
            let deepProfiles = [];
            
            // Get deep profile data for key assessments
            if (p.leadership && deepProfileData.leadership && deepProfileData.leadership[p.leadership.primary]) {
                const profile = deepProfileData.leadership[p.leadership.primary];
                deepProfiles.push({
                    title: 'üëë Leadership Deep Profile',
                    type: p.leadership.primary,
                    ...profile
                });
            }
            
            if (p.conflict && deepProfileData.conflict && deepProfileData.conflict[p.conflict.primary]) {
                const profile = deepProfileData.conflict[p.conflict.primary];
                deepProfiles.push({
                    title: '‚öîÔ∏è Conflict Management Profile',
                    type: p.conflict.primary,
                    ...profile
                });
            }
            
            if (p.motivation && deepProfileData.motivation && deepProfileData.motivation[p.motivation.primary]) {
                const profile = deepProfileData.motivation[p.motivation.primary];
                deepProfiles.push({
                    title: 'üî• Motivation Profile',
                    type: p.motivation.primary,
                    ...profile
                });
            }
            
            if (deepProfiles.length === 0) {
                return '';
            }
            
            return `
                <div class="insights-section" style="margin-top: 25px; background: linear-gradient(135deg, #f0f4f8, #e8edf5); border-color: var(--chapman-blue);">
                    <h3 style="color: var(--chapman-blue);">üî¨ Deep Profile Analysis</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 0.9em;">
                        Detailed behavioral insights based on your primary assessment results
                    </p>
                    ${deepProfiles.map(profile => `
                        <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 15px; border-left: 4px solid var(--chapman-blue);">
                            <h4 style="color: var(--chapman-blue); margin-bottom: 15px;">${profile.title}: ${profile.type}</h4>
                            
                            <div style="margin-bottom: 12px;">
                                <strong style="color: var(--chapman-blue);">üìã Profile Summary</strong>
                                <p style="font-size: 0.9em; color: var(--text-secondary); margin-top: 4px;">${profile.profileSummary}</p>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 12px;">
                                <div style="background: var(--blue-light); padding: 12px; border-radius: 8px;">
                                    <strong style="color: var(--chapman-blue); font-size: 0.85em;">üéØ Decision Style</strong>
                                    <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 4px;">${profile.decisionStyle}</p>
                                </div>
                                <div style="background: var(--blue-light); padding: 12px; border-radius: 8px;">
                                    <strong style="color: var(--chapman-blue); font-size: 0.85em;">üí¨ Communication Style</strong>
                                    <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 4px;">${profile.communicationStyle}</p>
                                </div>
                                <div style="background: var(--blue-light); padding: 12px; border-radius: 8px;">
                                    <strong style="color: var(--chapman-blue); font-size: 0.85em;">‚ö° Motivated By</strong>
                                    <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 4px;">${profile.motivatedBy}</p>
                                </div>
                                <div style="background: #fff3e0; padding: 12px; border-radius: 8px;">
                                    <strong style="color: var(--orange); font-size: 0.85em;">üò∞ Under Stress</strong>
                                    <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 4px;">${profile.stressResponse}</p>
                                </div>
                                <div style="background: #ffebee; padding: 12px; border-radius: 8px;">
                                    <strong style="color: var(--red); font-size: 0.85em;">üëÅÔ∏è Blind Spots</strong>
                                    <p style="font-size: 0.85em; color: var(--text-secondary); margin-top: 4px;">${profile.blindSpots}</p>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        function generateAnalysis() {
            const results = Object.values(parsedResults);
            if (results.length === 0) return;
            
            // Collect all primary strengths
            const strengths = results.filter(r => r.primary).map(r => ({ trait: r.primary, source: r.assessment, icon: r.icon }));
            
            // Find most common themes
            const traitCounts = {};
            strengths.forEach(s => {
                traitCounts[s.trait] = (traitCounts[s.trait] || 0) + 1;
            });
            
            // Update top strength
            if (strengths.length > 0) {
                document.getElementById('overallStrength').textContent = strengths[0].trait.substring(0, 8) + '...';
            }
            
            // Generate SWOT
            const swot = generateSWOT(results);
            
            // Generate insights
            const insights = generateInsights(results);
            
            // Build analysis HTML
            const analysisHTML = `
                <div class="profile-grid">
                    <div class="profile-card">
                        <h4>üèÜ Your Primary Styles & Strengths</h4>
                        ${strengths.slice(0, 8).map(s => `
                            <div class="trait">
                                <span>${s.icon} ${s.source}</span>
                                <span class="value">${s.trait}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="profile-card">
                        <h4>üìä Assessment Scores</h4>
                        ${results.filter(r => r.score).slice(0, 8).map(r => `
                            <div class="trait">
                                <span>${r.icon} ${r.assessment}</span>
                                <span class="value">${r.score}${r.level ? ' (' + r.level + ')' : ''}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <h3 style="color: var(--chapman-blue); margin: 25px 0 15px;">üìà Combined SWOT Analysis</h3>
                <div class="swot-grid">
                    <div class="swot-box swot-strength">
                        <h4>üí™ Strengths</h4>
                        <ul>${swot.strengths.map(s => `<li>${s}</li>`).join('')}</ul>
                    </div>
                    <div class="swot-box swot-weakness">
                        <h4>üéØ Areas for Growth</h4>
                        <ul>${swot.weaknesses.map(w => `<li>${w}</li>`).join('')}</ul>
                    </div>
                    <div class="swot-box swot-opportunity">
                        <h4>üöÄ Opportunities</h4>
                        <ul>${swot.opportunities.map(o => `<li>${o}</li>`).join('')}</ul>
                    </div>
                    <div class="swot-box swot-threat">
                        <h4>‚ö†Ô∏è Watch Out For</h4>
                        <ul>${swot.threats.map(t => `<li>${t}</li>`).join('')}</ul>
                    </div>
                </div>
                
                <div class="insights-section">
                    <h3>üîÆ Deep Insights & Patterns</h3>
                    ${insights.map(i => `
                        <div class="insight-item">
                            <h5>${i.title}</h5>
                            <p>${i.description}</p>
                        </div>
                    `).join('')}
                </div>
                
                ${generateDeepProfileSection(results)}
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="generateComprehensiveReport()">üìÑ Download Full PDF Report</button>
                    <button class="btn btn-secondary" onclick="window.print()">üñ®Ô∏è Print Summary</button>
                </div>
            `;
            
            document.getElementById('analysisResults').innerHTML = analysisHTML;
        }
        
        // Comprehensive profile descriptions for rich insights
        const profileDescriptions = {
            leadership: {
                'Directing': {
                    strength: 'You excel at providing clear direction and structure, making decisive calls when teams need guidance, and establishing expectations that drive accountability.',
                    weakness: 'May be perceived as controlling or micromanaging; team members might feel their expertise is undervalued or their autonomy is limited.',
                    opportunity: 'Develop coaching skills to help team members grow while maintaining necessary structure. Learn to delegate more as trust builds.',
                    threat: 'High-performing team members may disengage if they feel over-supervised. In rapidly changing environments, top-down direction may slow response times.'
                },
                'Coaching': {
                    strength: 'You naturally invest in others\' development while maintaining focus on results. Your two-way communication style builds both competence and commitment.',
                    weakness: 'Coaching takes time; may struggle with urgent deadlines or when working with highly experienced team members who need less guidance.',
                    opportunity: 'Your developmental approach positions you well for mentorship roles. Consider formalizing your coaching through leadership development programs.',
                    threat: 'Fast-paced environments may not allow time for your preferred developmental approach. Some team members may resist being "coached."'
                },
                'Supporting': {
                    strength: 'You create psychologically safe environments where team members feel valued and heard. Your collaborative approach builds strong team cohesion and loyalty.',
                    weakness: 'May avoid necessary confrontation or difficult decisions. Teams may lack clear direction when facing ambiguous situations.',
                    opportunity: 'Your supportive style is highly valued in knowledge work environments. Develop strategic assertiveness for situations requiring decisive leadership.',
                    threat: 'May be perceived as indecisive or lacking conviction. In crisis situations, teams may need more directive leadership than you naturally provide.'
                },
                'Delegating': {
                    strength: 'You empower others by trusting their expertise and giving them autonomy. This approach develops leadership capabilities in your team members.',
                    weakness: 'Less experienced team members may flounder without guidance. May appear disengaged or uninvested in outcomes.',
                    opportunity: 'Your hands-off style works exceptionally well with senior talent. Focus on creating systems for accountability without micromanagement.',
                    threat: 'Quality may suffer if team members are not ready for full autonomy. Accountability gaps may develop without proper monitoring systems.'
                }
            },
            conflict: {
                'Competing': {
                    strength: 'You stand firm on important issues and protect critical interests when stakes are high. Your assertiveness ensures your perspective is heard.',
                    weakness: 'Win-lose approach may damage relationships and create resentment. Others may avoid sharing concerns or problems with you.',
                    opportunity: 'Channel competitive drive into collaborative problem-solving. Your assertiveness is valuable when advocating for ethical standards.',
                    threat: 'Reputation as combative may limit collaborative opportunities. In diverse teams, dominance behaviors may create exclusion.'
                },
                'Collaborating': {
                    strength: 'You naturally seek win-win solutions that address everyone\'s concerns. Your integrative approach often produces creative, higher-quality outcomes.',
                    weakness: 'Collaboration is time-intensive and not always practical. May over-invest in minor issues that don\'t warrant extensive problem-solving.',
                    opportunity: 'Your collaborative skills are increasingly valuable in cross-functional, diverse work environments. Consider roles in facilitation or mediation.',
                    threat: 'Others may exploit your collaborative nature. In competitive environments, pure collaboration may put you at a disadvantage.'
                },
                'Compromising': {
                    strength: 'You efficiently find middle ground that allows all parties to move forward. Your practical approach keeps relationships intact while making progress.',
                    weakness: 'Split-the-difference solutions may satisfy no one fully. Important principles may be sacrificed for expediency.',
                    opportunity: 'Your pragmatism is valuable in time-pressured negotiations. Develop skills to identify when compromise versus collaboration is appropriate.',
                    threat: 'May leave underlying issues unresolved, leading to recurring conflicts. Sophisticated negotiators may take advantage of your tendency to meet in the middle.'
                },
                'Avoiding': {
                    strength: 'You choose your battles wisely and don\'t escalate minor disagreements. This discretion preserves relationships and maintains team harmony.',
                    weakness: 'Unaddressed issues tend to grow. Others may feel their concerns are dismissed or that important conversations aren\'t happening.',
                    opportunity: 'Develop comfort with productive conflict. Practice framing disagreements as collaborative problem-solving rather than confrontation.',
                    threat: 'Avoided conflicts often resurface at worse times. Credibility may suffer if you\'re perceived as unwilling to address difficult issues.'
                },
                'Accommodating': {
                    strength: 'You maintain important relationships by recognizing when others\' needs should take priority. Your flexibility creates goodwill and cooperation.',
                    weakness: 'Your own needs and ideas may be consistently underrepresented. Others may take your accommodation for granted.',
                    opportunity: 'Your relationship-first approach is valuable for building coalitions. Learn to advocate more strongly when your expertise is needed.',
                    threat: 'Pattern of accommodation may lead to resentment or burnout. May be overlooked for leadership roles if perceived as lacking conviction.'
                }
            },
            motivation: {
                'Achievement': {
                    strength: 'You are driven by excellence, mastery, and accomplishment. This internal motivation makes you a high performer who consistently raises the bar.',
                    weakness: 'May take on too much personally, struggle to delegate, or become frustrated with "good enough." Can be perceived as overly competitive.',
                    opportunity: 'Seek roles with clear metrics and advancement paths. Your drive positions you well for entrepreneurial or high-performance environments.',
                    threat: 'Risk of burnout from relentless pursuit of goals. In collaborative cultures, individual achievement focus may create tension.'
                },
                'Affiliation': {
                    strength: 'You build strong relationships and create cohesive teams. Your focus on connection makes you effective at collaboration and maintaining morale.',
                    weakness: 'May avoid necessary confrontation to preserve relationships. Decision-making may be influenced by desire for approval rather than optimal outcomes.',
                    opportunity: 'Your relationship orientation is invaluable for networking, team leadership, and roles requiring stakeholder management.',
                    threat: 'May struggle in competitive or isolated roles. Difficult decisions that affect relationships may cause significant stress.'
                },
                'Power': {
                    strength: 'You are driven to make an impact and influence outcomes. This motivation makes you effective at driving change and taking on leadership responsibilities.',
                    weakness: 'May be perceived as political or self-serving. Can dominate discussions or overlook input from others.',
                    opportunity: 'Channel power motivation toward empowering others and championing important causes. Your influence drive is essential for organizational leadership.',
                    threat: 'Without ethical grounding, power motivation can lead to poor decisions. May alienate colleagues who feel overshadowed.'
                }
            },
            personality: {
                'Director': {
                    strength: 'You are results-oriented and decisive, excelling at setting clear goals and holding people accountable. Your direct approach cuts through ambiguity.',
                    weakness: 'May overlook people dynamics in pursuit of results. Directness can be perceived as abrasive or intimidating.',
                    opportunity: 'Your task focus is valuable in turnaround situations. Develop emotional intelligence to balance results with relationships.',
                    threat: 'May drive away talented team members who need more support. In relationship-intensive roles, your directness may backfire.'
                },
                'Innovator': {
                    strength: 'You thrive on generating new ideas and finding creative solutions to complex problems. Your innovative thinking drives competitive advantage.',
                    weakness: 'May struggle with implementation and follow-through. Can become frustrated with routine tasks or resistance to new ideas.',
                    opportunity: 'Seek roles in strategy, R&D, or transformation initiatives. Your creativity is increasingly valued in disrupted industries.',
                    threat: 'Innovation without execution creates frustration. May be perceived as impractical or unable to deliver on ideas.'
                },
                'Visionary': {
                    strength: 'You see the big picture and inspire others with compelling visions of the future. Your strategic perspective helps organizations navigate change.',
                    weakness: 'May overlook important details or lose patience with operational realities. Others may struggle to translate vision into action.',
                    opportunity: 'Your ability to articulate future direction is rare and valuable. Partner with execution-oriented colleagues to bring visions to life.',
                    threat: 'Visionary leaders need followers; may struggle if unable to connect with pragmatic concerns of team members.'
                },
                'Developer': {
                    strength: 'You invest in growing others and building strong teams. Your people-first approach creates loyal, capable organizations.',
                    weakness: 'May prioritize development over performance in situations requiring immediate results. Can struggle with accountability conversations.',
                    opportunity: 'Your developmental focus is essential for succession planning and building organizational capability. Consider HR leadership or executive coaching.',
                    threat: 'In performance-driven cultures, developmental patience may be seen as lack of urgency.'
                }
            },
            ethics: {
                'Consequentialist': {
                    strength: 'You evaluate decisions based on outcomes and impact, making you skilled at utilitarian analysis and considering stakeholder effects comprehensively.',
                    weakness: 'May rationalize questionable means if ends seem beneficial. Can struggle when outcomes are uncertain or unmeasurable.',
                    opportunity: 'Your outcome-orientation is valuable in business strategy. Develop deontological guardrails to protect against "ends justify means" reasoning.',
                    threat: 'Purely consequentialist thinking can lead to ethical blind spots. Others may question your commitment to principles.'
                },
                'Deontologist': {
                    strength: 'You maintain strong principles and consistent ethical standards regardless of circumstances. This reliability builds trust and organizational integrity.',
                    weakness: 'May appear inflexible when context suggests exceptions. Can struggle when duties conflict with each other.',
                    opportunity: 'Your principled approach is valuable in compliance, governance, and roles requiring ethical leadership. You can be trusted to uphold standards.',
                    threat: 'Rigid rule-following may miss the spirit of ethics in novel situations. May conflict with pragmatic colleagues.'
                },
                'Virtue Ethicist': {
                    strength: 'You focus on character and ask "what would a person of integrity do?" This approach builds ethical culture and inspires others through example.',
                    weakness: 'Virtue guidance can be ambiguous in complex situations. May lack clear decision frameworks when virtues conflict.',
                    opportunity: 'Your character-based approach is powerful for leadership development and culture-building. Model the virtues you want to see.',
                    threat: 'Without clear frameworks, virtue ethics may produce inconsistent decisions. May struggle to articulate reasoning to analytically-minded colleagues.'
                },
                'Care Ethicist': {
                    strength: 'You consider relationships and responsibilities to specific people in ethical decisions. This produces contextually appropriate, compassionate responses.',
                    weakness: 'May show favoritism or inconsistency across relationships. Can struggle with decisions affecting strangers equally.',
                    opportunity: 'Your relational focus is valuable in stakeholder management and team leadership. Extend care principles to broader communities.',
                    threat: 'Care-based decisions may be perceived as biased. May struggle with policies requiring equal treatment regardless of relationship.'
                }
            },
            teamplayer: {
                'Contributor': {
                    strength: 'You provide reliable, high-quality technical expertise that teams depend on. Your task focus ensures deliverables meet standards.',
                    weakness: 'May undervalue interpersonal dynamics or relationship-building. Can become isolated from team processes while focused on your work.',
                    opportunity: 'Your expertise is foundational to team success. Develop facilitation skills to share knowledge more broadly.',
                    threat: 'Purely task-focused contribution may limit leadership opportunities. Teams may not recognize your contributions if you\'re not engaged in collaborative processes.'
                },
                'Collaborator': {
                    strength: 'You keep teams focused on shared goals and big-picture outcomes. Your integrative thinking helps align individual efforts toward collective success.',
                    weakness: 'May overlook important details in pursuit of overall direction. Can become frustrated with team members focused on narrower concerns.',
                    opportunity: 'Your goal-orientation positions you for project leadership and cross-functional coordination roles.',
                    threat: 'May be perceived as insufficiently detail-oriented. Team members may feel their specific concerns are dismissed.'
                },
                'Communicator': {
                    strength: 'You build consensus and maintain positive team dynamics. Your process awareness ensures all voices are heard and decisions have buy-in.',
                    weakness: 'Focus on process may slow decisions. May avoid necessary task-focus in favor of relationship maintenance.',
                    opportunity: 'Your communication skills are essential for diverse, distributed teams. Consider facilitation or change management roles.',
                    threat: 'May be seen as more concerned with feelings than results. In fast-paced environments, consensus-building may be impractical.'
                },
                'Challenger': {
                    strength: 'You push teams to question assumptions and consider alternatives. Your willingness to disagree prevents groupthink and improves decision quality.',
                    weakness: 'Challenging without building relationships can create defensiveness. May be perceived as negative or obstructionist.',
                    opportunity: 'Your critical thinking is valuable in strategy and risk management. Learn to challenge in ways that feel collaborative rather than adversarial.',
                    threat: 'Reputation as contrarian may reduce influence. Teams may stop inviting your input to avoid conflict.'
                }
            },
            learning: {
                'Diverging': {
                    strength: 'You excel at viewing situations from multiple perspectives and generating creative ideas. Brainstorming and imaginative exploration come naturally.',
                    weakness: 'May struggle to move from idea generation to decision and action. Can be overwhelmed by too many possibilities.',
                    opportunity: 'Your creative thinking is valuable in design, marketing, and innovation roles. Pair with Converging types for implementation.',
                    threat: 'In action-oriented environments, reflective ideation may be seen as indecisive or impractical.'
                },
                'Assimilating': {
                    strength: 'You synthesize diverse information into coherent theories and models. Your logical, organized approach produces clear frameworks.',
                    weakness: 'May over-analyze at the expense of action. Can dismiss practical experience that doesn\'t fit theoretical models.',
                    opportunity: 'Your analytical skills suit research, strategy, and planning roles. Ensure theories are tested against real-world results.',
                    threat: 'Pure analysis without action may limit impact. Colleagues may find theoretical focus disconnected from practical concerns.'
                },
                'Converging': {
                    strength: 'You find practical applications for ideas and solve problems efficiently. Your focus on "what works" produces results.',
                    weakness: 'May rush to solutions without adequate exploration. Can dismiss creative alternatives that seem impractical.',
                    opportunity: 'Your practical focus is valuable in technical, engineering, and operations roles. You translate ideas into reality.',
                    threat: 'Narrow focus on solutions may miss important context or alternative approaches. May undervalue ideation and reflection.'
                },
                'Accommodating': {
                    strength: 'You learn by doing and adapt quickly based on experience. Your hands-on approach and comfort with risk enables rapid experimentation.',
                    weakness: 'May act before adequately planning or analyzing. Can rely too heavily on gut feeling over systematic thinking.',
                    opportunity: 'Your action-orientation suits entrepreneurial, sales, and fast-paced roles. Balance intuition with reflection for continuous improvement.',
                    threat: 'Trial-and-error learning may be costly in high-stakes situations. Analytical colleagues may question your "leap first" approach.'
                }
            },
            communication: {
                'Analytical': {
                    strength: 'You communicate with precision, data, and logical structure. Your detailed approach builds credibility and ensures nothing important is missed.',
                    weakness: 'May overwhelm others with too much detail. Can appear cold or impersonal when emotional connection is needed.',
                    opportunity: 'Your thoroughness is valued in technical, legal, and financial communications. Develop skills to adapt depth for different audiences.',
                    threat: 'May lose audience attention with excessive detail. Relationships may suffer if emotional needs are consistently unaddressed.'
                },
                'Intuitive': {
                    strength: 'You communicate the big picture effectively and cut through complexity to core issues. Your direct approach saves time and maintains focus.',
                    weakness: 'May skip important details that others need. Can appear dismissive of thorough analysis.',
                    opportunity: 'Your executive communication style positions you well for leadership presentations. Pair with Analytical types for comprehensive coverage.',
                    threat: 'Missing details can lead to implementation failures. Some stakeholders may feel their concerns are glossed over.'
                },
                'Functional': {
                    strength: 'You communicate with clear process, steps, and timelines. Your organized approach ensures nothing falls through the cracks.',
                    weakness: 'Step-by-step detail may frustrate those wanting the bottom line first. Can appear rigid when flexibility is needed.',
                    opportunity: 'Your systematic communication excels in project management and operations. Develop skills to lead with conclusions when appropriate.',
                    threat: 'May be perceived as bureaucratic. Fast-paced environments may not allow for your preferred methodical approach.'
                },
                'Personal': {
                    strength: 'You communicate with warmth and emotional intelligence. Your relational approach builds trust and psychological safety.',
                    weakness: 'May prioritize relationship over content clarity. Can struggle to deliver difficult messages directly.',
                    opportunity: 'Your connecting style is essential for team leadership and stakeholder relationships. Develop assertiveness for difficult conversations.',
                    threat: 'May be perceived as lacking substance. Professional contexts may require more task-focused communication.'
                }
            },
            eq: {
                'Self-Awareness': {
                    strength: 'You accurately recognize your own emotions and their effects. This foundation enables authentic leadership and continuous growth.',
                    weakness: 'High self-awareness without action can become rumination. May over-analyze personal reactions.',
                    opportunity: 'Your self-insight positions you for coaching and mentoring roles. Use awareness as foundation for developing other EQ dimensions.',
                    threat: 'Self-focus without external awareness may miss important social cues. Can become overly self-critical.'
                },
                'Self-Regulation': {
                    strength: 'You manage disruptive emotions effectively and maintain composure under pressure. This creates stability for those around you.',
                    weakness: 'Excessive control may suppress authentic expression. Others may find you hard to read.',
                    opportunity: 'Your emotional steadiness is valuable in crisis leadership. Develop skills to strategically show vulnerability.',
                    threat: 'Suppressed emotions may build up over time. May be perceived as inauthentic or robotic.'
                },
                'Motivation': {
                    strength: 'You are driven by internal standards of excellence and persist despite obstacles. Your passion energizes teams.',
                    weakness: 'High internal drive may lead to burnout. May hold others to impossibly high standards.',
                    opportunity: 'Your drive positions you for challenging, high-impact roles. Learn to calibrate expectations for different contexts.',
                    threat: 'Relentless pursuit of excellence may damage relationships or health. May struggle with roles requiring patience.'
                },
                'Empathy': {
                    strength: 'You sense others\' emotions and perspectives accurately. This enables you to build deep connections and respond appropriately to needs.',
                    weakness: 'May absorb others\' emotions excessively. Can struggle with decisions that negatively affect individuals.',
                    opportunity: 'Your empathy is foundational for inclusive leadership and stakeholder management. Set boundaries to protect your energy.',
                    threat: 'Emotional absorption may lead to burnout. May avoid necessary difficult decisions that hurt individuals.'
                },
                'Social Skills': {
                    strength: 'You build rapport quickly and navigate social situations effectively. Your interpersonal savvy enables influence and collaboration.',
                    weakness: 'May prioritize social harmony over honest feedback. Can appear political or inauthentic.',
                    opportunity: 'Your social skills position you for networking, sales, and collaborative leadership. Ensure substance backs your style.',
                    threat: 'May be perceived as superficial or manipulative. Relationships built on charm alone may lack depth.'
                }
            },
            decision: {
                'Directive': {
                    strength: 'You make quick, efficient decisions with available information. Your action-orientation keeps things moving.',
                    weakness: 'May oversimplify complex issues. Can appear autocratic or dismissive of others\' input.',
                    opportunity: 'Your decisiveness is valuable in crisis and time-pressured situations. Develop skills to slow down for strategic decisions.',
                    threat: 'Rushed decisions may miss important factors. Team may disengage if consistently excluded from decisions.'
                },
                'Analytical': {
                    strength: 'You thoroughly analyze options and data before deciding. Your careful approach reduces errors and builds confidence in outcomes.',
                    weakness: 'Analysis paralysis can delay important decisions. May frustrate action-oriented colleagues.',
                    opportunity: 'Your rigor is valuable for high-stakes, complex decisions. Learn to identify when "good enough" information is sufficient.',
                    threat: 'Competitors may out-pace you while you analyze. Team may lose momentum waiting for perfect information.'
                },
                'Conceptual': {
                    strength: 'You consider broad context, creative options, and long-term implications. Your big-picture thinking produces innovative solutions.',
                    weakness: 'May overlook practical constraints or implementation details. Can become lost in possibilities.',
                    opportunity: 'Your strategic thinking is valuable for vision-setting and innovation. Partner with implementers for execution.',
                    threat: 'Ideas without execution build frustration. May lose credibility if concepts consistently fail to materialize.'
                },
                'Behavioral': {
                    strength: 'You consider people impact and seek consensus in decisions. Your inclusive approach builds buy-in and team commitment.',
                    weakness: 'Consensus-seeking can slow decisions and produce watered-down outcomes. May avoid necessary unpopular choices.',
                    opportunity: 'Your people-focus is valuable for change management and team leadership. Develop comfort with unilateral decisions when needed.',
                    threat: 'Pleasing everyone may please no one. Leadership opportunities may require decisions some will oppose.'
                }
            },
            stress: {
                'Problem-Focused': {
                    strength: 'You address stressors directly by taking action to change the situation. This proactive approach often resolves issues efficiently.',
                    weakness: 'May struggle when stressors are outside your control. Can become frustrated when problems persist despite effort.',
                    opportunity: 'Your action-orientation is valuable in crisis management. Develop acceptance skills for uncontrollable situations.',
                    threat: 'Trying to fix unfixable problems creates exhaustion. May neglect emotional needs while problem-solving.'
                },
                'Emotion-Focused': {
                    strength: 'You manage stress by regulating your emotional response, enabling resilience when situations cannot be changed.',
                    weakness: 'May process emotions without addressing root causes. Can appear to avoid problems.',
                    opportunity: 'Your emotional regulation supports long-term resilience. Balance with problem-focused strategies when action is possible.',
                    threat: 'Unaddressed problems may grow. Colleagues may perceive emotional coping as avoidance.'
                },
                'Support-Seeking': {
                    strength: 'You manage stress by connecting with others, sharing burdens and gaining perspective.',
                    weakness: 'May become overly dependent on others. Can transfer stress to your support network.',
                    opportunity: 'Your relational coping builds strong support systems. Develop self-soothing skills for independent resilience.',
                    threat: 'Support network may become depleted. May struggle when isolated or when others are unavailable.'
                },
                'Avoidant': {
                    strength: 'You create distance from stressors, which can provide short-term relief and prevent overreaction.',
                    weakness: 'Avoided problems typically grow. May miss opportunities to address issues when they are manageable.',
                    opportunity: 'Develop active coping strategies while maintaining your ability to detach strategically.',
                    threat: 'Chronic avoidance creates larger problems. May be perceived as disengaged or unreliable under pressure.'
                }
            },
            change: {
                'Change Champion': {
                    strength: 'You embrace change enthusiastically and help others see possibilities in new situations.',
                    weakness: 'May underestimate others\' need for stability. Can move too fast for teams to follow.',
                    opportunity: 'Your change-positive orientation is invaluable in transformation initiatives. Learn to pace change for organizational readiness.',
                    threat: 'Constant change enthusiasm may exhaust teams. May be seen as dismissive of legitimate concerns.'
                },
                'Change Adapter': {
                    strength: 'You adapt to change effectively once you understand the rationale and have time to process.',
                    weakness: 'May appear slow to embrace new directions initially. Can seem skeptical of change.',
                    opportunity: 'Your thoughtful adaptation models healthy change acceptance. Help others process change at appropriate pace.',
                    threat: 'In fast-changing environments, processing time may not be available. May be left behind by rapid changes.'
                },
                'Change Skeptic': {
                    strength: 'You question change carefully, identifying potential problems and ensuring changes are worthwhile.',
                    weakness: 'May appear resistant or negative. Can slow necessary changes with excessive questioning.',
                    opportunity: 'Your critical eye is valuable for risk assessment. Frame questions constructively to maintain influence.',
                    threat: 'May be excluded from change planning. Reputation as blocker may limit career opportunities.'
                },
                'Change Resistant': {
                    strength: 'You maintain stability and protect against unnecessary disruption.',
                    weakness: 'May resist even beneficial changes. Can become isolated in changing environments.',
                    opportunity: 'Identify what specifically triggers resistance and address underlying concerns. Seek smaller changes to build comfort.',
                    threat: 'Resistance to change may limit career options. Organizations may move forward without you.'
                }
            },
            influence: {
                'Rationalizing': {
                    strength: 'You influence through logic, data, and well-structured arguments. Your evidence-based approach builds credibility.',
                    weakness: 'May neglect emotional and relational aspects of influence. Can appear cold or lecturing.',
                    opportunity: 'Your analytical influence is powerful with technical audiences. Develop emotional appeals to broaden influence.',
                    threat: 'Logic alone rarely changes minds. May lose to less rational but more emotionally compelling appeals.'
                },
                'Asserting': {
                    strength: 'You influence through direct, confident advocacy of your position. Your clarity makes expectations unambiguous.',
                    weakness: 'May appear aggressive or dominating. Can shut down dialogue and creative alternatives.',
                    opportunity: 'Your assertiveness is valuable in urgent situations. Develop collaborative influence for relationship-intensive contexts.',
                    threat: 'Assertive influence may create resistance and resentment. May win battles but lose wars.'
                },
                'Negotiating': {
                    strength: 'You influence through give-and-take, finding trades that create value for all parties.',
                    weakness: 'May appear transactional or political. Can miss opportunities for collaborative win-wins.',
                    opportunity: 'Your deal-making skills are valuable in complex stakeholder situations. Ensure trades align with values.',
                    threat: 'Pure negotiation may erode trust. Important relationships require more than fair trades.'
                },
                'Inspiring': {
                    strength: 'You influence through vision, values, and emotional connection. Your passion motivates others to action.',
                    weakness: 'Inspiration without substance can appear hollow. May neglect practical concerns.',
                    opportunity: 'Your inspirational influence is powerful for leadership and change. Ensure vision is backed by credible plans.',
                    threat: 'Failed promises damage credibility. Cynical audiences may dismiss emotional appeals.'
                },
                'Bridging': {
                    strength: 'You influence by building coalitions and connecting diverse stakeholders around shared interests.',
                    weakness: 'Coalition building is slow. May appear indecisive while building consensus.',
                    opportunity: 'Your bridging skills are essential in matrixed, diverse organizations. Develop direct influence for urgent situations.',
                    threat: 'Coalitions can collapse. May lose to those with stronger individual influence.'
                }
            },
            grit: {
                'High Passion': {
                    strength: 'Your deep, enduring interest in your goals provides sustained motivation that outlasts temporary enthusiasm.',
                    weakness: 'May become too narrowly focused. Can miss valuable adjacent opportunities.',
                    opportunity: 'Channel passion toward goals worthy of long-term commitment. Let passion guide career choices.',
                    threat: 'If passion fades, may lose motivation entirely. Single-minded focus may create blind spots.'
                },
                'High Perseverance': {
                    strength: 'You persist through setbacks, maintaining effort even when progress is slow or obstacles mount.',
                    weakness: 'May persist on wrong paths. Can become stubborn when flexibility is needed.',
                    opportunity: 'Your perseverance is valuable for ambitious, long-term goals. Develop discernment about when to persist versus pivot.',
                    threat: 'Persisting on dead ends wastes resources. May miss signs that a different approach is needed.'
                },
                'Balanced Grit': {
                    strength: 'You combine enduring interest with sustained effort, the formula for achievement in challenging domains.',
                    weakness: 'High grit in wrong direction can be counterproductive. Need clear goals worthy of commitment.',
                    opportunity: 'Your grit predicts success in demanding fields. Choose goals that warrant your considerable perseverance.',
                    threat: 'Grit alone is not enough‚Äîdirection and adaptation also matter.'
                }
            },
            psych_safety: {
                'Speaking Up': {
                    strength: 'You are comfortable voicing opinions, questions, and concerns in group settings.',
                    weakness: 'Speaking up without skill can create conflict. May dominate discussions.',
                    opportunity: 'Use your voice to help others speak up too. Model constructive candor.',
                    threat: 'In psychologically unsafe cultures, speaking up may create backlash.'
                },
                'Risk Taking': {
                    strength: 'You are willing to propose ideas, take initiative, and experiment even with risk of failure.',
                    weakness: 'Risk tolerance without judgment can be reckless. May underestimate downside.',
                    opportunity: 'Your willingness to take risks enables innovation. Help create safety for others to take smart risks.',
                    threat: 'In blame-oriented cultures, risk-taking may backfire. Protect against excessive exposure.'
                },
                'Learning from Mistakes': {
                    strength: 'You approach failures as learning opportunities rather than sources of shame.',
                    weakness: 'Learning orientation without accountability can enable repeat mistakes.',
                    opportunity: 'Model growth mindset and help teams build learning cultures. Extract maximum value from setbacks.',
                    threat: 'Some environments punish failure regardless of learning. Understand cultural context.'
                },
                'Inclusion': {
                    strength: 'You value diverse perspectives and create space for different voices.',
                    weakness: 'Inclusion without direction can slow decisions. May struggle to move forward with disagreement.',
                    opportunity: 'Your inclusive orientation builds diverse, innovative teams. Develop skills to integrate diverse input into decisions.',
                    threat: 'Inclusion efforts may be perceived as tokenism if not genuine.'
                }
            },
            systems: {
                'Holistic Thinking': {
                    strength: 'You see whole systems rather than isolated parts, understanding how components interact.',
                    weakness: 'May struggle with detail-level execution. Can appear to lack focus.',
                    opportunity: 'Your systems view is valuable for strategy and organizational design. Partner with detail-oriented implementers.',
                    threat: 'Big-picture thinking without execution may limit impact. Others may not see what you see.'
                },
                'Pattern Recognition': {
                    strength: 'You identify recurring dynamics and underlying structures that others miss.',
                    weakness: 'May see patterns that are not there. Can overcomplicate straightforward situations.',
                    opportunity: 'Your pattern recognition enables diagnosis and prediction. Validate patterns with data.',
                    threat: 'Overconfident pattern matching can mislead. Test mental models against reality.'
                },
                'Dynamic Thinking': {
                    strength: 'You understand how systems evolve over time and anticipate downstream effects.',
                    weakness: 'May over-emphasize long-term at expense of immediate needs. Can appear abstract.',
                    opportunity: 'Your temporal awareness prevents short-term thinking traps. Help others see time horizons.',
                    threat: 'Organizations often reward short-term results. Long-term thinking may not be valued.'
                },
                'Leverage Points': {
                    strength: 'You identify high-impact intervention points where small changes create big effects.',
                    weakness: 'May over-rely on clever solutions versus sustained effort. Can appear to seek shortcuts.',
                    opportunity: 'Your leverage thinking maximizes impact. Combine with persistent execution.',
                    threat: 'Leverage points are often counterintuitive. Others may resist non-obvious interventions.'
                }
            },
            strategic: {
                'Vision': {
                    strength: 'You create compelling pictures of the future that inspire and direct action.',
                    weakness: 'Vision without execution is fantasy. May neglect operational realities.',
                    opportunity: 'Your visionary capacity is essential for leadership. Partner with operators for implementation.',
                    threat: 'Failed visions damage credibility. Ensure visions are grounded in feasibility.'
                },
                'Analysis': {
                    strength: 'You thoroughly assess situations, options, and implications before committing.',
                    weakness: 'Analysis can become paralysis. May miss windows of opportunity.',
                    opportunity: 'Your analytical rigor prevents costly mistakes. Learn to act on incomplete information.',
                    threat: 'Perfect analysis is impossible. Competitors may act while you analyze.'
                },
                'Agility': {
                    strength: 'You adapt strategy quickly as conditions change, pivoting without losing momentum.',
                    weakness: 'Too much pivoting creates whiplash. May abandon strategies prematurely.',
                    opportunity: 'Your adaptability suits dynamic environments. Distinguish strategy pivots from tactical adjustments.',
                    threat: 'Constant changes may confuse teams. Need stability for execution.'
                },
                'Execution': {
                    strength: 'You translate strategy into disciplined action, ensuring plans become reality.',
                    weakness: 'Execution focus may miss need for strategy updates. Can become rigid.',
                    opportunity: 'Your execution capability is rare and valuable. Combine with strategic awareness.',
                    threat: 'Executing wrong strategy well is still failure. Stay connected to strategic context.'
                }
            },
            critical: {
                'Analysis': {
                    strength: 'You break down complex information into component parts for clear understanding.',
                    weakness: 'May get lost in analysis. Can miss synthesis and big-picture implications.',
                    opportunity: 'Your analytical skills suit research and problem diagnosis. Develop synthesis and recommendation skills.',
                    threat: 'Analysis without synthesis is incomplete. Others may not value detailed breakdowns.'
                },
                'Evaluation': {
                    strength: 'You assess arguments, evidence, and claims against clear criteria.',
                    weakness: 'Constant evaluation can appear overly critical. May discourage idea-sharing.',
                    opportunity: 'Your evaluation skills are valuable for quality assurance and decision-making. Frame feedback constructively.',
                    threat: 'Evaluative mindset may shut down creativity. Balance critique with encouragement.'
                },
                'Inference': {
                    strength: 'You draw sound conclusions from available evidence, even incomplete information.',
                    weakness: 'Inferences can be wrong. May overreach from limited data.',
                    opportunity: 'Your inferential reasoning enables prediction and planning. Validate inferences when possible.',
                    threat: 'Confident wrong inferences can mislead. Maintain appropriate uncertainty.'
                },
                'Open-Mindedness': {
                    strength: 'You consider alternative perspectives and change your mind based on evidence.',
                    weakness: 'May appear indecisive. Can struggle to commit when multiple views are valid.',
                    opportunity: 'Your open-mindedness enables learning and adaptation. Develop decision-making frameworks.',
                    threat: 'Open-mindedness without conclusion is inaction. At some point, commit and act.'
                }
            },
            entrepreneurial: {
                'Innovativeness': {
                    strength: 'You generate creative ideas and novel approaches to problems.',
                    weakness: 'Innovation without implementation is ideation. May lack follow-through.',
                    opportunity: 'Your innovative capacity is valuable in dynamic industries. Partner with executors.',
                    threat: 'Too many ideas without results damages credibility.'
                },
                'Proactiveness': {
                    strength: 'You anticipate future needs and act before being required to.',
                    weakness: 'Proactive action may jump the gun. Can create problems by acting too early.',
                    opportunity: 'Your anticipatory orientation creates competitive advantage. Validate timing with market signals.',
                    threat: 'Being too early is same as being wrong. Balance proactivity with market readiness.'
                },
                'Risk-Taking': {
                    strength: 'You are willing to commit resources to uncertain opportunities.',
                    weakness: 'Risk-taking without judgment is gambling. May underestimate downside.',
                    opportunity: 'Your risk tolerance enables entrepreneurial action. Develop risk assessment skills.',
                    threat: 'Failed risks deplete resources. Manage exposure carefully.'
                },
                'Autonomy': {
                    strength: 'You thrive with independence and self-direction.',
                    weakness: 'High autonomy needs may conflict with organizational norms. Can appear difficult to manage.',
                    opportunity: 'Seek roles with appropriate independence. Consider entrepreneurship.',
                    threat: 'Organizational roles may constrain autonomy needs. May struggle with corporate politics.'
                },
                'Competitive Aggressiveness': {
                    strength: 'You compete vigorously to win in market situations.',
                    weakness: 'Excessive competitiveness may damage relationships. Can create enemies.',
                    opportunity: 'Channel competitive drive into market success. Compete on value, not destruction.',
                    threat: 'Aggressive competition invites retaliation. Sustainable success requires some cooperation.'
                }
            },
            risk: {
                'Financial': {
                    strength: 'You are comfortable taking calculated financial risks for potential returns.',
                    weakness: 'High financial risk tolerance may expose you to significant losses.',
                    opportunity: 'Your financial risk tolerance suits entrepreneurship and investment. Develop risk assessment skills.',
                    threat: 'Financial losses can be catastrophic. Protect against tail risks.'
                },
                'Career': {
                    strength: 'You are willing to take career risks for growth opportunities.',
                    weakness: 'Career risks have real consequences. May underestimate downside.',
                    opportunity: 'Your career risk tolerance enables bold moves. Calculate carefully.',
                    threat: 'Failed career risks may be difficult to recover from. Have contingency plans.'
                },
                'Social': {
                    strength: 'You are comfortable risking social standing for authenticity or impact.',
                    weakness: 'Social risks can damage relationships and reputation.',
                    opportunity: 'Your willingness to stand out enables leadership. Be strategic about social risks.',
                    threat: 'Social capital, once lost, is hard to rebuild. Protect important relationships.'
                },
                'Physical': {
                    strength: 'You are comfortable with physical risks and challenges.',
                    weakness: 'Physical risk-taking can result in injury. May underestimate danger.',
                    opportunity: 'Your physical courage suits demanding roles. Manage risk exposure.',
                    threat: 'Physical consequences can be permanent. Value your health.'
                }
            },
            innovation: {
                'Curiosity': {
                    strength: 'You ask questions, explore possibilities, and seek to understand deeply.',
                    weakness: 'Curiosity without focus can scatter attention. May struggle to prioritize.',
                    opportunity: 'Your curiosity drives learning and discovery. Channel toward important questions.',
                    threat: 'Curiosity can lead to tangents. Maintain strategic focus.'
                },
                'Experimentation': {
                    strength: 'You test ideas through action, learning from results.',
                    weakness: 'Experimentation without analysis may repeat mistakes. Can appear unfocused.',
                    opportunity: 'Your experimental mindset enables innovation. Develop experimental design skills.',
                    threat: 'Failed experiments have costs. Manage experimental risk.'
                },
                'Resilience': {
                    strength: 'You bounce back from setbacks and persist through challenges.',
                    weakness: 'Resilience without adaptation may repeat ineffective approaches.',
                    opportunity: 'Your resilience enables long-term success. Combine with learning orientation.',
                    threat: 'Resilience should not become stubbornness. Know when to change course.'
                },
                'Collaboration': {
                    strength: 'You build on others\' ideas and combine perspectives for better solutions.',
                    weakness: 'Collaboration takes time. May struggle with independent work.',
                    opportunity: 'Your collaborative innovation creates synergies. Develop skills for rapid collaboration.',
                    threat: 'Dependence on others may limit solo contribution.'
                }
            },
            values: {
                'Achievement': {
                    strength: 'You are driven by accomplishment, mastery, and measurable success.',
                    weakness: 'Achievement focus may crowd out other values. Can become exhausting.',
                    opportunity: 'Pursue goals that align achievement with deeper meaning. Define success broadly.',
                    threat: 'Achievement without fulfillment is hollow. Question what success really means to you.'
                },
                'Relationship': {
                    strength: 'You prioritize connection, belonging, and meaningful relationships.',
                    weakness: 'Relationship focus may conflict with task demands. Can struggle with difficult decisions affecting people.',
                    opportunity: 'Build your life around quality relationships. Let connections guide career choices.',
                    threat: 'Over-dependence on others may limit independence. Maintain healthy boundaries.'
                },
                'Growth': {
                    strength: 'You are driven by learning, development, and self-improvement.',
                    weakness: 'Growth focus may create chronic dissatisfaction with present. Can become restless.',
                    opportunity: 'Pursue roles with continuous learning. Never stop developing.',
                    threat: 'Growth obsession may prevent appreciation of current achievements.'
                },
                'Service': {
                    strength: 'You are motivated by helping others and making a positive difference.',
                    weakness: 'Service focus may lead to self-neglect. Can enable others\' dependency.',
                    opportunity: 'Pursue work with clear positive impact. Let service orientation guide career.',
                    threat: 'Giving without receiving leads to depletion. Practice self-care.'
                },
                'Integrity': {
                    strength: 'You prioritize honesty, consistency, and alignment between values and actions.',
                    weakness: 'Rigid integrity may conflict with pragmatic demands. Can appear inflexible.',
                    opportunity: 'Your integrity builds trust and reputation. Protect it fiercely.',
                    threat: 'Ethical environments are not guaranteed. May face difficult integrity tests.'
                },
                'Freedom': {
                    strength: 'You value autonomy, independence, and self-determination.',
                    weakness: 'Freedom focus may conflict with organizational commitments. Can appear unreliable.',
                    opportunity: 'Structure life and career to maximize autonomy. Consider entrepreneurship.',
                    threat: 'Freedom has costs. Total independence may limit opportunities.'
                },
                'Security': {
                    strength: 'You value stability, predictability, and protection from risk.',
                    weakness: 'Security focus may prevent necessary risks. Can limit growth.',
                    opportunity: 'Build security foundations that enable calculated risk-taking.',
                    threat: 'Excessive security seeking may create stagnation.'
                }
            }
        };

        // Extended deep profile data for rich insights
        const deepProfileData = {
            leadership: {
                'Directing': {
                    profileSummary: 'You provide clear structure and decisive guidance. Your task-focused approach ensures teams know exactly what is expected and when.',
                    decisionStyle: 'Quick and decisive. You prefer to make calls based on available information rather than waiting for perfect data.',
                    communicationStyle: 'Direct and instruction-oriented. You communicate clear expectations and specific feedback.',
                    motivatedBy: 'Results, efficiency, and seeing tasks completed successfully.',
                    stressResponse: 'Under pressure, you may become more controlling and less patient with questions or delays.',
                    blindSpots: 'May miss team morale issues or individual development needs when focused on task completion.'
                },
                'Coaching': {
                    profileSummary: 'You invest in developing others while maintaining focus on results. Your approach builds both competence and confidence.',
                    decisionStyle: 'Collaborative with guidance. You include others in decisions while providing structure and direction.',
                    communicationStyle: 'Two-way and developmental. You combine direction with dialogue to build understanding.',
                    motivatedBy: 'Seeing others grow and succeed, building capability while achieving results.',
                    stressResponse: 'Under pressure, you may revert to more directive behaviors or become frustrated with slow learners.',
                    blindSpots: 'May over-invest in development when simple direction would be more efficient.'
                },
                'Supporting': {
                    profileSummary: 'You create safe, collaborative environments where team members feel valued and heard.',
                    decisionStyle: 'Facilitative and inclusive. You prefer decisions that emerge from team consensus.',
                    communicationStyle: 'Empathetic and encouraging. You listen actively and validate others\' contributions.',
                    motivatedBy: 'Team harmony, collaboration, and creating positive work environments.',
                    stressResponse: 'Under pressure, you may avoid necessary confrontation or delay difficult decisions.',
                    blindSpots: 'May prioritize harmony over performance, or miss when team members need more direction.'
                },
                'Delegating': {
                    profileSummary: 'You empower others through trust and autonomy, enabling them to develop leadership capabilities.',
                    decisionStyle: 'Hands-off. You delegate decision authority to those closest to the work.',
                    communicationStyle: 'Minimal and strategic. You communicate goals and trust others to determine how.',
                    motivatedBy: 'Others\' independence and self-sufficiency, building the next generation of leaders.',
                    stressResponse: 'Under pressure, you may disengage further or become frustrated when required to intervene.',
                    blindSpots: 'May miss when team members need more guidance or when accountability gaps emerge.'
                }
            },
            conflict: {
                'Competing': {
                    profileSummary: 'You advocate strongly for your position and protect important interests when stakes are high.',
                    decisionStyle: 'Decisive and position-driven. You prefer clear outcomes over prolonged negotiation.',
                    communicationStyle: 'Assertive and direct. You state your position clearly and defend it vigorously.',
                    motivatedBy: 'Winning, protecting important interests, and achieving your goals.',
                    stressResponse: 'Under pressure, you may become more aggressive or dismiss opposing viewpoints.',
                    blindSpots: 'May damage relationships or miss creative solutions while focused on winning.'
                },
                'Collaborating': {
                    profileSummary: 'You seek win-win solutions that fully address all parties\' concerns.',
                    decisionStyle: 'Integrative and thorough. You invest time to find solutions that satisfy everyone.',
                    communicationStyle: 'Open and exploratory. You ask questions to understand underlying interests.',
                    motivatedBy: 'Finding creative solutions, maintaining relationships while achieving outcomes.',
                    stressResponse: 'Under pressure, you may struggle with time constraints or become frustrated when collaboration is not reciprocated.',
                    blindSpots: 'May over-invest in collaboration when a quicker resolution would be appropriate.'
                },
                'Compromising': {
                    profileSummary: 'You find practical middle ground that allows all parties to move forward.',
                    decisionStyle: 'Pragmatic and efficient. You seek acceptable solutions rather than optimal ones.',
                    communicationStyle: 'Fair and balanced. You acknowledge multiple perspectives and seek trades.',
                    motivatedBy: 'Progress, fairness, and maintaining working relationships.',
                    stressResponse: 'Under pressure, you may rush to split the difference without fully exploring options.',
                    blindSpots: 'May settle for suboptimal solutions when better outcomes were achievable.'
                },
                'Avoiding': {
                    profileSummary: 'You choose your battles wisely, not escalating minor disagreements.',
                    decisionStyle: 'Selective engagement. You prefer to let some conflicts resolve naturally.',
                    communicationStyle: 'Indirect or delayed. You may change subjects or defer difficult conversations.',
                    motivatedBy: 'Preserving relationships, avoiding unnecessary tension, and maintaining peace.',
                    stressResponse: 'Under pressure, you may withdraw further or become increasingly unavailable.',
                    blindSpots: 'May allow problems to grow by not addressing them early.'
                },
                'Accommodating': {
                    profileSummary: 'You prioritize relationships by putting others\' needs first when appropriate.',
                    decisionStyle: 'Deferential. You yield to others\' preferences to maintain goodwill.',
                    communicationStyle: 'Agreeable and supportive. You validate others\' positions readily.',
                    motivatedBy: 'Harmony, helping others, and being liked.',
                    stressResponse: 'Under pressure, you may over-commit to others\' demands or suppress your own needs.',
                    blindSpots: 'May fail to advocate for your own legitimate interests or ideas.'
                }
            },
            motivation: {
                'Achievement': {
                    profileSummary: 'You are driven by excellence, mastery, and the satisfaction of accomplishment.',
                    decisionStyle: 'Goal-oriented. You choose options that maximize achievement and challenge.',
                    communicationStyle: 'Results-focused. You talk about goals, metrics, and accomplishments.',
                    motivatedBy: 'Challenging goals, measurable success, and recognition for achievement.',
                    stressResponse: 'Under pressure, you may become overly focused on results and impatient with obstacles.',
                    blindSpots: 'May overwork, neglect relationships, or miss the value of the journey.'
                },
                'Affiliation': {
                    profileSummary: 'You are driven by connection, belonging, and meaningful relationships.',
                    decisionStyle: 'Relationship-aware. You consider how decisions affect people and connections.',
                    communicationStyle: 'Warm and personal. You focus on relationships and shared experiences.',
                    motivatedBy: 'Acceptance, friendship, collaboration, and being part of a team.',
                    stressResponse: 'Under pressure, you may prioritize harmony over necessary action or conflict.',
                    blindSpots: 'May avoid difficult conversations or decisions that could affect relationships.'
                },
                'Power': {
                    profileSummary: 'You are driven by impact, influence, and the ability to shape outcomes.',
                    decisionStyle: 'Strategic and political. You consider how decisions affect your influence.',
                    communicationStyle: 'Persuasive and authoritative. You seek to influence and convince.',
                    motivatedBy: 'Control, influence, status, and making a significant impact.',
                    stressResponse: 'Under pressure, you may become more controlling or political.',
                    blindSpots: 'May focus on power accumulation over collective success.'
                }
            }
        };
        
        function generateSWOT(results) {
            const swot = {
                strengths: [],
                weaknesses: [],
                opportunities: [],
                threats: []
            };
            
            const p = parsedResults;
            
            // Generate rich, personalized strengths
            if (p.leadership && profileDescriptions.leadership[p.leadership.primary]) {
                swot.strengths.push(profileDescriptions.leadership[p.leadership.primary].strength);
            }
            if (p.conflict && profileDescriptions.conflict[p.conflict.primary]) {
                swot.strengths.push(profileDescriptions.conflict[p.conflict.primary].strength);
            }
            if (p.motivation && profileDescriptions.motivation[p.motivation.primary]) {
                swot.strengths.push(profileDescriptions.motivation[p.motivation.primary].strength);
            }
            if (p.personality && profileDescriptions.personality[p.personality.primary]) {
                swot.strengths.push(profileDescriptions.personality[p.personality.primary].strength);
            }
            if (p.ethics && profileDescriptions.ethics[p.ethics.primary]) {
                swot.strengths.push(profileDescriptions.ethics[p.ethics.primary].strength);
            }
            if (p.teamplayer && profileDescriptions.teamplayer[p.teamplayer.primary]) {
                swot.strengths.push(profileDescriptions.teamplayer[p.teamplayer.primary].strength);
            }
            if (p.learning && profileDescriptions.learning[p.learning.primary]) {
                swot.strengths.push(profileDescriptions.learning[p.learning.primary].strength);
            }
            
            // EQ-based strength
            if (p.eq && p.eq.level) {
                if (p.eq.level.includes('High') || p.eq.level.includes('Exceptional')) {
                    swot.strengths.push(`Your high emotional intelligence, particularly in ${p.eq.primary}, enables you to navigate complex interpersonal dynamics, build trust quickly, and lead with empathy. This is a foundational leadership capability that amplifies all your other skills.`);
                }
            }
            
            // Grit-based strength
            if (p.grit && p.grit.score >= 4.0) {
                swot.strengths.push(`Your exceptional grit score indicates remarkable perseverance and passion for long-term goals. You have the psychological resilience to overcome setbacks and maintain focus through challenges that derail others.`);
            }
            
            // Generate rich, personalized weaknesses/growth areas
            if (p.leadership && profileDescriptions.leadership[p.leadership.primary]) {
                swot.weaknesses.push(profileDescriptions.leadership[p.leadership.primary].weakness);
            }
            if (p.conflict && profileDescriptions.conflict[p.conflict.primary]) {
                swot.weaknesses.push(profileDescriptions.conflict[p.conflict.primary].weakness);
            }
            if (p.personality && profileDescriptions.personality[p.personality.primary]) {
                swot.weaknesses.push(profileDescriptions.personality[p.personality.primary].weakness);
            }
            
            // EQ-based weakness
            if (p.eq && p.eq.level && (p.eq.level.includes('Developing') || p.eq.level.includes('Building'))) {
                swot.weaknesses.push(`Your emotional intelligence is still developing, particularly in ${p.eq.primary}. This growth area may affect your ability to read social cues, manage stress responses, or connect authentically with colleagues under pressure.`);
            }
            
            // Low grit consideration
            if (p.grit && p.grit.score < 3.0) {
                swot.weaknesses.push(`Your grit score suggests you may struggle with sustained effort toward long-term goals, particularly when progress is slow or obstacles accumulate. Building perseverance habits will be important for career achievement.`);
            }
            
            // Pattern-based weakness
            if (results.length >= 3) {
                swot.weaknesses.push(`Like all leaders, your dominant styles create blind spots. Your pattern suggests you may undervalue approaches opposite to your preferences. Actively seek input from people who think differently to ensure balanced decisions.`);
            }
            
            // Generate rich opportunities
            if (p.leadership && profileDescriptions.leadership[p.leadership.primary]) {
                swot.opportunities.push(profileDescriptions.leadership[p.leadership.primary].opportunity);
            }
            if (p.motivation && profileDescriptions.motivation[p.motivation.primary]) {
                swot.opportunities.push(profileDescriptions.motivation[p.motivation.primary].opportunity);
            }
            if (p.ethics && profileDescriptions.ethics[p.ethics.primary]) {
                swot.opportunities.push(profileDescriptions.ethics[p.ethics.primary].opportunity);
            }
            if (p.learning && profileDescriptions.learning[p.learning.primary]) {
                swot.opportunities.push(profileDescriptions.learning[p.learning.primary].opportunity);
            }
            
            // Cross-assessment opportunity
            if (p.leadership && p.personality) {
                swot.opportunities.push(`Your ${p.leadership.primary} leadership style combined with ${p.personality.primary} management personality creates a distinctive leadership brand. Consider how to articulate this combination to mentors, sponsors, and in career positioning.`);
            }
            
            // Generate rich threats
            if (p.leadership && profileDescriptions.leadership[p.leadership.primary]) {
                swot.threats.push(profileDescriptions.leadership[p.leadership.primary].threat);
            }
            if (p.conflict && profileDescriptions.conflict[p.conflict.primary]) {
                swot.threats.push(profileDescriptions.conflict[p.conflict.primary].threat);
            }
            if (p.personality && profileDescriptions.personality[p.personality.primary]) {
                swot.threats.push(profileDescriptions.personality[p.personality.primary].threat);
            }
            
            // General strategic threat
            swot.threats.push(`The rapidly changing business environment requires style flexibility. If you become too attached to your preferred approaches, you risk becoming ineffective when situations demand different responses.`);
            
            // Default content if insufficient data
            if (swot.strengths.length === 0) {
                swot.strengths.push('Complete more assessments to generate personalized strength insights based on your unique profile.');
            }
            if (swot.weaknesses.length === 0) {
                swot.weaknesses.push('Complete more assessments to identify specific growth areas tailored to your leadership profile.');
            }
            if (swot.opportunities.length === 0) {
                swot.opportunities.push('Complete more assessments to discover personalized development opportunities aligned with your strengths.');
            }
            if (swot.threats.length === 0) {
                swot.threats.push('Complete more assessments to understand potential blind spots and challenges specific to your style.');
            }
            
            return swot;
        }
        
        function generateInsights(results) {
            const insights = [];
            const p = parsedResults;
            
            // Leadership + Influence synergy - deep analysis
            if (p.leadership && p.influence) {
                insights.push({
                    title: 'üëë Leadership-Influence Integration',
                    description: `Your ${p.leadership.primary} leadership approach combined with ${p.influence.primary} influence style creates a distinctive leadership signature. ${
                        p.leadership.primary === 'Coaching' && p.influence.primary === 'Inspiring' ? 
                        'This powerful combination allows you to develop others while motivating them toward shared goals‚Äîa hallmark of transformational leadership.' :
                        p.leadership.primary === 'Directing' && p.influence.primary === 'Asserting' ?
                        'This combination creates a strong, authoritative presence that is effective in crisis situations, though you may need to consciously dial back for collaborative settings.' :
                        p.leadership.primary === 'Supporting' && p.influence.primary === 'Bridging' ?
                        'This combination makes you exceptional at building coalitions and creating inclusive environments where diverse perspectives thrive.' :
                        `Consider how these two styles interact: when does this combination serve you well, and when might you need to consciously adjust your approach?`
                    }`
                });
            }
            
            // EQ + Conflict pattern - deep analysis
            if (p.eq && p.conflict) {
                const eqLevel = p.eq.level || '';
                const isHighEQ = eqLevel.includes('High') || eqLevel.includes('Exceptional');
                insights.push({
                    title: '‚ù§Ô∏è Emotional Intelligence & Conflict Dynamics',
                    description: `Your ${p.eq.primary} emotional intelligence strength paired with ${p.conflict.primary} conflict style ${
                        isHighEQ && p.conflict.primary === 'Collaborating' ?
                        'is an exceptional combination. You can read emotional undercurrents in disagreements while working toward solutions that address everyone\'s core concerns. This is rare and valuable.' :
                        isHighEQ && p.conflict.primary === 'Avoiding' ?
                        'creates an interesting tension. While you can read situations accurately, you may use that awareness to sidestep rather than address issues. Your EQ strength could actually enable more effective direct conversations.' :
                        p.conflict.primary === 'Competing' ?
                        `means you should pay attention to when assertiveness crosses into aggression. Your ${p.eq.primary} awareness can help you read the room and adjust intensity.` :
                        `suggests opportunities to leverage emotional awareness in navigating disagreements. Notice how emotions‚Äîyours and others'‚Äîinfluence conflict dynamics.`
                    }`
                });
            }
            
            // Strategic + Decision-Making - deep analysis
            if (p.strategic && p.decision) {
                insights.push({
                    title: '‚ôüÔ∏è Strategic Decision Architecture',
                    description: `Your ${p.strategic.primary} strategic orientation combined with ${p.decision.primary} decision-making style shapes how you approach important choices. ${
                        p.decision.primary === 'Analytical' ?
                        'You likely prefer data-driven strategies backed by thorough analysis. Ensure you don\'t over-analyze at the expense of timely action‚Äîsometimes "good enough" information is sufficient for strategic moves.' :
                        p.decision.primary === 'Conceptual' ?
                        'You combine big-picture strategic thinking with creative, conceptual decision-making. This positions you well for innovation and long-term vision, though you may need partners who excel at operational execution.' :
                        p.decision.primary === 'Behavioral' ?
                        'You balance strategic thinking with strong attention to people impact in decisions. This stakeholder-aware approach builds buy-in but may sometimes delay difficult choices.' :
                        'You tend toward efficient, practical strategic decisions. While this enables quick action, ensure important strategic choices receive adequate deliberation.'
                    }`
                });
            }
            
            // Motivation + Grit - deep analysis
            if (p.motivation && p.grit) {
                const gritScore = p.grit.score || 3.5;
                insights.push({
                    title: 'üî• Drive & Persistence Profile',
                    description: `Your ${p.motivation.primary} motivation combined with ${gritScore >= 4.0 ? 'exceptional' : gritScore >= 3.5 ? 'solid' : 'developing'} grit creates ${
                        p.motivation.primary === 'Achievement' && gritScore >= 4.0 ?
                        'a powerful engine for accomplishment. You have both the drive to excel and the staying power to persist through challenges. Channel this carefully to avoid burnout.' :
                        p.motivation.primary === 'Affiliation' && gritScore >= 4.0 ?
                        'an interesting profile: you\'re motivated by relationships yet have strong perseverance. You likely persist particularly well when pursuing goals that benefit your team or community.' :
                        p.motivation.primary === 'Power' && gritScore >= 4.0 ?
                        'significant potential for impact. Your drive to influence combined with persistence means you\'ll likely achieve positions where you can make a real difference.' :
                        gritScore < 3.5 ?
                        'an area for development. Your motivation is clear, but building greater perseverance will help you achieve your goals when obstacles arise.' :
                        'a foundation for sustained success. Understanding what motivates you helps you choose goals worth persisting toward.'
                    }`
                });
            }
            
            // Change + Innovation readiness
            if (p.change && p.innovation) {
                insights.push({
                    title: 'üöÄ Change & Innovation Posture',
                    description: `Your change readiness profile (${p.change.level || 'assessed'}) combined with ${p.innovation.primary} innovation strength indicates ${
                        p.change.level && p.change.level.includes('Champion') ?
                        'you\'re naturally positioned to lead transformation. You embrace change and can help others navigate uncertainty through creative problem-solving.' :
                        p.change.level && p.change.level.includes('Ready') ?
                        'solid adaptability. You can work effectively in changing environments and contribute meaningfully to innovation efforts.' :
                        p.change.level && p.change.level.includes('Resistant') ?
                        'an area for growth. While change resistance often reflects valuable caution and stability-seeking, today\'s environment rewards adaptability. Start with small experiments.' :
                        'capabilities that will serve you as organizations increasingly require innovation and adaptability from their leaders.'
                    }`
                });
            }
            
            // Learning style insight - expanded
            if (p.learning) {
                insights.push({
                    title: 'üìö Optimizing Your Learning',
                    description: `As a ${p.learning.primary} learner, you develop best through ${
                        p.learning.primary === 'Diverging' ? 
                        'observation, reflection, and brainstorming. You\'re at your best when given time to consider multiple perspectives before acting. Seek learning experiences that include reflection time, diverse viewpoints, and creative exploration.' :
                        p.learning.primary === 'Assimilating' ? 
                        'logical analysis, theoretical frameworks, and organized information. You prefer to understand the "why" before the "how." Seek learning experiences with strong conceptual foundations, reading materials, and time to integrate ideas into your mental models.' :
                        p.learning.primary === 'Converging' ? 
                        'practical application and problem-solving. You learn fastest when you can test ideas and see immediate results. Seek hands-on projects, simulations, and opportunities to apply concepts to real problems.' :
                        'hands-on experimentation and learning by doing. You prefer action over analysis and learn from trial and error. Seek immersive experiences, stretch assignments, and environments that reward initiative.'
                    }`
                });
            }
            
            // Team Player + Conflict pattern - expanded
            if (p.teamplayer && p.conflict) {
                insights.push({
                    title: 'ü§ù Team Collaboration Signature',
                    description: `Your ${p.teamplayer.primary} team orientation combined with ${p.conflict.primary} conflict style shapes your team presence. ${
                        p.teamplayer.primary === 'Contributor' ?
                        'You likely focus on delivering quality work and may step back from team process issues. Your task excellence is valued, but ensure your voice is heard in team decisions.' :
                        p.teamplayer.primary === 'Collaborator' ?
                        'You focus on keeping the team aligned on goals. Your big-picture focus helps teams stay on track, especially when combined with your approach to managing disagreements.' :
                        p.teamplayer.primary === 'Communicator' ?
                        'You prioritize team dynamics and relationships. This people-awareness combines with your conflict style to shape how disagreements unfold on your teams.' :
                        'You push teams to question assumptions and improve. This valuable contribution is most effective when balanced with relationship-building.'
                    }`
                });
            }
            
            // Business Ethics + Values - expanded
            if (p.ethics && p.values) {
                insights.push({
                    title: '‚öñÔ∏è Ethical Foundation & Core Values',
                    description: `Your ${p.ethics.primary} ethical framework aligns with your core value of ${p.values.primary}, creating a consistent moral compass. This alignment suggests you make ethical decisions ${
                        p.ethics.primary === 'Consequentialist' ?
                        'by evaluating outcomes against your values. When facing dilemmas, you ask "what action will produce results most aligned with what I truly value?"' :
                        p.ethics.primary === 'Deontologist' ?
                        'by applying principle-based rules derived from your values. You have clear lines you won\'t cross, regardless of circumstances.' :
                        p.ethics.primary === 'Virtue Ethicist' ?
                        'by asking what a person who embodies your values would do. Your character and values are inseparable from your ethical reasoning.' :
                        'by considering your responsibilities to people you\'re in relationship with. Your values inform how you balance competing relational obligations.'
                    } Ethical clarity is a leadership strength‚Äîuse it to guide difficult decisions with confidence.`
                });
            }
            
            // Management Personality + Leadership - expanded
            if (p.personality && p.leadership) {
                insights.push({
                    title: 'üß† Your Management DNA',
                    description: `Your ${p.personality.primary} management personality combined with ${p.leadership.primary} leadership style reveals your core management approach. ${
                        p.personality.primary === 'Director' ?
                        'You\'re results-focused and direct. Combined with your leadership style, this creates a clear, accountable environment. Ensure you balance drive with development.' :
                        p.personality.primary === 'Innovator' ?
                        'You prioritize creativity and new approaches. Combined with your leadership style, you likely create environments where experimentation is encouraged. Balance innovation with execution.' :
                        p.personality.primary === 'Visionary' ?
                        'You focus on big-picture direction and inspiring futures. Combined with your leadership style, you help others see beyond current constraints. Partner with detail-oriented colleagues.' :
                        'You invest in growing others and building capability. Combined with your leadership style, you likely create loyal, developing teams. Balance development with performance expectations.'
                    }`
                });
            }
            
            // Values + Motivation synergy - expanded
            if (p.values && p.motivation) {
                insights.push({
                    title: 'üíé Values-Motivation Alignment',
                    description: `Your core value of ${p.values.primary} paired with ${p.motivation.primary} motivation reveals what drives you at the deepest level. ${
                        p.motivation.primary === 'Achievement' ?
                        'You\'re driven to excel in ways that express your values. Seek goals that allow you to achieve excellence in domains that genuinely matter to you.' :
                        p.motivation.primary === 'Affiliation' ?
                        'You\'re driven to build connections with people who share your values. Seek communities and teams where your values are celebrated.' :
                        'You\'re driven to have impact in ways that express your values. Seek influence in domains where your values can shape outcomes for others.'
                    } This values-motivation alignment is the foundation of authentic leadership.`
                });
            }
            
            // Overall Emerging Profile
            if (results.length >= 8) {
                const primaryStyles = Object.values(p).filter(r => r && r.primary).map(r => r.primary).slice(0, 5);
                insights.push({
                    title: 'üéØ Your Leadership Profile Synthesis',
                    description: `Based on ${results.length} assessments, a clear leadership profile emerges. Your dominant patterns include: ${primaryStyles.join(', ')}. This combination suggests a leader who ${
                        p.personality?.primary === 'Director' || p.motivation?.primary === 'Achievement' ?
                        'is driven by results and excellence, bringing high standards and clear direction to teams.' :
                        p.personality?.primary === 'Developer' || p.motivation?.primary === 'Affiliation' ?
                        'prioritizes people and relationships, creating environments where others can thrive and grow.' :
                        p.personality?.primary === 'Innovator' || p.leadership?.primary === 'Delegating' ?
                        'empowers creativity and autonomy, trusting others to find their own paths to success.' :
                        'brings a unique combination of strengths that should be leveraged consciously in leadership situations.'
                    } Remember: these patterns are tendencies, not limitations. The best leaders expand their range while staying authentic to their core.`
                });
            }
            
            // Stress + EQ resilience insight
            if (p.stress && p.eq) {
                insights.push({
                    title: 'üßò Stress & Emotional Resilience',
                    description: `Your ${p.stress.primary} stress management approach combined with ${p.eq.primary} emotional intelligence strength shapes how you handle pressure. ${
                        p.stress.primary === 'Problem-Focused' ?
                        'You tackle stressors head-on by addressing root causes. Your emotional awareness can help you know when direct action is possible versus when adaptation is wiser.' :
                        p.stress.primary === 'Emotion-Focused' ?
                        'You manage stress by regulating your emotional response. This approach works well when stressors can\'t be directly controlled, and your EQ supports sophisticated emotional regulation.' :
                        p.stress.primary === 'Support-Seeking' ?
                        'You turn to others when stressed. This social coping strategy builds connection and shares burdens‚Äîyour EQ helps you ask for help in ways that strengthen relationships.' :
                        'You may tend to distance from stressors. While this protects short-term wellbeing, developing more active coping strategies will serve your long-term resilience.'
                    }`
                });
            }
            
            return insights;
        }
        
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            section.classList.toggle('open');
            const content = section.querySelector('.section-content');
            content.classList.toggle('open');
        }
        
        function saveProgress() {
            const data = {
                studentName: document.getElementById('studentName').value,
                date: document.getElementById('trackingDate').value,
                codes: {}
            };
            
            activeAssessments.forEach(a => {
                const code = document.getElementById(`code-${a.id}`).value;
                if (code) data.codes[a.id] = code;
            });
            
            localStorage.setItem('mgmt316_tracker', JSON.stringify(data));
        }
        
        function loadProgress() {
            const saved = localStorage.getItem('mgmt316_tracker');
            if (!saved) return;
            
            try {
                const data = JSON.parse(saved);
                if (data.studentName) document.getElementById('studentName').value = data.studentName;
                if (data.date) document.getElementById('trackingDate').value = data.date;
                if (data.codes) {
                    Object.entries(data.codes).forEach(([id, code]) => {
                        const input = document.getElementById(`code-${id}`);
                        if (input) {
                            input.value = code;
                            validateCode(id);
                        }
                    });
                }
            } catch (e) {
                console.error('Error loading progress:', e);
            }
        }
        
        function clearAllData() {
            if (!confirm('Are you sure you want to clear all entered data? This cannot be undone.')) return;
            
            localStorage.removeItem('mgmt316_tracker');
            activeAssessments.forEach(a => {
                document.getElementById(`code-${a.id}`).value = '';
                validateCode(a.id);
            });
            document.getElementById('studentName').value = '';
            document.getElementById('trackingDate').value = new Date().toISOString().split('T')[0];
            parsedResults = {};
            updateAnalysis();
        }
        
        function generateComprehensiveReport() {
            const studentName = document.getElementById('studentName').value || 'Student';
            const completedCount = Object.keys(parsedResults).length;
            
            if (completedCount === 0) {
                alert('Please enter at least one tracker code before generating a report.');
                return;
            }
            
            var jsPDF = window.jspdf.jsPDF;
            var doc = new jsPDF();
            
            var chapmanBlue = [0, 32, 91];
            var chapmanGold = [196, 160, 0];
            var textDark = [26, 26, 46];
            var textMuted = [100, 100, 110];
            var greenColor = [46, 125, 50];
            var redColor = [198, 40, 40];
            var blueColor = [21, 101, 192];
            var orangeColor = [230, 81, 0];
            
            // Helper function for text wrapping
            function addWrappedText(text, x, startY, maxWidth, lineHeight, fontSize) {
                doc.setFontSize(fontSize || 9);
                var lines = doc.splitTextToSize(text, maxWidth);
                var currentY = startY;
                lines.forEach(function(line) {
                    if (currentY > 275) { 
                        doc.addPage(); 
                        currentY = 25; 
                    }
                    doc.text(line, x, currentY);
                    currentY += lineHeight || 4.5;
                });
                return currentY;
            }
            
            // =====================
            // PAGE 1: COVER & EXECUTIVE SUMMARY
            // =====================
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.rect(0, 0, 210, 55, 'F');
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('CHAPMAN UNIVERSITY', 105, 15, { align: 'center' });
            doc.setFontSize(9);
            doc.setTextColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.text('Argyros College of Business and Economics', 105, 22, { align: 'center' });
            doc.setFontSize(18);
            doc.setTextColor(255, 255, 255);
            doc.text('Leadership Self-Assessment Portfolio', 105, 36, { align: 'center' });
            doc.setFontSize(11);
            doc.text('Comprehensive Self-Awareness Profile', 105, 45, { align: 'center' });
            doc.setFillColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.rect(0, 55, 210, 3, 'F');
            
            var y = 68;
            doc.setFontSize(14);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text(studentName, 105, y, { align: 'center' });
            y += 8;
            doc.setFontSize(10);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            doc.text('MGMT 316: Management in Organizations', 105, y, { align: 'center' });
            y += 6;
            doc.text('Professor Chip Monaco ‚Ä¢ ' + new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }), 105, y, { align: 'center' });
            y += 6;
            doc.text('Assessments Completed: ' + completedCount + ' of 22', 105, y, { align: 'center' });
            
            y += 15;
            
            // Executive Summary Box
            doc.setFillColor(240, 244, 248);
            doc.roundedRect(15, y, 180, 45, 3, 3, 'F');
            doc.setDrawColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.setLineWidth(0.5);
            doc.roundedRect(15, y, 180, 45, 3, 3, 'S');
            
            y += 8;
            doc.setFontSize(11);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('EXECUTIVE SUMMARY', 20, y);
            y += 7;
            
            // Build executive summary based on results
            var execSummary = 'This portfolio represents your comprehensive leadership self-assessment across ' + completedCount + ' dimensions. ';
            if (parsedResults.leadership && parsedResults.personality) {
                execSummary += 'Your profile reveals a ' + parsedResults.personality.primary + '-oriented leader with a ' + parsedResults.leadership.primary + ' style. ';
            }
            if (parsedResults.motivation) {
                execSummary += 'You are primarily motivated by ' + parsedResults.motivation.primary + '. ';
            }
            if (parsedResults.eq && parsedResults.eq.level) {
                execSummary += 'Your emotional intelligence is at the ' + parsedResults.eq.level + ' level. ';
            }
            execSummary += 'The insights in this document will help you leverage your strengths, address growth areas, and develop as a more effective leader.';
            
            doc.setFontSize(9);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            y = addWrappedText(execSummary, 20, y, 170, 4.5, 9);
            
            y += 12;
            
            // Primary Styles Summary
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(15, y, 180, 10, 2, 2, 'F');
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('YOUR PRIMARY STYLES AT A GLANCE', 105, y + 7, { align: 'center' });
            y += 16;
            
            doc.setFontSize(9);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var col1X = 20, col2X = 110;
            var rowHeight = 5;
            
            var stylesList = [
                { label: 'Leadership Style', value: parsedResults.leadership ? parsedResults.leadership.primary : '‚Äî' },
                { label: 'Communication Style', value: parsedResults.communication ? parsedResults.communication.primary : '‚Äî' },
                { label: 'Conflict Approach', value: parsedResults.conflict ? parsedResults.conflict.primary : '‚Äî' },
                { label: 'Decision-Making', value: parsedResults.decision ? parsedResults.decision.primary : '‚Äî' },
                { label: 'Management Personality', value: parsedResults.personality ? parsedResults.personality.primary : '‚Äî' },
                { label: 'Primary Motivation', value: parsedResults.motivation ? parsedResults.motivation.primary : '‚Äî' },
                { label: 'Team Role', value: parsedResults.teamplayer ? parsedResults.teamplayer.primary : '‚Äî' },
                { label: 'Learning Style', value: parsedResults.learning ? parsedResults.learning.primary : '‚Äî' },
                { label: 'Ethical Framework', value: parsedResults.ethics ? parsedResults.ethics.primary : '‚Äî' },
                { label: 'Core Value', value: parsedResults.values ? parsedResults.values.primary : '‚Äî' },
            ];
            
            for (var i = 0; i < stylesList.length; i += 2) {
                if (y > 270) { doc.addPage(); y = 25; }
                doc.setFont(undefined, 'bold');
                doc.text(stylesList[i].label + ':', col1X, y);
                doc.setFont(undefined, 'normal');
                doc.text(stylesList[i].value, col1X + 45, y);
                if (stylesList[i + 1]) {
                    doc.setFont(undefined, 'bold');
                    doc.text(stylesList[i + 1].label + ':', col2X, y);
                    doc.setFont(undefined, 'normal');
                    doc.text(stylesList[i + 1].value, col2X + 45, y);
                }
                y += rowHeight;
            }
            
            // =====================
            // PAGE 2: SWOT ANALYSIS
            // =====================
            doc.addPage();
            y = 20;
            
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(15, y, 180, 12, 2, 2, 'F');
            doc.setFontSize(12);
            doc.setTextColor(255, 255, 255);
            doc.text('COMPREHENSIVE SWOT ANALYSIS', 105, y + 8, { align: 'center' });
            y += 20;
            
            var swot = generateSWOT(Object.values(parsedResults));
            
            // STRENGTHS
            doc.setFillColor(232, 245, 233);
            doc.roundedRect(15, y, 180, 8, 2, 2, 'F');
            doc.setFontSize(10);
            doc.setTextColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.text('üí™ STRENGTHS', 20, y + 5.5);
            y += 12;
            
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            swot.strengths.slice(0, 5).forEach(function(s) {
                if (y > 265) { doc.addPage(); y = 25; }
                y = addWrappedText('‚Ä¢ ' + s, 20, y, 170, 4, 8);
                y += 2;
            });
            y += 5;
            
            // GROWTH AREAS
            if (y > 200) { doc.addPage(); y = 25; }
            doc.setFillColor(255, 235, 238);
            doc.roundedRect(15, y, 180, 8, 2, 2, 'F');
            doc.setFontSize(10);
            doc.setTextColor(redColor[0], redColor[1], redColor[2]);
            doc.text('üéØ AREAS FOR GROWTH', 20, y + 5.5);
            y += 12;
            
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            swot.weaknesses.slice(0, 4).forEach(function(w) {
                if (y > 265) { doc.addPage(); y = 25; }
                y = addWrappedText('‚Ä¢ ' + w, 20, y, 170, 4, 8);
                y += 2;
            });
            y += 5;
            
            // OPPORTUNITIES
            if (y > 200) { doc.addPage(); y = 25; }
            doc.setFillColor(227, 242, 253);
            doc.roundedRect(15, y, 180, 8, 2, 2, 'F');
            doc.setFontSize(10);
            doc.setTextColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.text('üöÄ OPPORTUNITIES', 20, y + 5.5);
            y += 12;
            
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            swot.opportunities.slice(0, 4).forEach(function(o) {
                if (y > 265) { doc.addPage(); y = 25; }
                y = addWrappedText('‚Ä¢ ' + o, 20, y, 170, 4, 8);
                y += 2;
            });
            y += 5;
            
            // THREATS
            if (y > 200) { doc.addPage(); y = 25; }
            doc.setFillColor(255, 243, 224);
            doc.roundedRect(15, y, 180, 8, 2, 2, 'F');
            doc.setFontSize(10);
            doc.setTextColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.text('‚ö†Ô∏è WATCH OUT FOR', 20, y + 5.5);
            y += 12;
            
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            swot.threats.slice(0, 4).forEach(function(t) {
                if (y > 265) { doc.addPage(); y = 25; }
                y = addWrappedText('‚Ä¢ ' + t, 20, y, 170, 4, 8);
                y += 2;
            });
            
            // =====================
            // PAGE 3: CROSS-ASSESSMENT INSIGHTS
            // =====================
            doc.addPage();
            y = 20;
            
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(15, y, 180, 12, 2, 2, 'F');
            doc.setFontSize(12);
            doc.setTextColor(255, 255, 255);
            doc.text('INTEGRATED LEADERSHIP INSIGHTS', 105, y + 8, { align: 'center' });
            y += 18;
            
            var insights = generateInsights(Object.values(parsedResults));
            
            insights.forEach(function(insight, index) {
                if (y > 240) { doc.addPage(); y = 25; }
                
                // Insight box
                doc.setFillColor(248, 249, 250);
                doc.roundedRect(15, y, 180, 6, 1, 1, 'F');
                doc.setFontSize(9);
                doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
                doc.setFont(undefined, 'bold');
                doc.text(insight.title, 20, y + 4);
                y += 9;
                
                doc.setFont(undefined, 'normal');
                doc.setTextColor(textDark[0], textDark[1], textDark[2]);
                y = addWrappedText(insight.description, 20, y, 170, 4, 8);
                y += 8;
            });
            
            // =====================
            // PAGE 4: DEEP PROFILE ANALYSIS
            // =====================
            doc.addPage();
            y = 20;
            
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(15, y, 180, 12, 2, 2, 'F');
            doc.setFontSize(12);
            doc.setTextColor(255, 255, 255);
            doc.text('DEEP PROFILE ANALYSIS', 105, y + 8, { align: 'center' });
            y += 18;
            
            doc.setFontSize(8);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            y = addWrappedText('Detailed behavioral insights based on your primary assessment results', 20, y, 170, 4, 8);
            y += 10;
            
            // Deep profiles from leadership, conflict, motivation
            var deepProfiles = [];
            
            if (parsedResults.leadership && deepProfileData.leadership && deepProfileData.leadership[parsedResults.leadership.primary]) {
                deepProfiles.push({
                    title: 'Leadership: ' + parsedResults.leadership.primary,
                    data: deepProfileData.leadership[parsedResults.leadership.primary]
                });
            }
            if (parsedResults.conflict && deepProfileData.conflict && deepProfileData.conflict[parsedResults.conflict.primary]) {
                deepProfiles.push({
                    title: 'Conflict Style: ' + parsedResults.conflict.primary,
                    data: deepProfileData.conflict[parsedResults.conflict.primary]
                });
            }
            if (parsedResults.motivation && deepProfileData.motivation && deepProfileData.motivation[parsedResults.motivation.primary]) {
                deepProfiles.push({
                    title: 'Motivation: ' + parsedResults.motivation.primary,
                    data: deepProfileData.motivation[parsedResults.motivation.primary]
                });
            }
            
            deepProfiles.forEach(function(profile) {
                if (y > 200) { doc.addPage(); y = 25; }
                
                // Profile header
                doc.setFillColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
                doc.roundedRect(15, y, 180, 7, 1, 1, 'F');
                doc.setFontSize(10);
                doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
                doc.setFont(undefined, 'bold');
                doc.text(profile.title, 20, y + 5);
                y += 12;
                
                doc.setFont(undefined, 'normal');
                doc.setFontSize(8);
                doc.setTextColor(textDark[0], textDark[1], textDark[2]);
                
                // Profile Summary
                doc.setFont(undefined, 'bold');
                doc.text('Profile Summary:', 20, y);
                doc.setFont(undefined, 'normal');
                y += 4;
                y = addWrappedText(profile.data.profileSummary, 20, y, 170, 3.5, 8);
                y += 6;
                
                // Decision Style
                if (y > 260) { doc.addPage(); y = 25; }
                doc.setFont(undefined, 'bold');
                doc.text('Decision Style:', 20, y);
                doc.setFont(undefined, 'normal');
                y += 4;
                y = addWrappedText(profile.data.decisionStyle, 20, y, 170, 3.5, 8);
                y += 6;
                
                // Communication Style
                if (y > 260) { doc.addPage(); y = 25; }
                doc.setFont(undefined, 'bold');
                doc.text('Communication Style:', 20, y);
                doc.setFont(undefined, 'normal');
                y += 4;
                y = addWrappedText(profile.data.communicationStyle, 20, y, 170, 3.5, 8);
                y += 6;
                
                // Motivated By
                if (y > 260) { doc.addPage(); y = 25; }
                doc.setFont(undefined, 'bold');
                doc.text('Motivated By:', 20, y);
                doc.setFont(undefined, 'normal');
                y += 4;
                y = addWrappedText(profile.data.motivatedBy, 20, y, 170, 3.5, 8);
                y += 6;
                
                // Stress Response
                if (y > 260) { doc.addPage(); y = 25; }
                doc.setFont(undefined, 'bold');
                doc.setTextColor(orangeColor[0], orangeColor[1], orangeColor[2]);
                doc.text('Under Stress:', 20, y);
                doc.setFont(undefined, 'normal');
                doc.setTextColor(textDark[0], textDark[1], textDark[2]);
                y += 4;
                y = addWrappedText(profile.data.stressResponse, 20, y, 170, 3.5, 8);
                y += 6;
                
                // Blind Spots
                if (y > 260) { doc.addPage(); y = 25; }
                doc.setFont(undefined, 'bold');
                doc.setTextColor(200, 40, 40);
                doc.text('Blind Spots:', 20, y);
                doc.setFont(undefined, 'normal');
                doc.setTextColor(textDark[0], textDark[1], textDark[2]);
                y += 4;
                y = addWrappedText(profile.data.blindSpots, 20, y, 170, 3.5, 8);
                y += 12;
            });
            
            // =====================
            // PAGE 5: DEVELOPMENT RECOMMENDATIONS
            // =====================
            doc.addPage();
            y = 20;
            
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(15, y, 180, 12, 2, 2, 'F');
            doc.setFontSize(12);
            doc.setTextColor(255, 255, 255);
            doc.text('DEVELOPMENT RECOMMENDATIONS', 105, y + 8, { align: 'center' });
            y += 18;
            
            doc.setFontSize(9);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            
            // Generate personalized recommendations
            var recommendations = [];
            
            recommendations.push({
                title: 'üìñ Leverage Your Strengths',
                content: 'Your assessment results reveal clear strengths. Rather than focusing solely on weaknesses, find ways to apply these strengths more intentionally. Strengths used in new contexts become even more powerful.'
            });
            
            if (parsedResults.learning) {
                var learnRec = parsedResults.learning.primary === 'Diverging' ?
                    'Seek experiences that allow reflection and creative exploration. Join brainstorming sessions, take on projects requiring multiple perspectives, and build in time to observe before acting.' :
                    parsedResults.learning.primary === 'Assimilating' ?
                    'Pursue learning with strong theoretical foundations. Read extensively, attend lectures, and seek mentors who can explain the "why" behind practices. Create your own frameworks.' :
                    parsedResults.learning.primary === 'Converging' ?
                    'Focus on practical application. Seek hands-on projects, simulations, and stretch assignments. You learn best by testing ideas in real situations.' :
                    'Immerse yourself in new experiences. Volunteer for challenging assignments, learn by doing, and don\'t be afraid to experiment and iterate.';
                recommendations.push({ title: 'üìö Optimize Your Learning', content: learnRec });
            }
            
            if (parsedResults.conflict) {
                var conflictRec = parsedResults.conflict.primary === 'Avoiding' ?
                    'Practice addressing small conflicts directly. Start with low-stakes disagreements to build comfort. Remember: unaddressed issues often grow larger.' :
                    parsedResults.conflict.primary === 'Competing' ?
                    'Experiment with collaborative approaches. Before asserting your position, genuinely explore others\' concerns. You may find integrative solutions that exceed your original goals.' :
                    parsedResults.conflict.primary === 'Accommodating' ?
                    'Practice advocating for your own needs and ideas. Your perspective has value‚Äîensure it\'s represented in important decisions.' :
                    'Continue developing your conflict resolution skills. Consider when each style is most appropriate and expand your range.';
                recommendations.push({ title: '‚öîÔ∏è Develop Conflict Skills', content: conflictRec });
            }
            
            if (parsedResults.eq && parsedResults.eq.level && (parsedResults.eq.level.includes('Developing') || parsedResults.eq.level.includes('Building'))) {
                recommendations.push({
                    title: '‚ù§Ô∏è Build Emotional Intelligence',
                    content: 'Your EQ assessment suggests room for growth. Focus on: (1) Pause before reacting‚Äîcreate space between stimulus and response. (2) Name emotions precisely‚Äî"frustrated" is more useful than "upset." (3) Seek feedback on how others experience your emotional presence.'
                });
            }
            
            if (parsedResults.grit && parsedResults.grit.score < 3.5) {
                recommendations.push({
                    title: 'üí™ Build Perseverance',
                    content: 'Your grit score suggests opportunities to build perseverance. Try: (1) Set process goals, not just outcome goals. (2) Celebrate small wins along the way. (3) Reframe setbacks as learning opportunities. (4) Connect daily tasks to long-term meaning.'
                });
            }
            
            recommendations.push({
                title: 'üéØ Expand Your Range',
                content: 'While your primary styles are strengths, leadership effectiveness requires flexibility. Identify one style opposite to your preference and consciously practice it in low-stakes situations. Versatile leaders adapt to what each situation requires.'
            });
            
            recommendations.push({
                title: 'üîÑ Revisit Periodically',
                content: 'Self-awareness is not a destination but a journey. Consider retaking these assessments in 6-12 months to track your development. Your profiles will evolve as you grow as a leader.'
            });
            
            recommendations.forEach(function(rec) {
                if (y > 240) { doc.addPage(); y = 25; }
                
                doc.setFillColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
                doc.roundedRect(15, y, 180, 6, 1, 1, 'F');
                doc.setFontSize(9);
                doc.setTextColor(255, 255, 255);
                doc.setFont(undefined, 'bold');
                doc.text(rec.title, 20, y + 4);
                y += 9;
                
                doc.setFont(undefined, 'normal');
                doc.setTextColor(textDark[0], textDark[1], textDark[2]);
                y = addWrappedText(rec.content, 20, y, 170, 4, 8);
                y += 8;
            });
            
            // =====================
            // FINAL PAGE: ASSESSMENT DETAILS
            // =====================
            doc.addPage();
            y = 20;
            
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(15, y, 180, 12, 2, 2, 'F');
            doc.setFontSize(12);
            doc.setTextColor(255, 255, 255);
            doc.text('DETAILED ASSESSMENT RESULTS', 105, y + 8, { align: 'center' });
            y += 18;
            
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            
            activeAssessments.forEach(function(assessment) {
                var result = parsedResults[assessment.id];
                if (!result) return;
                
                if (y > 265) { doc.addPage(); y = 25; }
                
                doc.setFont(undefined, 'bold');
                doc.text(assessment.icon + ' ' + assessment.name, 20, y);
                doc.setFont(undefined, 'normal');
                
                var details = [];
                if (result.primary) details.push('Primary: ' + result.primary);
                if (result.secondary) details.push('Secondary: ' + result.secondary);
                if (result.level) details.push('Level: ' + result.level);
                if (result.score) details.push('Score: ' + result.score);
                
                doc.text(details.join(' | '), 55, y);
                y += 6;
            });
            
            y += 10;
            
            // Closing note
            doc.setFillColor(240, 244, 248);
            doc.roundedRect(15, y, 180, 25, 2, 2, 'F');
            y += 8;
            doc.setFontSize(9);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.setFont(undefined, 'italic');
            y = addWrappedText('"The unexamined life is not worth living." ‚Äî Socrates. Self-awareness is the foundation of leadership. Use these insights not as labels but as starting points for growth.', 20, y, 170, 4.5, 9);
            
            // Footer on all pages
            var pageCount = doc.internal.getNumberOfPages();
            for (var i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
                doc.setFont(undefined, 'normal');
                doc.text('Page ' + i + ' of ' + pageCount, 105, 287, { align: 'center' });
                doc.text('Chapman University ‚Ä¢ MGMT 316 ‚Ä¢ Professor Chip Monaco ‚Ä¢ ' + new Date().getFullYear(), 105, 292, { align: 'center' });
            }
            
            doc.save('Leadership_Portfolio_' + studentName.replace(/\s+/g, '_') + '_' + new Date().toISOString().split('T')[0] + '.pdf');
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
