<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grit Assessment | Chapman University</title>
    <style>
        :root {
            --chapman-blue: #00205B;
            --chapman-gold: #C4A000;
            --gold-light: #F5E6A3;
            --blue-light: #E8EDF5;
            --blue-medium: #1A3A7A;
            --text-primary: #1a1a2e;
            --text-secondary: #4a4a5a;
            --white: #ffffff;
            --perseverance: #C62828;
            --passion: #1565C0;
            --shadow-subtle: 0 2px 8px rgba(0, 32, 91, 0.08);
            --shadow-medium: 0 4px 20px rgba(0, 32, 91, 0.12);
            --shadow-strong: 0 8px 32px rgba(0, 32, 91, 0.18);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', -apple-system, sans-serif; line-height: 1.7; color: var(--text-primary); background: linear-gradient(135deg, var(--chapman-blue) 0%, var(--blue-medium) 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 950px; margin: 0 auto; background: var(--white); border-radius: 16px; box-shadow: var(--shadow-strong); overflow: hidden; }
        .header { background: linear-gradient(135deg, var(--chapman-blue) 0%, var(--blue-medium) 100%); color: var(--white); padding: 40px 30px; text-align: center; position: relative; }
        .header::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, var(--chapman-gold), var(--gold-light), var(--chapman-gold)); }
        .institution { font-size: 0.95em; letter-spacing: 2px; text-transform: uppercase; opacity: 0.9; margin-bottom: 5px; }
        .college { font-size: 1.1em; color: var(--chapman-gold); margin-bottom: 20px; font-weight: 600; }
        h1 { font-size: 2.4em; font-weight: 700; margin-bottom: 12px; }
        .subtitle { font-size: 1.15em; font-style: italic; color: var(--gold-light); }
        .content { padding: 35px; }
        .hidden { display: none !important; }
        .intro-section { background: linear-gradient(135deg, var(--blue-light), #f8f9fc); border-radius: 14px; padding: 30px; margin-bottom: 30px; border-left: 5px solid var(--chapman-blue); }
        .intro-section h2 { color: var(--chapman-blue); font-size: 1.4em; margin-bottom: 15px; }
        .intro-section p { color: var(--text-secondary); margin-bottom: 15px; }
        .grit-formula { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 30px 0; flex-wrap: wrap; }
        .formula-item { text-align: center; padding: 25px 30px; border-radius: 14px; color: var(--white); min-width: 140px; }
        .formula-item.passion { background: linear-gradient(135deg, var(--passion), #1976D2); }
        .formula-item.perseverance { background: linear-gradient(135deg, var(--perseverance), #D32F2F); }
        .formula-item.grit { background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); border: 3px solid var(--chapman-gold); }
        .formula-item .icon { font-size: 2.5em; margin-bottom: 8px; }
        .formula-item .name { font-weight: 700; font-size: 1.1em; }
        .formula-item .desc { font-size: 0.75em; opacity: 0.9; margin-top: 5px; }
        .formula-operator { font-size: 2.5em; color: var(--chapman-gold); font-weight: 700; }
        .quote-box { background: linear-gradient(135deg, #fffef8, #fef9e7); border-left: 5px solid var(--chapman-gold); padding: 25px; margin: 25px 0; border-radius: 0 12px 12px 0; }
        .quote-box blockquote { font-style: italic; color: var(--text-secondary); font-size: 1.05em; line-height: 1.6; }
        .quote-box cite { display: block; margin-top: 12px; color: var(--chapman-blue); font-weight: 600; font-style: normal; }
        .assessment-meta { display: flex; gap: 25px; margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(0,32,91,0.1); flex-wrap: wrap; }
        .meta-item { display: flex; align-items: center; gap: 8px; color: var(--text-secondary); }
        .meta-icon { width: 28px; height: 28px; background: var(--chapman-blue); color: var(--white); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 0.85em; }
        .student-info { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 30px; }
        .input-group { display: flex; flex-direction: column; }
        .input-group label { font-weight: 600; margin-bottom: 8px; color: var(--chapman-blue); }
        .input-group input { padding: 14px 16px; border: 2px solid #e1e5eb; border-radius: 10px; font-size: 16px; transition: all 0.3s ease; }
        .input-group input:focus { outline: none; border-color: var(--chapman-blue); box-shadow: 0 0 0 4px rgba(0,32,91,0.08); }
        .instructions-box { background: linear-gradient(135deg, #fffef8, #fef9e7); border: 2px solid var(--chapman-gold); border-radius: 12px; padding: 25px; margin-bottom: 30px; }
        .instructions-box h3 { color: var(--chapman-blue); margin-bottom: 15px; }
        .scale-display { display: flex; justify-content: space-between; margin-top: 15px; padding: 15px; background: var(--blue-light); border-radius: 10px; }
        .scale-item { text-align: center; flex: 1; }
        .scale-number { display: inline-block; width: 36px; height: 36px; line-height: 36px; background: var(--chapman-blue); color: var(--white); border-radius: 50%; font-weight: 700; margin-bottom: 5px; }
        .scale-label { font-size: 0.6em; color: var(--text-secondary); }
        .progress-container { margin-bottom: 25px; }
        .progress-label { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.9em; color: var(--text-secondary); }
        .progress-bar { width: 100%; height: 10px; background: #e8ecf0; border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--chapman-blue), var(--chapman-gold)); width: 0%; transition: width 0.5s ease; }
        .question-container { background: var(--white); border-radius: 14px; border: 2px solid #e8ecf0; padding: 25px; margin-bottom: 18px; transition: all 0.3s ease; }
        .question-container:hover { border-color: var(--chapman-blue); box-shadow: var(--shadow-medium); }
        .question-container.answered { border-color: var(--chapman-gold); background: linear-gradient(135deg, #fffef8, var(--white)); }
        .question-text { font-size: 1.02em; color: var(--text-primary); margin-bottom: 18px; line-height: 1.6; }
        .question-number { color: var(--chapman-blue); font-weight: 700; margin-right: 8px; }
        .likert-scale { display: flex; justify-content: space-between; gap: 6px; }
        .likert-option { flex: 1; text-align: center; }
        .likert-option input[type="radio"] { display: none; }
        .likert-option label { display: flex; flex-direction: column; align-items: center; padding: 12px 6px; border: 2px solid #e8ecf0; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; background: #fafbfc; }
        .likert-option label:hover { border-color: var(--chapman-blue); background: var(--blue-light); }
        .likert-option input[type="radio"]:checked + label { border-color: var(--chapman-blue); background: var(--chapman-blue); color: var(--white); }
        .likert-number { font-size: 1.2em; font-weight: 700; margin-bottom: 2px; }
        .likert-label { font-size: 0.55em; text-transform: uppercase; }
        .controls { text-align: center; margin: 30px 0; }
        .btn { border: none; padding: 16px 40px; font-size: 1.05em; font-weight: 600; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; margin: 8px; display: inline-flex; align-items: center; gap: 10px; }
        .btn-primary { background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); color: var(--white); box-shadow: 0 4px 15px rgba(0,32,91,0.3); }
        .btn-primary:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0,32,91,0.4); }
        .btn-secondary { background: linear-gradient(135deg, var(--chapman-gold), #d4b000); color: var(--chapman-blue); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-outline { background: transparent; border: 2px solid var(--chapman-blue); color: var(--chapman-blue); }
        .results { display: none; margin-top: 30px; }
        .results-header { background: linear-gradient(135deg, var(--chapman-blue), var(--blue-medium)); color: var(--white); padding: 40px; text-align: center; border-radius: 16px 16px 0 0; }
        .results-header h2 { font-size: 1.8em; margin-bottom: 10px; }
        .results-header .student-name { font-size: 1.3em; color: var(--chapman-gold); margin-bottom: 8px; }
        .grit-score-display { background: linear-gradient(135deg, #34495e, #2c3e50); padding: 40px; text-align: center; }
        .grit-score-main { display: flex; justify-content: center; align-items: center; gap: 50px; flex-wrap: wrap; }
        .grit-gauge { position: relative; width: 180px; height: 180px; }
        .grit-gauge svg { transform: rotate(-90deg); }
        .grit-gauge-bg { fill: none; stroke: rgba(255,255,255,0.2); stroke-width: 12; }
        .grit-gauge-fill { fill: none; stroke: var(--chapman-gold); stroke-width: 12; stroke-linecap: round; transition: stroke-dashoffset 1s ease; }
        .grit-gauge-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: var(--white); }
        .grit-gauge-text .score { font-size: 3em; font-weight: 700; line-height: 1; }
        .grit-gauge-text .label { font-size: 0.9em; opacity: 0.9; }
        .grit-level-box { text-align: left; max-width: 350px; }
        .grit-level-box .level { color: var(--chapman-gold); font-size: 1.6em; font-weight: 700; margin-bottom: 10px; }
        .grit-level-box .desc { color: rgba(255,255,255,0.9); line-height: 1.7; }
        .dimension-scores { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; padding: 30px; background: linear-gradient(135deg, #3a5068, #2c3e50); }
        .dim-score-card { background: rgba(255,255,255,0.1); padding: 25px; border-radius: 14px; text-align: center; color: var(--white); }
        .dim-score-card.passion { border-top: 4px solid var(--passion); }
        .dim-score-card.perseverance { border-top: 4px solid var(--perseverance); }
        .dim-score-card .icon { font-size: 2em; margin-bottom: 10px; }
        .dim-score-card h3 { font-size: 1.1em; margin-bottom: 5px; }
        .dim-score-card .subtitle { font-size: 0.8em; opacity: 0.8; margin-bottom: 10px; }
        .dim-score-card .score { font-size: 2.5em; font-weight: 700; }
        .dim-score-card .max { font-size: 0.8em; opacity: 0.7; }
        .results-body { background: var(--blue-light); padding: 35px; border-radius: 0 0 16px 16px; }
        .info-card { background: var(--white); border-radius: 16px; padding: 30px; margin-bottom: 25px; box-shadow: var(--shadow-medium); border-top: 5px solid var(--chapman-blue); }
        .info-card.passion { border-top-color: var(--passion); }
        .info-card.perseverance { border-top-color: var(--perseverance); }
        .info-card-header { display: flex; align-items: center; gap: 18px; margin-bottom: 18px; }
        .info-card-icon { width: 70px; height: 70px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.2em; color: var(--white); }
        .info-card-icon.passion { background: var(--passion); }
        .info-card-icon.perseverance { background: var(--perseverance); }
        .info-card-info h3 { font-size: 1.5em; color: var(--chapman-blue); margin-bottom: 4px; }
        .info-card-info .subtitle { color: var(--chapman-gold); font-weight: 600; }
        .info-card-description { color: var(--text-secondary); line-height: 1.8; }
        .char-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .char-box { padding: 20px; border-radius: 12px; }
        .char-box.signs { background: #E8F5E9; border-left: 4px solid #2E7D32; }
        .char-box.develop { background: #E3F2FD; border-left: 4px solid #1565C0; }
        .char-box h5 { margin-bottom: 12px; font-size: 1em; color: var(--text-primary); }
        .char-box ul { list-style: none; padding: 0; }
        .char-box li { padding: 8px 0 8px 24px; position: relative; font-size: 0.95em; color: var(--text-secondary); }
        .char-box.signs li::before { content: '‚úì'; position: absolute; left: 0; color: #2E7D32; font-weight: bold; }
        .char-box.develop li::before { content: '‚Üí'; position: absolute; left: 0; color: #1565C0; font-weight: bold; }
        .result-section { background: var(--white); border-radius: 14px; padding: 28px; margin-bottom: 20px; border-left: 5px solid var(--chapman-blue); box-shadow: var(--shadow-subtle); }
        .result-section.gold-accent { border-left-color: var(--chapman-gold); }
        .result-section h4 { color: var(--chapman-blue); margin-bottom: 18px; }
        .reflection-section { background: linear-gradient(135deg, var(--blue-light), #f0f4fa); border-radius: 14px; padding: 30px; margin-top: 25px; border: 2px solid var(--chapman-blue); }
        .reflection-section h4 { color: var(--chapman-blue); margin-bottom: 20px; text-align: center; }
        .reflection-questions { counter-reset: reflection; }
        .reflection-question { padding: 18px 20px 18px 50px; position: relative; background: var(--white); border-radius: 10px; margin-bottom: 12px; color: var(--text-secondary); }
        .reflection-question::before { counter-increment: reflection; content: counter(reflection); position: absolute; left: 15px; top: 50%; transform: translateY(-50%); width: 26px; height: 26px; background: var(--chapman-blue); color: var(--white); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.85em; font-weight: 700; }
        .footer { text-align: center; padding: 25px; color: var(--text-secondary); font-size: 0.9em; border-top: 1px solid #e8ecf0; margin-top: 30px; }
        @media (max-width: 768px) { .grit-formula { flex-direction: column; } .student-info, .char-grid, .dimension-scores { grid-template-columns: 1fr; } .grit-score-main { flex-direction: column; } h1 { font-size: 1.8em; } .likert-option { min-width: 55px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="institution">Chapman University</div>
            <div class="college">Argyros College of Business and Economics</div>
            <h1>Grit Assessment</h1>
            <div class="subtitle">Based on Angela Duckworth's Grit Scale</div>
        </div>
        <div class="content">
            <div id="intro-section">
                <div class="intro-section">
                    <h2>üí™ How Gritty Are You?</h2>
                    <p><strong>Grit</strong> is the combination of passion and perseverance for long-term goals. Research by <strong>Angela Duckworth</strong> shows that grit predicts success across many domains ‚Äî often more than talent or IQ.</p>
                    <div class="grit-formula">
                        <div class="formula-item passion"><div class="icon">‚ù§Ô∏è</div><div class="name">Passion</div><div class="desc">Consistency of interests</div></div>
                        <div class="formula-operator">+</div>
                        <div class="formula-item perseverance"><div class="icon">üî•</div><div class="name">Perseverance</div><div class="desc">Persistence of effort</div></div>
                        <div class="formula-operator">=</div>
                        <div class="formula-item grit"><div class="icon">üíé</div><div class="name">GRIT</div><div class="desc">Long-term success</div></div>
                    </div>
                    <div class="quote-box">
                        <blockquote>"Grit is passion and perseverance for very long-term goals. Grit is having stamina. Grit is sticking with your future, day in, day out."</blockquote>
                        <cite>‚Äî Angela Duckworth, TED Talk (2013)</cite>
                    </div>
                    <div class="assessment-meta">
                        <div class="meta-item"><div class="meta-icon">‚è±</div><span>5-7 minutes</span></div>
                        <div class="meta-item"><div class="meta-icon">üìù</div><span>12 items</span></div>
                        <div class="meta-item"><div class="meta-icon">üíé</div><span>2 dimensions</span></div>
                    </div>
                </div>
                <div class="student-info">
                    <div class="input-group"><label for="studentName">Your Full Name</label><input type="text" id="studentName" placeholder="Enter your full name"></div>
                    <div class="input-group"><label for="testDate">Assessment Date</label><input type="date" id="testDate"></div>
                </div>
                <div class="instructions-box">
                    <h3>üìå Instructions</h3>
                    <p>Rate each statement based on how accurately it describes you compared to most people.</p>
                    <div class="scale-display">
                        <div class="scale-item"><div class="scale-number">1</div><div class="scale-label">Not Like Me</div></div>
                        <div class="scale-item"><div class="scale-number">2</div><div class="scale-label">Not Much</div></div>
                        <div class="scale-item"><div class="scale-number">3</div><div class="scale-label">Somewhat</div></div>
                        <div class="scale-item"><div class="scale-number">4</div><div class="scale-label">Mostly</div></div>
                        <div class="scale-item"><div class="scale-number">5</div><div class="scale-label">Very Much</div></div>
                    </div>
                </div>
                <div class="controls"><button class="btn btn-primary" onclick="startAssessment()">Begin Assessment ‚Üí</button></div>
            </div>
            <div id="assessment-section" class="hidden">
                <div class="progress-container">
                    <div class="progress-label"><span>Progress</span><span id="progressText">0 of 12</span></div>
                    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
                </div>
                <div id="questions-container"></div>
                <div class="controls"><button class="btn btn-primary" id="submitBtn" onclick="calculateResults()" disabled>Discover My Grit Score ‚Üí</button></div>
            </div>
            <div id="results" class="results"></div>
            <div id="downloadSection" class="hidden controls">
                <button class="btn btn-secondary" onclick="generatePDF()">üìÑ Download PDF</button>
                <button class="btn btn-outline" onclick="restartAssessment()">Retake</button>
            </div>
        </div>
        <div class="footer">
            <p>Grit Assessment ‚Ä¢ Based on Angela Duckworth's Grit Scale</p>
            <p>Chapman University ‚Ä¢ Argyros College of Business and Economics</p>
            <p style="margin-top: 8px; font-size: 0.85em;">¬© 2024 Professor Chip Monaco ‚Ä¢ MGMT 316</p>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        const questions = {
            passion: [
                { id: 1, text: "New ideas and projects sometimes distract me from previous ones.", dim: "passion", reverse: true },
                { id: 2, text: "I have been obsessed with a certain idea or project for a short time but later lost interest.", dim: "passion", reverse: true },
                { id: 3, text: "I often set a goal but later choose to pursue a different one.", dim: "passion", reverse: true },
                { id: 4, text: "My interests change from year to year.", dim: "passion", reverse: true },
                { id: 5, text: "I have difficulty maintaining my focus on projects that take more than a few months.", dim: "passion", reverse: true },
                { id: 6, text: "I have achieved a goal that took years of work.", dim: "passion", reverse: false }
            ],
            perseverance: [
                { id: 7, text: "I finish whatever I begin.", dim: "perseverance", reverse: false },
                { id: 8, text: "Setbacks don't discourage me. I don't give up easily.", dim: "perseverance", reverse: false },
                { id: 9, text: "I am a hard worker.", dim: "perseverance", reverse: false },
                { id: 10, text: "I am diligent. I never give up.", dim: "perseverance", reverse: false },
                { id: 11, text: "I have overcome setbacks to conquer an important challenge.", dim: "perseverance", reverse: false },
                { id: 12, text: "I am resilient and keep going even when things get difficult.", dim: "perseverance", reverse: false }
            ]
        };
        const dimensionData = {
            passion: { name: "Consistency of Interest", shortName: "Passion", icon: "‚ù§Ô∏è", color: "#1565C0", subtitle: "Long-term dedication to goals", description: "Passion in grit refers to consistency of interests over time ‚Äî sustained commitment to the same goals year after year.", highSigns: ["Maintains focus on goals for years", "Doesn't get distracted by new shiny objects", "Has a clear sense of direction", "Connects daily tasks to long-term aspirations", "Remains committed when progress is slow"], development: ["Identify your ultimate concern or top-level goal", "Create a goal hierarchy connecting daily tasks to big goals", "Practice saying no to distractions", "Reflect regularly on why your goals matter", "Find mentors who model sustained passion"] },
            perseverance: { name: "Perseverance of Effort", shortName: "Perseverance", icon: "üî•", color: "#C62828", subtitle: "Working hard despite obstacles", description: "Perseverance is the tendency to work hard and bounce back from setbacks ‚Äî sustained effort over time.", highSigns: ["Finishes what they start", "Works hard without immediate rewards", "Bounces back quickly from setbacks", "Maintains effort when things get boring or hard", "Views obstacles as challenges to overcome"], development: ["Practice deliberate effort on difficult tasks", "Reframe setbacks as learning opportunities", "Build a growth mindset about effort", "Celebrate small wins", "Find accountability partners"] }
        };
        const gritLevels = [
            { min: 4.5, max: 5.0, name: "Extremely Gritty", percentile: "Top 10%", desc: "You demonstrate exceptional passion and perseverance for long-term goals." },
            { min: 4.0, max: 4.49, name: "Very Gritty", percentile: "Top 20%", desc: "You show strong grit ‚Äî committed to goals and resilient in setbacks." },
            { min: 3.5, max: 3.99, name: "Gritty", percentile: "Top 40%", desc: "You have above-average grit with room to strengthen consistency or effort." },
            { min: 3.0, max: 3.49, name: "Moderately Gritty", percentile: "Average", desc: "Typical grit levels with opportunity to develop both passion and perseverance." },
            { min: 2.5, max: 2.99, name: "Somewhat Gritty", percentile: "Below Average", desc: "Your grit is developing. Focus on building consistency and persistence." },
            { min: 1.0, max: 2.49, name: "Building Grit", percentile: "Growth Opportunity", desc: "Grit can be developed. Find a passion worth pursuing and build persistence habits." }
        ];
        let responses = {};
        let studentName = '';
        let surveyDate = '';
        
        // Robust auto-date initialization
        function setTodayDate() {
            var dateField = document.getElementById('testDate');
            if (dateField) {
                dateField.value = new Date().toISOString().split('T')[0];
            }
        }
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            setTodayDate();
        }
        document.addEventListener('DOMContentLoaded', setTodayDate);
        window.addEventListener('load', setTodayDate);
        function startAssessment() {
            studentName = document.getElementById('studentName').value.trim();
            surveyDate = document.getElementById('testDate').value;
            if (!studentName) { alert('Please enter your name.'); return; }
            document.getElementById('intro-section').classList.add('hidden');
            document.getElementById('assessment-section').classList.remove('hidden');
            renderQuestions();
        }
        function renderQuestions() {
            const container = document.getElementById('questions-container');
            const allQuestions = [...questions.passion, ...questions.perseverance].sort(() => Math.random() - 0.5);
            container.innerHTML = allQuestions.map((q, i) => `
                <div class="question-container" id="q-container-${q.id}">
                    <div class="question-text"><span class="question-number">${i+1}.</span> ${q.text}</div>
                    <div class="likert-scale">
                        ${[1,2,3,4,5].map(val => `
                            <div class="likert-option">
                                <input type="radio" name="q${q.id}" id="q${q.id}_${val}" value="${val}" onchange="handleResponse(${q.id}, ${val}, '${q.dim}', ${q.reverse})">
                                <label for="q${q.id}_${val}"><span class="likert-number">${val}</span><span class="likert-label">${['Not At All','Not Much','Somewhat','Mostly','Very Much'][val-1]}</span></label>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }
        function handleResponse(id, value, dim, reverse) {
            responses[id] = { value: reverse ? (6 - value) : value, dim };
            document.getElementById(`q-container-${id}`).classList.add('answered');
            updateProgress();
        }
        function updateProgress() {
            const answered = Object.keys(responses).length;
            document.getElementById('progressFill').style.width = (answered / 12 * 100) + '%';
            document.getElementById('progressText').textContent = `${answered} of 12`;
            document.getElementById('submitBtn').disabled = answered < 12;
        }
        function calculateResults() {
            const scores = { passion: 0, perseverance: 0 };
            Object.values(responses).forEach(r => scores[r.dim] += r.value);
            const passionAvg = scores.passion / 6;
            const perseveranceAvg = scores.perseverance / 6;
            const gritScore = (passionAvg + perseveranceAvg) / 2;
            displayResults(scores, passionAvg, perseveranceAvg, gritScore);
        }
        function displayResults(scores, passionAvg, perseveranceAvg, gritScore) {
            const level = gritLevels.find(l => gritScore >= l.min && gritScore <= l.max) || gritLevels[5];
            const circumference = 2 * Math.PI * 75;
            const offset = circumference - (gritScore / 5) * circumference;
            const strongerDim = passionAvg >= perseveranceAvg ? 'passion' : 'perseverance';
            const weakerDim = passionAvg < perseveranceAvg ? 'passion' : 'perseverance';
            document.getElementById('results').innerHTML = `
                <div class="results-header"><h2>üíé Your Grit Profile</h2><div class="student-name">${studentName}</div><div class="date">Completed: ${new Date(surveyDate).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div></div>
                <div class="grit-score-display">
                    <div class="grit-score-main">
                        <div class="grit-gauge"><svg width="180" height="180"><circle class="grit-gauge-bg" cx="90" cy="90" r="75"></circle><circle class="grit-gauge-fill" cx="90" cy="90" r="75" stroke-dasharray="${circumference}" stroke-dashoffset="${offset}"></circle></svg><div class="grit-gauge-text"><div class="score">${gritScore.toFixed(2)}</div><div class="label">out of 5.0</div></div></div>
                        <div class="grit-level-box"><div class="level">${level.name}</div><div class="desc">${level.desc}</div><div style="margin-top: 15px; padding: 12px; background: rgba(255,255,255,0.1); border-radius: 8px;"><span style="color: var(--chapman-gold); font-weight: 600;">${level.percentile}</span></div></div>
                    </div>
                </div>
                <div class="dimension-scores">
                    <div class="dim-score-card passion"><div class="icon">‚ù§Ô∏è</div><h3>Passion</h3><div class="subtitle">Consistency of Interest</div><div class="score">${passionAvg.toFixed(2)}</div><div class="max">out of 5.0</div></div>
                    <div class="dim-score-card perseverance"><div class="icon">üî•</div><h3>Perseverance</h3><div class="subtitle">Persistence of Effort</div><div class="score">${perseveranceAvg.toFixed(2)}</div><div class="max">out of 5.0</div></div>
                </div>
                <div style="background: linear-gradient(135deg, #1a3a7a 0%, #00205B 100%); color: white; padding: 25px; border-radius: 14px; margin: 20px 0;">
                    <h3 style="color: #C4A000; margin-bottom: 15px; font-size: 1.3em;">üìã Assessment Tracker Summary</h3>
                    <p style="font-size: 0.9em; opacity: 0.9; margin-bottom: 15px;">Copy this code into your Assessment Tracker.</p>
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin-bottom: 15px;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div><div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase;">Grit Level</div><div style="font-size: 1.4em; font-weight: 700; color: #F5E6A3;">${level.name}</div></div>
                            <div><div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase;">Stronger Dimension</div><div style="font-size: 1.4em; font-weight: 700; color: #F5E6A3;">${strongerDim === 'passion' ? 'Passion' : 'Perseverance'}</div></div>
                            <div><div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase;">Grit Score</div><div style="font-size: 1.2em; font-weight: 600;">${gritScore.toFixed(2)} / 5.0</div></div>
                            <div><div style="font-size: 0.8em; opacity: 0.8; text-transform: uppercase;">Percentile</div><div style="font-size: 1.2em; font-weight: 600;">${level.percentile}</div></div>
                        </div>
                    </div>
                    <div style="margin-top: 15px; padding: 12px; background: rgba(196, 160, 0, 0.3); border-radius: 8px; font-family: monospace; font-size: 1.1em; text-align: center;">
                        <span style="opacity: 0.7;">Tracker Code:</span> <strong style="color: #F5E6A3; font-size: 1.2em;">GRT-${strongerDim === 'passion' ? 'Pa' : 'Pe'}-${level.name.includes('Extremely') ? 'E' : level.name.includes('Very') ? 'V' : level.name.includes('Gritty') && !level.name.includes('Moderately') ? 'G' : level.name.includes('Moderately') ? 'M' : 'S'}${Math.round(gritScore * 10)}</strong>
                    </div>
                </div>
                <div class="results-body">
                    <div class="info-card ${strongerDim}"><div class="info-card-header"><div class="info-card-icon ${strongerDim}">${dimensionData[strongerDim].icon}</div><div class="info-card-info"><h3>Stronger: ${dimensionData[strongerDim].shortName}</h3><div class="subtitle">${dimensionData[strongerDim].subtitle}</div></div></div><p class="info-card-description">${dimensionData[strongerDim].description}</p><div class="char-grid"><div class="char-box signs"><h5>‚úì Signs of High ${dimensionData[strongerDim].shortName}</h5><ul>${dimensionData[strongerDim].highSigns.map(s => `<li>${s}</li>`).join('')}</ul></div><div class="char-box develop"><h5>‚Üí Leverage This Strength</h5><ul><li>Use this to support your weaker dimension</li><li>Model these behaviors for others</li><li>Take on challenges that use this capacity</li></ul></div></div></div>
                    <div class="info-card ${weakerDim}"><div class="info-card-header"><div class="info-card-icon ${weakerDim}">${dimensionData[weakerDim].icon}</div><div class="info-card-info"><h3>Growth Area: ${dimensionData[weakerDim].shortName}</h3><div class="subtitle">${dimensionData[weakerDim].subtitle}</div></div></div><p class="info-card-description">${dimensionData[weakerDim].description}</p><div class="char-grid"><div class="char-box signs"><h5>‚úì Target Behaviors</h5><ul>${dimensionData[weakerDim].highSigns.slice(0,3).map(s => `<li>${s}</li>`).join('')}</ul></div><div class="char-box develop"><h5>‚Üí Development Strategies</h5><ul>${dimensionData[weakerDim].development.slice(0,3).map(d => `<li>${d}</li>`).join('')}</ul></div></div></div>
                    <div class="reflection-section"><h4>ü§î Reflection Questions</h4><div class="reflection-questions"><div class="reflection-question">What long-term goal have you been working toward for years?</div><div class="reflection-question">Think of a time you gave up. What contributed to that decision?</div><div class="reflection-question">Who is the grittiest person you know? What can you learn from them?</div><div class="reflection-question">What one action could you take this week to build your grit?</div></div></div>
                </div>
            `;
            document.getElementById('assessment-section').classList.add('hidden');
            document.getElementById('results').style.display = 'block';
            document.getElementById('downloadSection').classList.remove('hidden');
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
            window.gritResults = { scores, passionAvg, perseveranceAvg, gritScore, level, strongerDim, weakerDim };
        }
        function generatePDF() {
            var jsPDF = window.jspdf.jsPDF;
            var doc = new jsPDF();
            var passionAvg = window.gritResults.passionAvg;
            var perseveranceAvg = window.gritResults.perseveranceAvg;
            var gritScore = window.gritResults.gritScore;
            var level = window.gritResults.level;
            var strongerDim = window.gritResults.strongerDim;
            var weakerDim = window.gritResults.weakerDim;

            // Colors
            var chapmanBlue = [0, 32, 91];
            var chapmanGold = [196, 160, 0];
            var textDark = [26, 26, 46];
            var textMuted = [100, 100, 110];
            var greenColor = [46, 125, 50];
            var redColor = [198, 40, 40];
            var blueColor = [21, 101, 192];
            var orangeColor = [230, 81, 0];

            // Tracker calculations
            var dimAbbrev = { passion: 'Pa', perseverance: 'Pe' };
            var levelAbbrev = level.name.includes('Extremely') ? 'E' : level.name.includes('Very') ? 'V' : level.name.includes('Gritty') && !level.name.includes('Moderately') ? 'G' : level.name.includes('Moderately') ? 'M' : level.name.includes('Somewhat') ? 'S' : 'B';
            var trackerCode = 'GRT-' + dimAbbrev[strongerDim] + '-' + levelAbbrev + gritScore.toFixed(1).replace('.', '');

            // Helper function
            function addWrappedText(text, x, startY, maxWidth, lineHeight) {
                var lines = doc.splitTextToSize(text, maxWidth);
                var currentY = startY;
                for (var i = 0; i < lines.length; i++) {
                    if (currentY > 275) { doc.addPage(); currentY = 20; }
                    doc.text(lines[i], x, currentY);
                    currentY += lineHeight;
                }
                return currentY;
            }

            // ===== PAGE 1 =====
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.rect(0, 0, 210, 42, 'F');
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('CHAPMAN UNIVERSITY', 105, 12, { align: 'center' });
            doc.setFontSize(9);
            doc.setTextColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.text('Argyros College of Business and Economics', 105, 18, { align: 'center' });
            doc.setFontSize(16);
            doc.setTextColor(255, 255, 255);
            doc.text('Grit Assessment', 105, 28, { align: 'center' });
            doc.setFontSize(9);
            doc.text("Based on Angela Duckworth's Grit Scale", 105, 36, { align: 'center' });
            doc.setFillColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.rect(0, 42, 210, 2, 'F');

            var y = 52;
            doc.setFontSize(10);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text('Student: ' + studentName, 20, y);
            doc.text('Date: ' + new Date(surveyDate).toLocaleDateString(), 140, y);
            y += 10;

            // Grit Score Banner
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 22, 2, 2, 'F');
            doc.setFontSize(16);
            doc.setTextColor(255, 255, 255);
            doc.text('GRIT SCORE: ' + gritScore.toFixed(2) + ' / 5.0', 105, y + 10, { align: 'center' });
            doc.setFontSize(11);
            doc.setTextColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.text(level.name + ' (' + level.percentile + ')', 105, y + 18, { align: 'center' });
            y += 28;

            doc.setFontSize(9);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            y = addWrappedText(level.desc, 20, y, 170, 4.5);
            y += 6;

            // Score Distribution Box
            doc.setFillColor(245, 247, 250);
            doc.roundedRect(20, y, 170, 18, 2, 2, 'F');
            doc.setFontSize(9);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('DIMENSION SCORES', 25, y + 7);
            doc.setFontSize(10);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text('Passion (Consistency of Interest): ' + passionAvg.toFixed(2) + '/5.0', 25, y + 14);
            doc.text('Perseverance (Persistence of Effort): ' + perseveranceAvg.toFixed(2) + '/5.0', 110, y + 14);
            y += 24;

            // Tracker Code Box
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 10, 2, 2, 'F');
            doc.setFontSize(8);
            doc.setTextColor(255, 255, 255);
            doc.text('Tracker: ' + trackerCode + '  |  Stronger: ' + dimensionData[strongerDim].shortName + '  |  Growth: ' + dimensionData[weakerDim].shortName, 105, y + 7, { align: 'center' });
            y += 16;

            // Stronger Dimension Section
            var strongColor = strongerDim === 'passion' ? blueColor : redColor;
            doc.setFontSize(10);
            doc.setTextColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.text('STRENGTH: ' + dimensionData[strongerDim].shortName + ' - ' + dimensionData[strongerDim].name, 20, y);
            y += 5;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            y = addWrappedText(dimensionData[strongerDim].description, 20, y, 170, 4);
            y += 3;
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            doc.text('High Indicators:', 20, y);
            y += 4;
            for (var i = 0; i < Math.min(4, dimensionData[strongerDim].highSigns.length); i++) {
                doc.text('- ' + dimensionData[strongerDim].highSigns[i], 25, y);
                y += 4;
            }
            y += 5;

            // Weaker Dimension Section
            var weakColor = weakerDim === 'passion' ? blueColor : redColor;
            doc.setFontSize(10);
            doc.setTextColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.text('GROWTH AREA: ' + dimensionData[weakerDim].shortName + ' - ' + dimensionData[weakerDim].name, 20, y);
            y += 5;
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            y = addWrappedText(dimensionData[weakerDim].description, 20, y, 170, 4);
            y += 3;
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            doc.text('Development Strategies:', 20, y);
            y += 4;
            for (var i = 0; i < Math.min(4, dimensionData[weakerDim].development.length); i++) {
                doc.text('-> ' + dimensionData[weakerDim].development[i], 25, y);
                y += 4;
            }

            // Angela Duckworth Quote
            y += 6;
            doc.setFillColor(255, 250, 240);
            doc.roundedRect(20, y, 170, 20, 2, 2, 'F');
            doc.setDrawColor(chapmanGold[0], chapmanGold[1], chapmanGold[2]);
            doc.setLineWidth(0.5);
            doc.line(20, y, 20, y + 20);
            doc.setFontSize(8);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            doc.setFont(undefined, 'italic');
            var quote = '"Grit is passion and perseverance for very long-term goals."';
            doc.text(quote, 25, y + 8);
            doc.setFont(undefined, 'bold');
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('- Angela Duckworth', 25, y + 15);
            doc.setFont(undefined, 'normal');

            // ===== PAGE 2: SWOT and Details =====
            doc.addPage();
            y = 20;

            // SWOT Header
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 10, 2, 2, 'F');
            doc.setFontSize(11);
            doc.setTextColor(255, 255, 255);
            doc.text('SWOT ANALYSIS - Grit Profile', 105, y + 7, { align: 'center' });
            y += 18;

            // SWOT Grid
            var boxW = 82;
            var boxH = 26;

            // Strength
            doc.setFillColor(232, 245, 233);
            doc.roundedRect(20, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.setLineWidth(0.5);
            doc.line(20, y, 20, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(greenColor[0], greenColor[1], greenColor[2]);
            doc.text('STRENGTH', 25, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var sText = 'Strong ' + dimensionData[strongerDim].shortName.toLowerCase() + ' enables long-term goal achievement';
            var sLines = doc.splitTextToSize(sText, boxW - 10);
            for (var i = 0; i < Math.min(sLines.length, 3); i++) {
                doc.text(sLines[i], 25, y + 12 + (i * 4));
            }

            // Weakness
            doc.setFillColor(255, 235, 238);
            doc.roundedRect(108, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(redColor[0], redColor[1], redColor[2]);
            doc.line(108, y, 108, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(redColor[0], redColor[1], redColor[2]);
            doc.text('WEAKNESS', 113, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var wText = 'Lower ' + dimensionData[weakerDim].shortName.toLowerCase() + ' may reduce sustained effort over time';
            var wLines = doc.splitTextToSize(wText, boxW - 10);
            for (var i = 0; i < Math.min(wLines.length, 3); i++) {
                doc.text(wLines[i], 113, y + 12 + (i * 4));
            }

            y += boxH + 5;

            // Opportunity
            doc.setFillColor(227, 242, 253);
            doc.roundedRect(20, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.line(20, y, 20, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.text('OPPORTUNITY', 25, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var oText = 'Grit can be developed - research shows it grows with deliberate practice';
            var oLines = doc.splitTextToSize(oText, boxW - 10);
            for (var i = 0; i < Math.min(oLines.length, 3); i++) {
                doc.text(oLines[i], 25, y + 12 + (i * 4));
            }

            // Threat
            doc.setFillColor(255, 243, 224);
            doc.roundedRect(108, y, boxW, boxH, 2, 2, 'F');
            doc.setDrawColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.line(108, y, 108, y + boxH);
            doc.setFontSize(9);
            doc.setTextColor(orangeColor[0], orangeColor[1], orangeColor[2]);
            doc.text('THREAT', 113, y + 7);
            doc.setFontSize(7);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            var tText = 'Imbalance between passion and perseverance limits effectiveness';
            var tLines = doc.splitTextToSize(tText, boxW - 10);
            for (var i = 0; i < Math.min(tLines.length, 3); i++) {
                doc.text(tLines[i], 113, y + 12 + (i * 4));
            }

            y += boxH + 12;

            // The Grit Formula
            doc.setFontSize(11);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('THE GRIT EQUATION', 20, y);
            y += 7;

            doc.setFillColor(245, 247, 250);
            doc.roundedRect(20, y, 170, 14, 2, 2, 'F');
            doc.setFontSize(12);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            doc.text('GRIT = PASSION (Consistency of Interest) + PERSEVERANCE (Persistence of Effort)', 105, y + 9, { align: 'center' });
            y += 22;

            // Both Dimensions
            doc.setFontSize(10);
            doc.setTextColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.text('DIMENSION DETAILS', 20, y);
            y += 8;

            // Passion
            doc.setFontSize(9);
            doc.setTextColor(blueColor[0], blueColor[1], blueColor[2]);
            doc.text('PASSION - Consistency of Interest: ' + passionAvg.toFixed(2) + '/5.0', 25, y);
            y += 5;
            doc.setFontSize(7);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            y = addWrappedText(dimensionData.passion.description, 25, y, 165, 3.5);
            y += 5;

            // Perseverance
            doc.setFontSize(9);
            doc.setTextColor(redColor[0], redColor[1], redColor[2]);
            doc.text('PERSEVERANCE - Persistence of Effort: ' + perseveranceAvg.toFixed(2) + '/5.0', 25, y);
            y += 5;
            doc.setFontSize(7);
            doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
            y = addWrappedText(dimensionData.perseverance.description, 25, y, 165, 3.5);
            y += 8;

            // Reflection Questions
            doc.setFillColor(chapmanBlue[0], chapmanBlue[1], chapmanBlue[2]);
            doc.roundedRect(20, y, 170, 10, 2, 2, 'F');
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('REFLECTION QUESTIONS', 105, y + 7, { align: 'center' });
            y += 16;

            var reflectionQs = [
                "What long-term goal have you been working toward for years?",
                "Think of a time you gave up on something important. What contributed to that decision?",
                "Who is the grittiest person you know? What can you learn from them?",
                "What one action could you take this week to build your grit?",
                "How do passion and perseverance work together in your pursuit of goals?"
            ];
            doc.setFontSize(8);
            doc.setTextColor(textDark[0], textDark[1], textDark[2]);
            for (var i = 0; i < reflectionQs.length; i++) {
                if (y > 275) { doc.addPage(); y = 20; }
                var qLines = doc.splitTextToSize((i + 1) + '. ' + reflectionQs[i], 165);
                for (var j = 0; j < qLines.length; j++) {
                    doc.text(qLines[j], 25, y);
                    y += 4;
                }
                y += 2;
            }

            // Footer on all pages
            var pageCount = doc.internal.getNumberOfPages();
            for (var i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setTextColor(textMuted[0], textMuted[1], textMuted[2]);
                doc.text('Page ' + i + ' of ' + pageCount, 105, 287, { align: 'center' });
                doc.text('Chapman University - Argyros College of Business and Economics - MGMT 316', 105, 292, { align: 'center' });
            }

            doc.save('Grit_Assessment_' + studentName.replace(/\s+/g, '_') + '_' + new Date().toISOString().split('T')[0] + '.pdf');
        }
        function restartAssessment() {
            responses = {};
            document.getElementById('studentName').value = '';
            document.getElementById('testDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('results').style.display = 'none';
            document.getElementById('assessment-section').classList.add('hidden');
            document.getElementById('downloadSection').classList.add('hidden');
            document.getElementById('intro-section').classList.remove('hidden');
            document.getElementById('progressFill').style.width = '0%';
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>
